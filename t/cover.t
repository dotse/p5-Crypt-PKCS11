#!perl

use Test::More;
use Crypt::PKCS11 qw(:constant);
use Crypt::PKCS11::Attribute;
use Crypt::PKCS11::Attributes;
use Crypt::PKCS11::Object;
use Crypt::PKCS11::Session;
use Scalar::Util qw(blessed);

# Crypt/PKCS11.pm

$obj = eval {
    local $SIG{__WARN__} = sub {};
    Crypt::PKCS11::new;
};
ok( blessed $obj, 'Crypt::PKCS11::new' );
isa_ok( $obj = Crypt::PKCS11->new, 'Crypt::PKCS11', 'Crypt::PKCS11->new' );
isa_ok( $obj = $obj->new, 'Crypt::PKCS11', '$obj->new' );
$@ = undef; eval { $obj->load(undef); };
ok( $@, '$obj->load(undef)' );
is( $obj->load('FAKE'), undef, '$obj->load(FAKE)' );
is( $obj->unload, undef, '$obj->unload' );
$@ = undef; eval { $obj->Initialize(undef); };
ok( $@, '$obj->Initialize(undef)' );
is( $obj->Initialize({}), undef, '$obj->Initialize({})' );
$@ = undef; eval { $obj->Initialize({ CreateMutex => undef }); };
ok( $@, '$obj->Initialize({ CreateMutex => undef })' );
$@ = undef; eval { $obj->Initialize({ DestroyMutex => undef }); };
ok( $@, '$obj->Initialize({ DestroyMutex => undef })' );
$@ = undef; eval { $obj->Initialize({ LockMutex => undef }); };
ok( $@, '$obj->Initialize({ LockMutex => undef })' );
$@ = undef; eval { $obj->Initialize({ UnlockMutex => undef }); };
ok( $@, '$obj->Initialize({ UnlockMutex => undef })' );
$@ = undef; eval { $obj->Initialize({ CreateMutex => sub{} }); };
ok( $@, '$obj->Initialize({ CreateMutex => sub{} })' );
$@ = undef; eval { $obj->Initialize({ CreateMutex => sub{}, DestroyMutex => sub{} }); };
ok( $@, '$obj->Initialize({ CreateMutex => sub{}, DestroyMutex => sub{} })' );
$@ = undef; eval { $obj->Initialize({ CreateMutex => sub{}, DestroyMutex => sub{}, LockMutex => sub{} }); };
ok( $@, '$obj->Initialize({ CreateMutex => sub{}, DestroyMutex => sub{}, LockMutex => sub{} })' );
is( $obj->Initialize({ CreateMutex => sub{}, DestroyMutex => sub{}, LockMutex => sub{}, UnlockMutex => sub{} }), undef, '$obj->Initialize({ CreateMutex => sub{}, DestroyMutex => sub{}, LockMutex => sub{}, UnlockMutex => sub{} })' );
is( $obj->Finalize, undef, '$obj->Finalize' );
is( $obj->GetInfo, undef, '$obj->GetInfo' );
is( $obj->GetSlotList, undef, '$obj->GetSlotList' );
$@ = undef; eval { $obj->GetSlotInfo; };
ok( $@, '$obj->GetSlotInfo' );
is( $obj->GetSlotInfo(1), undef, '$obj->GetSlotInfo' );
$@ = undef; eval { $obj->GetTokenInfo; };
ok( $@, '$obj->GetTokenInfo' );
is( $obj->GetTokenInfo(1), undef, '$obj->GetTokenInfo' );
$@ = undef; eval { $obj->GetMechanismList; };
ok( $@, '$obj->GetMechanismList' );
is( $obj->GetMechanismList(1), undef, '$obj->GetMechanismList' );
$@ = undef; eval { $obj->GetMechanismInfo; };
ok( $@, '$obj->GetMechanismInfo' );
$@ = undef; eval { $obj->GetMechanismInfo(1); };
ok( $@, '$obj->GetMechanismInfo' );
is( $obj->GetMechanismInfo(1, 1), undef, '$obj->GetMechanismInfo' );
$@ = undef; eval { $obj->InitToken; };
ok( $@, '$obj->InitToken' );
$@ = undef; eval { $obj->InitToken(undef, undef); };
ok( $@, '$obj->InitToken(undef, undef)' );
$@ = undef; eval { $obj->InitToken(1, undef); };
ok( $@, '$obj->InitToken(1, undef)' );
is( $obj->InitToken(1, 1), undef, '$obj->InitToken' );
is( $obj->InitToken(1, 1, 1), undef, '$obj->InitToken' );
is( $obj->InitToken(1, undef, 1), undef, '$obj->InitToken' );
$@ = undef; eval { $obj->OpenSession(undef); };
ok( $@, '$obj->OpenSession(undef)' );
$@ = undef; eval { $obj->OpenSession(1, undef, 1); };
ok( $@, '$obj->OpenSession(1, undef, 1)' );
is( $obj->OpenSession(1, undef, sub{}), undef, '$obj->OpenSession(1, undef, sub{})' );
$@ = undef; eval { $obj->CloseAllSessions; };
ok( $@, '$obj->CloseAllSessions' );
is( $obj->CloseAllSessions(1), undef, '$obj->CloseAllSessions' );
is( $obj->WaitForSlotEvent, undef, '$obj->WaitForSlotEvent' );
ok( $obj->errno, '$obj->errno' );

$@ = undef; eval { Crypt::PKCS11::struct::toBytes; };
ok( $@, 'Crypt::PKCS11::struct::toBytes' );

my $mechanism = Crypt::PKCS11::CK_MECHANISM->new;
$mechanism->set_mechanism(CKM_RSA_PKCS_KEY_PAIR_GEN);
$mechanism->set_pParameter('abc');
isa_ok( $mechanism->toHash, 'HASH', '$mechanism->toHash' );

$rv = 0;
if ($ENV{TEST_DEVEL_COVER}) {
    isa_ok( $xs = Crypt::PKCS11::XS->new, 'Crypt::PKCS11::XSPtr' );
    is( $xs->load('TEST_DEVEL_COVER_NO_FLIST'), CKR_GENERAL_ERROR );
    is( $xs->load('TEST_DEVEL_COVER'), CKR_OK );
    $rv = $xs->test_devel_cover;
}
is( $rv, 0, 'Failed on line '.$rv );

is( $xs->C_InitToken(1, 1, undef), CKR_ARGUMENTS_BAD, '$xs->C_InitToken(1, 1, undef)' );
is( $xs->C_InitToken(1, undef, 1), CKR_OK, '$xs->C_InitToken(1, undef, 1)' );
is( $xs->C_InitToken(1, undef, '01234567890123456789012345678901'), CKR_OK, '$xs->C_InitToken(1, undef, 1)' );

is( $xs->C_InitPIN(1, undef), CKR_OK, '$xs->C_InitPIN(1, undef)' );
is( $xs->C_InitPIN(1, 1), CKR_OK, '$xs->C_InitPIN(1, 1)' );

is( $xs->C_SetPIN(1, undef, undef), CKR_OK, '$xs->C_SetPIN(1, undef, undef)' );
is( $xs->C_SetPIN(1, 1, undef), CKR_OK, '$xs->C_SetPIN(1, 1, undef)' );
is( $xs->C_SetPIN(1, 1, 1), CKR_OK, '$xs->C_SetPIN(1, 1, 1)' );

{
    local $SIG{__WARN__} = sub {};
    my ($a, $called);
    is( $xs->C_OpenSession(0, 0, sub { $called = 1; }, $a), CKR_OK, '$xs->C_OpenSession' );
    ok( $called, 'C_OpenSession not called' );
    is( $xs->C_OpenSession(9999, 0, sub {}, $a), CKR_GENERAL_ERROR, '$xs->C_OpenSession' );
}

is( $xs->C_GetOperationState(1, $a), CKR_OK, '$xs->C_GetOperationState(1, $a)' );
is( $xs->C_GetOperationState(9999, $a), CKR_OK, '$xs->C_GetOperationState(1, $a)' );

{
    local $SIG{__WARN__} = sub {};
    is( $xs->C_SetOperationState(1, $a, undef, undef), CKR_OK, '$xs->C_SetOperationState(1, $a, undef, undef)' );
}

is( $xs->C_Login(1, 1, undef), CKR_OK, '$xs->C_Loing(1, 1, undef)' );

is( $xs->C_GetObjectSize(1, 1, $a), CKR_OK, '$xs->C_GetObjectSize(1, 1, $a)' );

is( $xs->C_FindObjects(1, $a = [], 2), CKR_OK, '$xs->C_FindObjects(1, $a = [], 2)' );

is( $xs->C_EncryptUpdate(1, $a = '', $b = ' '), CKR_OK );
is( $xs->C_EncryptUpdate(1, $a = '', $b = ''), CKR_OK );
is( $xs->C_EncryptFinal(1, $a = ' '), CKR_OK );
is( $xs->C_EncryptFinal(1, $a = ''), CKR_OK );
is( $xs->C_DecryptUpdate(1, $a = '', $b = ' '), CKR_OK );
is( $xs->C_DecryptUpdate(1, $a = '', $b = ''), CKR_OK );
is( $xs->C_DecryptFinal(1, $a = ' '), CKR_OK );
is( $xs->C_DecryptFinal(1, $a = ''), CKR_OK );

is( $xs->C_SignRecover(1, $a = '', $b = ' '), CKR_OK );
is( $xs->C_SignRecover(1, $a = '', $b = ''), CKR_OK );

is( $xs->C_VerifyRecover(1, $a = '', $b = ' '), CKR_OK );
is( $xs->C_VerifyRecover(1, $a = '', $b = ''), CKR_OK );

is( $xs->C_DigestEncryptUpdate(1, $a = '', $b = ' '), CKR_OK );
is( $xs->C_DigestEncryptUpdate(1, $a = '', $b = ''), CKR_OK );
is( $xs->C_DecryptDigestUpdate(1, $a = '', $b = ' '), CKR_OK );
is( $xs->C_DecryptDigestUpdate(1, $a = '', $b = ''), CKR_OK );
is( $xs->C_SignEncryptUpdate(1, $a = '', $b = ' '), CKR_OK );
is( $xs->C_SignEncryptUpdate(1, $a = '', $b = ''), CKR_OK );
is( $xs->C_DecryptVerifyUpdate(1, $a = '', $b = ' '), CKR_OK );
is( $xs->C_DecryptVerifyUpdate(1, $a = '', $b = ''), CKR_OK );

{
    local $SIG{__WARN__} = sub {};
    my $sub1 = *Crypt::PKCS11::CK_MECHANISMPtr::get_pParameter{CODE};
    *Crypt::PKCS11::CK_MECHANISMPtr::get_pParameter = sub ($) { return CKR_GENERAL_ERROR; };
    $mechanism = Crypt::PKCS11::CK_MECHANISM->new;
    $@ = undef; eval { $mechanism->toHash; };
    ok( $@, '$mechanism->toHash' );
    my $sub2 = *Crypt::PKCS11::CK_MECHANISMPtr::get_mechanism{CODE};
    *Crypt::PKCS11::CK_MECHANISMPtr::get_mechanism = sub ($) { return CKR_GENERAL_ERROR; };
    $mechanism = Crypt::PKCS11::CK_MECHANISM->new;
    $@ = undef; eval { $mechanism->toHash; };
    ok( $@, '$mechanism->toHash' );
    *Crypt::PKCS11::CK_MECHANISMPtr::get_pParameter = $sub1;
    *Crypt::PKCS11::CK_MECHANISMPtr::get_mechanism = $sub2;
}

# Crypt/PKCS11/Attribute.pm

$obj = eval {
    local $SIG{__WARN__} = sub {};
    Crypt::PKCS11::Attribute::new;
};
ok( blessed $obj, 'Crypt::PKCS11::Attribute::new' );
$@ = undef; eval { Crypt::PKCS11::Attribute->new(undef); };
ok( $@, 'Crypt::PKCS11::Attribute->new(undef)' );
isa_ok( $obj = Crypt::PKCS11::Attribute->new, 'Crypt::PKCS11::Attribute', 'Crypt::PKCS11::Attribute->new' );
isa_ok( $obj = $obj->new, 'Crypt::PKCS11::Attribute', 'Crypt::PKCS11::Attribute $obj->new' );
$@ = undef; eval { $obj->type; };
ok( $@, '$obj->type' );
$@ = undef; eval { $obj->set; };
ok( $@, '$obj->set' );
$@ = undef; eval { $obj->get; };
ok( $@, '$obj->get' );

# Crypt/PKCS11/Attributes.pm

$obj = eval {
    local $SIG{__WARN__} = sub {};
    Crypt::PKCS11::Attributes::new;
};
ok( blessed $obj, 'Crypt::PKCS11::Attributes::new' );
isa_ok( $obj = Crypt::PKCS11::Attributes->new, 'Crypt::PKCS11::Attributes', 'Crypt::PKCS11::Attributes->new' );
isa_ok( $obj = $obj->new, 'Crypt::PKCS11::Attributes', 'Crypt::PKCS11::Attributes $obj->new' );
$@ = undef; eval { $obj->push(undef); };
ok( $@, '$obj->push(undef)' );
$@ = undef; eval { $obj->push(Crypt::PKCS11::Attributes->new); };
ok( $@, '$obj->push(Crypt::PKCS11::Attributes->new)' );
ok( $obj->push(Crypt::PKCS11::Attribute->new), '$obj->push(Crypt::PKCS11::Attribute->new)' );
ok( $obj->pop, '$obj->pop' );
$@ = undef; eval { $obj->unshift(undef); };
ok( $@, '$obj->unshift(undef)' );
$@ = undef; eval { $obj->unshift(Crypt::PKCS11::Attributes->new); };
ok( $@, '$obj->unshift(Crypt::PKCS11::Attributes->new)' );
ok( $obj->unshift(Crypt::PKCS11::Attribute->new), '$obj->unshift(Crypt::PKCS11::Attribute->new)' );
ok( $obj->all, '$obj->all' );
$@ = undef; eval { $obj->foreach; };
ok( $@, '$obj->foreach' );
ok( $obj->foreach(sub{}), '$obj->foreach(sub{})' );
ok( $obj->shift, '$obj->shift' );
$@ = undef; eval { $obj->fromArray; };
ok( $@, '$obj->fromArray' );
$@ = undef; eval { $obj->fromArray([undef]); };
ok( $@, '$obj->fromArray([undef])' );
$@ = undef; eval { $obj->fromArray([{}]); };
ok( $@, '$obj->fromArray([{}])' );
$@ = undef; eval { $obj->fromArray([{ type => undef }]); };
ok( $@, '$obj->fromArray([{ type => undef }])' );
$@ = undef; eval { $obj->fromArray([{ type => -1, pValue => undef }]); };
ok( $@, '$obj->fromArray([{ type => -1, pValue => undef }])' );
$@ = undef; eval { $obj->fromArray([{ type => -1, pValue => 1 }]); };
ok( $@, '$obj->fromArray([{ type => -1, pValue => 1 }])' );
ok( $obj->fromArray([{
    type => CKA_CLASS,
    pValue => pack(((CK_ULONG_SIZE < 8) ? L : Q), 1),
}]), '$obj->fromArray(...)' );

# Crypt/PKCS11/Object.pm

$obj = eval {
    local $SIG{__WARN__} = sub {};
    Crypt::PKCS11::Object::new(undef, 1);
};
ok( blessed $obj, 'Crypt::PKCS11::Object::new' );
isa_ok( $obj = Crypt::PKCS11::Object->new(1), 'Crypt::PKCS11::Object', 'Crypt::PKCS11::Object->new' );
isa_ok( $obj = $obj->new(1), 'Crypt::PKCS11::Object', 'Crypt::PKCS11::Object $obj->new' );
$@ = undef; eval { Crypt::PKCS11::Object->new; };
ok( $@, 'Crypt::PKCS11::Object->new' );
ok( $obj->id, '$obj->id' );

# Crypt/PKCS11/Session.pm

$@ = undef; eval { Crypt::PKCS11::Session->new; };
ok( $@, 'Crypt::PKCS11::Session->new' );
$@ = undef; eval { Crypt::PKCS11::Session->new(Crypt::PKCS11::Attribute->new); };
ok( $@, 'Crypt::PKCS11::Session->new(Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { Crypt::PKCS11::Session->new(Crypt::PKCS11::XS->new); };
ok( $@, 'Crypt::PKCS11::Session->new(Crypt::PKCS11::XS->new)' );
$obj = eval {
    local $SIG{__WARN__} = sub {};
    Crypt::PKCS11::Session::new(undef, Crypt::PKCS11::XS->new, 1);
};
ok( blessed $obj, 'Crypt::PKCS11::Session::new' );
isa_ok( $obj = Crypt::PKCS11::Session->new(Crypt::PKCS11::XS->new, 1), 'Crypt::PKCS11::Session', 'Crypt::PKCS11::Session->new' );
isa_ok( $obj = $obj->new(Crypt::PKCS11::XS->new, 1), 'Crypt::PKCS11::Session', 'Crypt::PKCS11::Session $obj->new' );
{
    local $SIG{__WARN__} = sub {};
    my $sub;

    is( $obj->InitPIN, undef, '$obj->InitPIN' );
    is( $obj->InitPIN(1), undef, '$obj->InitPIN(1)' );
    is( $obj->InitPIN('abc'), undef, '$obj->InitPIN("abc")' );
    $sub = *Crypt::PKCS11::XSPtr::C_InitPIN{CODE};
    *Crypt::PKCS11::XSPtr::C_InitPIN = sub ($$) { return CKR_OK; };
    ok( $obj->InitPIN, '$obj->InitPIN' );
    *Crypt::PKCS11::XSPtr::C_InitPIN = $sub;

    is( $obj->SetPIN, undef, '$obj->SetPIN' );
    is( $obj->SetPIN(1), undef, '$obj->SetPIN(1)' );
    is( $obj->SetPIN('abc'), undef, '$obj->SetPIN("abc")' );
    is( $obj->SetPIN(1, 1), undef, '$obj->SetPIN(1, 1)' );
    is( $obj->SetPIN(1, 'abc'), undef, '$obj->SetPIN(1, "abc")' );
    $sub = *Crypt::PKCS11::XSPtr::C_SetPIN{CODE};
    *Crypt::PKCS11::XSPtr::C_SetPIN = sub ($$) { return CKR_OK; };
    ok( $obj->SetPIN, '$obj->SetPIN' );
    *Crypt::PKCS11::XSPtr::C_SetPIN = $sub;

    $sub = *Crypt::PKCS11::XSPtr::C_CloseSession{CODE};
    *Crypt::PKCS11::XSPtr::C_CloseSession = sub ($) { return CKR_GENERAL_ERROR; };
    is( $obj->CloseSession, undef, '$obj->CloseSession' );
    *Crypt::PKCS11::XSPtr::C_CloseSession = $sub;

    is( $obj->GetSessionInfo, undef, '$obj->GetSessionInfo' );
    $sub = *Crypt::PKCS11::XSPtr::C_GetSessionInfo{CODE};
    *Crypt::PKCS11::XSPtr::C_GetSessionInfo = sub ($$$) { $_[2]->{test} = 1; return CKR_OK; };
    ok( scalar (@a = $obj->GetSessionInfo), '$obj->GetSessionInfo' );
    ok( scalar $obj->GetSessionInfo, '$obj->GetSessionInfo' );
    *Crypt::PKCS11::XSPtr::C_GetSessionInfo = sub ($$$) { $_[2]=[]; return CKR_OK; };
    $@ = undef; eval { $obj->GetSessionInfo; };
    ok( $@, '$obj->GetSessionInfo' );
    *Crypt::PKCS11::XSPtr::C_GetSessionInfo = $sub;

    is( $obj->GetOperationState, undef, '$obj->GetOperationState' );
    $sub = *Crypt::PKCS11::XSPtr::C_GetOperationState{CODE};
    *Crypt::PKCS11::XSPtr::C_GetOperationState = sub ($$$) { return CKR_GENERAL_ERROR; };
    is( $obj->GetOperationState, undef, '$obj->GetOperationState' );
    *Crypt::PKCS11::XSPtr::C_GetOperationState = sub ($$$) { $_[2]=[]; return CKR_OK; };
    ok( $obj->GetOperationState, '$obj->GetOperationState' );
    *Crypt::PKCS11::XSPtr::C_GetOperationState = $sub;

    is( $obj->SetOperationState(''), undef, '$obj->SetOperationState("")' );
    is( $obj->SetOperationState('', Crypt::PKCS11::Object->new(1)), undef, '$obj->SetOperationState("", Crypt::PKCS11::Object->new(1))' );
    is( $obj->SetOperationState('', Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Object->new(1)), undef, '$obj->SetOperationState("", Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Object->new(1))' );
    is( $obj->SetOperationState('', undef, Crypt::PKCS11::Object->new(1)), undef, '$obj->SetOperationState("", undef, Crypt::PKCS11::Object->new(1))' );
    $sub = *Crypt::PKCS11::XSPtr::C_SetOperationState{CODE};
    *Crypt::PKCS11::XSPtr::C_SetOperationState = sub ($$$$) { return CKR_OK; };
    ok( $obj->SetOperationState(''), '$obj->SetOperationState("")' );
    *Crypt::PKCS11::XSPtr::C_SetOperationState = $sub;

    is( $obj->Login(1), undef, '$obj->Login(1)' );

    is( $obj->Logout, undef, '$obj->Logout' );
    $sub = *Crypt::PKCS11::XSPtr::C_Logout{CODE};
    *Crypt::PKCS11::XSPtr::C_Logout = sub ($$) { return CKR_OK; };
    ok( $obj->Logout, '$obj->Logout' );
    *Crypt::PKCS11::XSPtr::C_Logout = $sub;

    is( $obj->CreateObject(Crypt::PKCS11::Attributes->new), undef, '$obj->CreateObject(Crypt::PKCS11::Attributes->new)' );
    $sub = *Crypt::PKCS11::XSPtr::C_CreateObject{CODE};
    *Crypt::PKCS11::XSPtr::C_CreateObject = sub ($$$$) { $_[3] = 1; return CKR_OK; };
    ok( $obj->CreateObject(Crypt::PKCS11::Attributes->new), '$obj->CreateObject(Crypt::PKCS11::Attributes->new)' );
    *Crypt::PKCS11::XSPtr::C_CreateObject = $sub;

    is( $obj->CopyObject(Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attributes->new), undef, '$obj->CopyObject(Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attributes->new)' );
    $sub = *Crypt::PKCS11::XSPtr::C_CopyObject{CODE};
    *Crypt::PKCS11::XSPtr::C_CopyObject = sub ($$$$$) { $_[4] = 1; return CKR_OK; };
    ok( $obj->CopyObject(Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attributes->new), '$obj->CopyObject(Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attributes->new)' );
    *Crypt::PKCS11::XSPtr::C_CopyObject = $sub;

    is( $obj->DestroyObject(Crypt::PKCS11::Object->new(1)), undef, '$obj->DestroyObject(Crypt::PKCS11::Object->new(1))' );

    is( $obj->GetObjectSize(Crypt::PKCS11::Object->new(1)), undef, '$obj->GetObjectSize(Crypt::PKCS11::Object->new(1))' );
    $sub = *Crypt::PKCS11::XSPtr::C_GetObjectSize{CODE};
    *Crypt::PKCS11::XSPtr::C_GetObjectSize = sub ($$$$) { $_[3] = 1; return CKR_OK; };
    ok( $obj->GetObjectSize(Crypt::PKCS11::Object->new(1)), '$obj->GetObjectSize(Crypt::PKCS11::Object->new(1))' );
    *Crypt::PKCS11::XSPtr::C_GetObjectSize = $sub;

    is( $obj->GetAttributeValue(Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attributes->new), undef, '$obj->GetAttributeValue(Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attributes->new)' );
    $sub = *Crypt::PKCS11::XSPtr::C_GetAttributeValue{CODE};
    *Crypt::PKCS11::XSPtr::C_GetAttributeValue = sub ($$$$) { $_[3] = 1; return CKR_OK; };
    $@ = undef; eval { $obj->GetAttributeValue(Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attributes->new); };
    ok( $@, '$obj->GetAttributeValue(Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attributes->new)' );
    *Crypt::PKCS11::XSPtr::C_GetAttributeValue = sub ($$$$) { $_[3] = [{type => CKA_LABEL, pValue => 'abc'}]; return CKR_OK; };
    ok( scalar (@a = $obj->GetAttributeValue(Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attributes->new)), '$obj->GetAttributeValue(Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attributes->new)' );
    ok( scalar $obj->GetAttributeValue(Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attributes->new), '$obj->GetAttributeValue(Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attributes->new)' );
    *Crypt::PKCS11::XSPtr::C_GetAttributeValue = $sub;

    is( $obj->SetAttributeValue(Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attributes->new), undef, '$obj->SetAttributeValue(Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attributes->new)' );
    $sub = *Crypt::PKCS11::XSPtr::C_SetAttributeValue{CODE};
    *Crypt::PKCS11::XSPtr::C_SetAttributeValue = sub ($$$$) { return CKR_OK; };
    ok( scalar (@a = $obj->SetAttributeValue(Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attributes->new)), '$obj->SetAttributeValue(Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attributes->new)' );
    ok( scalar $obj->SetAttributeValue(Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attributes->new), '$obj->SetAttributeValue(Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attributes->new)' );
    *Crypt::PKCS11::XSPtr::C_SetAttributeValue = $sub;

    is( $obj->FindObjectsInit(Crypt::PKCS11::Attributes->new), undef, '$obj->FindObjectsInit(Crypt::PKCS11::Attributes->new)' );
    $sub = *Crypt::PKCS11::XSPtr::C_FindObjectsInit{CODE};
    *Crypt::PKCS11::XSPtr::C_FindObjectsInit = sub ($$$) { return CKR_OK; };
    ok( scalar (@a = $obj->FindObjectsInit(Crypt::PKCS11::Attributes->new)), '$obj->FindObjectsInit(Crypt::PKCS11::Attributes->new)' );
    ok( scalar $obj->FindObjectsInit(Crypt::PKCS11::Attributes->new), '$obj->FindObjectsInit(Crypt::PKCS11::Attributes->new)' );
    *Crypt::PKCS11::XSPtr::C_FindObjectsInit = $sub;

    is( $obj->FindObjects(1), undef, '$obj->FindObjects(1)' );
    $sub = *Crypt::PKCS11::XSPtr::C_FindObjects{CODE};
    *Crypt::PKCS11::XSPtr::C_FindObjects = sub ($$$$) { return CKR_OK; };
    ok( $obj->FindObjects(1), '$obj->FindObjects(1)' );
    *Crypt::PKCS11::XSPtr::C_FindObjects = sub ($$$$) { push(@{$_[2]}, 1, 1); return CKR_OK; };
    ok( scalar (@a = $obj->FindObjects(1)), '$obj->FindObjects(1)' );
    ok( scalar $obj->FindObjects(1), '$obj->FindObjects(1)' );
    *Crypt::PKCS11::XSPtr::C_FindObjects = sub ($$$$) { $_[2] = {}; return CKR_OK; };
    $@ = undef; eval { $obj->FindObjects(1); };
    ok( $@, '$obj->FindObjects(1)' );
    *Crypt::PKCS11::XSPtr::C_FindObjects = $sub;

    is( $obj->FindObjectsFinal, undef, '$obj->FindObjectsFinal' );
    $sub = *Crypt::PKCS11::XSPtr::C_FindObjectsFinal{CODE};
    *Crypt::PKCS11::XSPtr::C_FindObjectsFinal = sub ($$) { return CKR_OK; };
    ok( $obj->FindObjectsFinal, '$obj->FindObjectsFinal' );
    *Crypt::PKCS11::XSPtr::C_FindObjectsFinal = $sub;

    my $mech = Crypt::PKCS11::CK_MECHANISM->new;
    is( $mech->set_mechanism(CKM_SHA_1), CKR_OK, '$mech->set_mechanism(CKM_SHA_1)' );
    is( $mech->get_mechanism($a=1), CKR_OK, '$mech->get_mechanism($a=1)' );

    is( $obj->EncryptInit($mech, Crypt::PKCS11::Object->new(1)), undef, '$obj->EncryptInit($mech, Crypt::PKCS11::Object->new(1))' );
    $sub = *Crypt::PKCS11::XSPtr::C_EncryptInit{CODE};
    *Crypt::PKCS11::XSPtr::C_EncryptInit = sub ($$) { return CKR_OK; };
    ok( $obj->EncryptInit($mech, Crypt::PKCS11::Object->new(1)), '$obj->EncryptInit($mech, Crypt::PKCS11::Object->new(1))' );
    *Crypt::PKCS11::XSPtr::C_EncryptInit = $sub;

    is( $obj->Encrypt(''), undef, '$obj->Encrypt("")' );
    $sub = *Crypt::PKCS11::XSPtr::C_Encrypt{CODE};
    *Crypt::PKCS11::XSPtr::C_Encrypt = sub ($$$$) { $_[3] = 1; return CKR_OK; };
    ok( $obj->Encrypt(''), '$obj->Encrypt("")' );
    *Crypt::PKCS11::XSPtr::C_Encrypt = $sub;

    is( $obj->EncryptUpdate(''), undef, '$obj->EncryptUpdate("")' );
    $sub = *Crypt::PKCS11::XSPtr::C_EncryptUpdate{CODE};
    *Crypt::PKCS11::XSPtr::C_EncryptUpdate = sub ($$$$) { $_[3] = 1; return CKR_OK; };
    ok( $obj->EncryptUpdate(''), '$obj->EncryptUpdate("")' );
    *Crypt::PKCS11::XSPtr::C_EncryptUpdate = $sub;

    is( $obj->EncryptFinal, undef, '$obj->EncryptFinal' );
    $sub = *Crypt::PKCS11::XSPtr::C_EncryptFinal{CODE};
    *Crypt::PKCS11::XSPtr::C_EncryptFinal = sub ($$$) { $_[2] = 1; return CKR_OK; };
    ok( $obj->EncryptFinal, '$obj->EncryptFinal' );
    *Crypt::PKCS11::XSPtr::C_EncryptFinal = $sub;

    is( $obj->DecryptInit($mech, Crypt::PKCS11::Object->new(1)), undef, '$obj->DecryptInit($mech, Crypt::PKCS11::Object->new(1))' );
    $sub = *Crypt::PKCS11::XSPtr::C_DecryptInit{CODE};
    *Crypt::PKCS11::XSPtr::C_DecryptInit = sub ($$) { return CKR_OK; };
    ok( $obj->DecryptInit($mech, Crypt::PKCS11::Object->new(1)), '$obj->DecryptInit($mech, Crypt::PKCS11::Object->new(1))' );
    *Crypt::PKCS11::XSPtr::C_DecryptInit = $sub;

    is( $obj->Decrypt(''), undef, '$obj->Decrypt("")' );
    $sub = *Crypt::PKCS11::XSPtr::C_Decrypt{CODE};
    *Crypt::PKCS11::XSPtr::C_Decrypt = sub ($$$$) { $_[3] = 1; return CKR_OK; };
    ok( $obj->Decrypt(''), '$obj->Decrypt("")' );
    *Crypt::PKCS11::XSPtr::C_Decrypt = $sub;

    is( $obj->DecryptUpdate(''), undef, '$obj->DecryptUpdate("")' );
    $sub = *Crypt::PKCS11::XSPtr::C_DecryptUpdate{CODE};
    *Crypt::PKCS11::XSPtr::C_DecryptUpdate = sub ($$$$) { $_[3] = 1; return CKR_OK; };
    ok( $obj->DecryptUpdate(''), '$obj->DecryptUpdate("")' );
    *Crypt::PKCS11::XSPtr::C_DecryptUpdate = $sub;

    is( $obj->DecryptFinal, undef, '$obj->DecryptFinal' );
    $sub = *Crypt::PKCS11::XSPtr::C_DecryptFinal{CODE};
    *Crypt::PKCS11::XSPtr::C_DecryptFinal = sub ($$$) { $_[2] = 1; return CKR_OK; };
    ok( $obj->DecryptFinal, '$obj->DecryptFinal' );
    *Crypt::PKCS11::XSPtr::C_DecryptFinal = $sub;

    is( $obj->DigestInit($mech, Crypt::PKCS11::Object->new(1)), undef, '$obj->DigestInit($mech, Crypt::PKCS11::Object->new(1))' );
    $sub = *Crypt::PKCS11::XSPtr::C_DigestInit{CODE};
    *Crypt::PKCS11::XSPtr::C_DigestInit = sub ($$) { return CKR_OK; };
    ok( $obj->DigestInit($mech, Crypt::PKCS11::Object->new(1)), '$obj->DigestInit($mech, Crypt::PKCS11::Object->new(1))' );
    *Crypt::PKCS11::XSPtr::C_DigestInit = $sub;

    is( $obj->Digest(''), undef, '$obj->Digest("")' );
    $sub = *Crypt::PKCS11::XSPtr::C_Digest{CODE};
    *Crypt::PKCS11::XSPtr::C_Digest = sub ($$$$) { $_[3] = 1; return CKR_OK; };
    ok( $obj->Digest(''), '$obj->Digest("")' );
    *Crypt::PKCS11::XSPtr::C_Digest = $sub;

    is( $obj->DigestUpdate(''), undef, '$obj->DigestUpdate("")' );
    $sub = *Crypt::PKCS11::XSPtr::C_DigestUpdate{CODE};
    *Crypt::PKCS11::XSPtr::C_DigestUpdate = sub ($$$$) { return CKR_OK; };
    ok( $obj->DigestUpdate(''), '$obj->DigestUpdate("")' );
    *Crypt::PKCS11::XSPtr::C_DigestUpdate = $sub;

    is( $obj->DigestKey(Crypt::PKCS11::Object->new(1)), undef, '$obj->DigestKey(Crypt::PKCS11::Object->new(1))' );
    $sub = *Crypt::PKCS11::XSPtr::C_DigestKey{CODE};
    *Crypt::PKCS11::XSPtr::C_DigestKey = sub ($$$$) { return CKR_OK; };
    ok( $obj->DigestKey(Crypt::PKCS11::Object->new(1)), '$obj->DigestKey(Crypt::PKCS11::Object->new(1))' );
    *Crypt::PKCS11::XSPtr::C_DigestKey = $sub;

    is( $obj->DigestFinal, undef, '$obj->DigestFinal' );
    $sub = *Crypt::PKCS11::XSPtr::C_DigestFinal{CODE};
    *Crypt::PKCS11::XSPtr::C_DigestFinal = sub ($$$) { $_[2] = 1; return CKR_OK; };
    ok( $obj->DigestFinal, '$obj->DigestFinal' );
    *Crypt::PKCS11::XSPtr::C_DigestFinal = $sub;

    is( $obj->SignInit($mech, Crypt::PKCS11::Object->new(1)), undef, '$obj->SignInit($mech, Crypt::PKCS11::Object->new(1))' );
    $sub = *Crypt::PKCS11::XSPtr::C_SignInit{CODE};
    *Crypt::PKCS11::XSPtr::C_SignInit = sub ($$) { return CKR_OK; };
    ok( $obj->SignInit($mech, Crypt::PKCS11::Object->new(1)), '$obj->SignInit($mech, Crypt::PKCS11::Object->new(1))' );
    *Crypt::PKCS11::XSPtr::C_SignInit = $sub;

    is( $obj->Sign(''), undef, '$obj->Sign("")' );
    $sub = *Crypt::PKCS11::XSPtr::C_Sign{CODE};
    *Crypt::PKCS11::XSPtr::C_Sign = sub ($$$$) { $_[3] = 1; return CKR_OK; };
    ok( $obj->Sign(''), '$obj->Sign("")' );
    *Crypt::PKCS11::XSPtr::C_Sign = $sub;

    is( $obj->SignUpdate(''), undef, '$obj->SignUpdate("")' );
    $sub = *Crypt::PKCS11::XSPtr::C_SignUpdate{CODE};
    *Crypt::PKCS11::XSPtr::C_SignUpdate = sub ($$$$) { $_[3] = 1; return CKR_OK; };
    ok( $obj->SignUpdate(''), '$obj->SignUpdate("")' );
    *Crypt::PKCS11::XSPtr::C_SignUpdate = $sub;

    is( $obj->SignFinal, undef, '$obj->SignFinal' );
    $sub = *Crypt::PKCS11::XSPtr::C_SignFinal{CODE};
    *Crypt::PKCS11::XSPtr::C_SignFinal = sub ($$$) { $_[2] = 1; return CKR_OK; };
    ok( $obj->SignFinal, '$obj->SignFinal' );
    *Crypt::PKCS11::XSPtr::C_SignFinal = $sub;

    is( $obj->SignRecoverInit($mech, Crypt::PKCS11::Object->new(1)), undef, '$obj->SignRecoverInit($mech, Crypt::PKCS11::Object->new(1))' );
    $sub = *Crypt::PKCS11::XSPtr::C_SignRecoverInit{CODE};
    *Crypt::PKCS11::XSPtr::C_SignRecoverInit = sub ($$) { return CKR_OK; };
    ok( $obj->SignRecoverInit($mech, Crypt::PKCS11::Object->new(1)), '$obj->SignRecoverInit($mech, Crypt::PKCS11::Object->new(1))' );
    *Crypt::PKCS11::XSPtr::C_SignRecoverInit = $sub;

    is( $obj->SignRecover(''), undef, '$obj->SignRecover("")' );
    $sub = *Crypt::PKCS11::XSPtr::C_SignRecover{CODE};
    *Crypt::PKCS11::XSPtr::C_SignRecover = sub ($$$$) { $_[3] = 1; return CKR_OK; };
    ok( $obj->SignRecover(''), '$obj->SignRecover("")' );
    *Crypt::PKCS11::XSPtr::C_SignRecover = $sub;

    is( $obj->VerifyInit($mech, Crypt::PKCS11::Object->new(1)), undef, '$obj->VerifyInit($mech, Crypt::PKCS11::Object->new(1))' );
    $sub = *Crypt::PKCS11::XSPtr::C_VerifyInit{CODE};
    *Crypt::PKCS11::XSPtr::C_VerifyInit = sub ($$) { return CKR_OK; };
    ok( $obj->VerifyInit($mech, Crypt::PKCS11::Object->new(1)), '$obj->VerifyInit($mech, Crypt::PKCS11::Object->new(1))' );
    *Crypt::PKCS11::XSPtr::C_VerifyInit = $sub;

    is( $obj->Verify('', ''), undef, '$obj->Verify("", "")' );
    $sub = *Crypt::PKCS11::XSPtr::C_Verify{CODE};
    *Crypt::PKCS11::XSPtr::C_Verify = sub ($$$$) { $_[3] = 1; return CKR_OK; };
    ok( $obj->Verify('', ''), '$obj->Verify("", "")' );
    *Crypt::PKCS11::XSPtr::C_Verify = $sub;

    is( $obj->VerifyUpdate(''), undef, '$obj->VerifyUpdate("")' );
    $sub = *Crypt::PKCS11::XSPtr::C_VerifyUpdate{CODE};
    *Crypt::PKCS11::XSPtr::C_VerifyUpdate = sub ($$$$) { return CKR_OK; };
    ok( $obj->VerifyUpdate(''), '$obj->VerifyUpdate("")' );
    *Crypt::PKCS11::XSPtr::C_VerifyUpdate = $sub;

    is( $obj->VerifyFinal(''), undef, '$obj->VerifyFinal("")' );
    $sub = *Crypt::PKCS11::XSPtr::C_VerifyFinal{CODE};
    *Crypt::PKCS11::XSPtr::C_VerifyFinal = sub ($$$) { $_[2] = 1; return CKR_OK; };
    ok( $obj->VerifyFinal(''), '$obj->VerifyFinal("")' );
    *Crypt::PKCS11::XSPtr::C_VerifyFinal = $sub;

    is( $obj->VerifyRecoverInit($mech, Crypt::PKCS11::Object->new(1)), undef, '$obj->VerifyRecoverInit($mech, Crypt::PKCS11::Object->new(1))' );
    $sub = *Crypt::PKCS11::XSPtr::C_VerifyRecoverInit{CODE};
    *Crypt::PKCS11::XSPtr::C_VerifyRecoverInit = sub ($$) { return CKR_OK; };
    ok( $obj->VerifyRecoverInit($mech, Crypt::PKCS11::Object->new(1)), '$obj->VerifyRecoverInit($mech, Crypt::PKCS11::Object->new(1))' );
    *Crypt::PKCS11::XSPtr::C_VerifyRecoverInit = $sub;

    is( $obj->VerifyRecover(''), undef, '$obj->VerifyRecover("")' );
    $sub = *Crypt::PKCS11::XSPtr::C_VerifyRecover{CODE};
    *Crypt::PKCS11::XSPtr::C_VerifyRecover = sub ($$$$) { $_[3] = 1; return CKR_OK; };
    ok( $obj->VerifyRecover(''), '$obj->VerifyRecover("")' );
    *Crypt::PKCS11::XSPtr::C_VerifyRecover = $sub;

    is( $obj->DigestEncryptUpdate(''), undef, '$obj->DigestEncryptUpdate("")' );
    $sub = *Crypt::PKCS11::XSPtr::C_DigestEncryptUpdate{CODE};
    *Crypt::PKCS11::XSPtr::C_DigestEncryptUpdate = sub ($$$$) { $_[3] = 1; return CKR_OK; };
    ok( $obj->DigestEncryptUpdate(''), '$obj->DigestEncryptUpdate("")' );
    *Crypt::PKCS11::XSPtr::C_DigestEncryptUpdate = $sub;

    is( $obj->DecryptDigestUpdate(''), undef, '$obj->DecryptDigestUpdate("")' );
    $sub = *Crypt::PKCS11::XSPtr::C_DecryptDigestUpdate{CODE};
    *Crypt::PKCS11::XSPtr::C_DecryptDigestUpdate = sub ($$$$) { $_[3] = 1; return CKR_OK; };
    ok( $obj->DecryptDigestUpdate(''), '$obj->DecryptDigestUpdate("")' );
    *Crypt::PKCS11::XSPtr::C_DecryptDigestUpdate = $sub;

    is( $obj->SignEncryptUpdate(''), undef, '$obj->SignEncryptUpdate("")' );
    $sub = *Crypt::PKCS11::XSPtr::C_SignEncryptUpdate{CODE};
    *Crypt::PKCS11::XSPtr::C_SignEncryptUpdate = sub ($$$$) { $_[3] = 1; return CKR_OK; };
    ok( $obj->SignEncryptUpdate(''), '$obj->SignEncryptUpdate("")' );
    *Crypt::PKCS11::XSPtr::C_SignEncryptUpdate = $sub;

    is( $obj->DecryptVerifyUpdate(''), undef, '$obj->DecryptVerifyUpdate("")' );
    $sub = *Crypt::PKCS11::XSPtr::C_DecryptVerifyUpdate{CODE};
    *Crypt::PKCS11::XSPtr::C_DecryptVerifyUpdate = sub ($$$$) { $_[3] = 1; return CKR_OK; };
    ok( $obj->DecryptVerifyUpdate(''), '$obj->DecryptVerifyUpdate("")' );
    *Crypt::PKCS11::XSPtr::C_DecryptVerifyUpdate = $sub;

    is( $obj->GenerateKey($mech, Crypt::PKCS11::Attributes->new), undef, '$obj->GenerateKey($mech, Crypt::PKCS11::Attributes->new)' );
    $sub = *Crypt::PKCS11::XSPtr::C_GenerateKey{CODE};
    *Crypt::PKCS11::XSPtr::C_GenerateKey = sub ($$$$$) { $_[4] = 1; return CKR_OK; };
    ok( $obj->GenerateKey($mech, Crypt::PKCS11::Attributes->new), '$obj->GenerateKey($mech, Crypt::PKCS11::Attributes->new)' );
    *Crypt::PKCS11::XSPtr::C_GenerateKey = $sub;

    is( $obj->GenerateKeyPair($mech, Crypt::PKCS11::Attributes->new, Crypt::PKCS11::Attributes->new), CKR_GENERAL_ERROR, '$obj->GenerateKeyPair($mech, Crypt::PKCS11::Attributes->new, Crypt::PKCS11::Attributes->new)' );
    $sub = *Crypt::PKCS11::XSPtr::C_GenerateKeyPair{CODE};
    *Crypt::PKCS11::XSPtr::C_GenerateKeyPair = sub ($$$$$$$) { $_[5] = 1; $_[6] = 1; return CKR_OK; };
    ok( scalar (@a = $obj->GenerateKeyPair($mech, Crypt::PKCS11::Attributes->new, Crypt::PKCS11::Attributes->new)), '$obj->GenerateKeyPair($mech, Crypt::PKCS11::Attributes->new, Crypt::PKCS11::Attributes->new)' );
    ok( scalar $obj->GenerateKeyPair($mech, Crypt::PKCS11::Attributes->new, Crypt::PKCS11::Attributes->new), '$obj->GenerateKeyPair($mech, Crypt::PKCS11::Attributes->new, Crypt::PKCS11::Attributes->new)' );
    *Crypt::PKCS11::XSPtr::C_GenerateKeyPair = $sub;

    is( $obj->WrapKey($mech, Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Object->new(1)), undef, '$obj->WrapKey($mech, Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Object->new(1))' );
    $sub = *Crypt::PKCS11::XSPtr::C_WrapKey{CODE};
    *Crypt::PKCS11::XSPtr::C_WrapKey = sub ($$$$$$) { $_[5] = 1; return CKR_OK; };
    ok( $obj->WrapKey($mech, Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Object->new(1)), '$obj->WrapKey($mech, Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Object->new(1))' );
    *Crypt::PKCS11::XSPtr::C_WrapKey = $sub;

    is( $obj->UnwrapKey($mech, Crypt::PKCS11::Object->new(1), '', Crypt::PKCS11::Attributes->new), undef, '$obj->UnwrapKey($mech, Crypt::PKCS11::Object->new(1), "", Crypt::PKCS11::Attributes->new)' );
    $sub = *Crypt::PKCS11::XSPtr::C_UnwrapKey{CODE};
    *Crypt::PKCS11::XSPtr::C_UnwrapKey = sub ($$$$$$$) { $_[6] = 1; return CKR_OK; };
    ok( $obj->UnwrapKey($mech, Crypt::PKCS11::Object->new(1), '', Crypt::PKCS11::Attributes->new), '$obj->UnwrapKey($mech, Crypt::PKCS11::Object->new(1), "", Crypt::PKCS11::Attributes->new)' );
    *Crypt::PKCS11::XSPtr::C_UnwrapKey = $sub;

    is( $obj->DeriveKey($mech, Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attributes->new), undef, '$obj->DeriveKey($mech, Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attributes->new)' );
    $sub = *Crypt::PKCS11::XSPtr::C_DeriveKey{CODE};
    *Crypt::PKCS11::XSPtr::C_DeriveKey = sub ($$$$$$) { $_[5] = 1; return CKR_OK; };
    ok( $obj->DeriveKey($mech, Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attributes->new), '$obj->DeriveKey($mech, Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attributes->new)' );
    *Crypt::PKCS11::XSPtr::C_DeriveKey = $sub;

    is( $obj->SeedRandom(''), undef, '$obj->SeedRandom("")' );
    $sub = *Crypt::PKCS11::XSPtr::C_SeedRandom{CODE};
    *Crypt::PKCS11::XSPtr::C_SeedRandom = sub ($$$) { return CKR_OK; };
    ok( $obj->SeedRandom(''), '$obj->SeedRandom("")' );
    *Crypt::PKCS11::XSPtr::C_SeedRandom = $sub;

    is( $obj->GenerateRandom(''), undef, '$obj->GenerateRandom("")' );
    $sub = *Crypt::PKCS11::XSPtr::C_GenerateRandom{CODE};
    *Crypt::PKCS11::XSPtr::C_GenerateRandom = sub ($$$$) { $_[2] = 1; return CKR_OK; };
    ok( $obj->GenerateRandom(''), '$obj->GenerateRandom("")' );
    *Crypt::PKCS11::XSPtr::C_GenerateRandom = $sub;

    is( $obj->GetFunctionStatus, CKR_GENERAL_ERROR, '$obj->GetFunctionStatus' );
    is( $obj->CancelFunction, CKR_GENERAL_ERROR, '$obj->CancelFunction' );
}

$@ = undef; eval { $obj->InitPIN(''); };
ok( $@, '$obj->InitPIN("")' );
$@ = undef; eval { $obj->SetPIN(''); };
ok( $@, '$obj->SetPIN("")' );
$@ = undef; eval { $obj->SetPIN('a', ''); };
ok( $@, '$obj->SetPIN("a", "")' );
$@ = undef; eval { $obj->SetOperationState; };
ok( $@, '$obj->SetOperationState' );
$@ = undef; eval { $obj->SetOperationState(1, 1); };
ok( $@, '$obj->SetOperationState(1, 1)' );
$@ = undef; eval { $obj->SetOperationState(1, Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->SetOperationState(1, Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->SetOperationState(1, Crypt::PKCS11::Object->new(1), 1); };
ok( $@, '$obj->SetOperationState(1, Crypt::PKCS11::Object->new(1), 1)' );
$@ = undef; eval { $obj->SetOperationState(1, Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->SetOperationState(1, Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->Login; };
ok( $@, '$obj->Login' );
$@ = undef; eval { $obj->CreateObject; };
ok( $@, '$obj->CreateObject' );
$@ = undef; eval { $obj->CreateObject(1); };
ok( $@, '$obj->CreateObject(1)' );
$@ = undef; eval { $obj->CreateObject(Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->CreateObject(Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->CreateObject(Crypt::PKCS11::Object->new(1)); };
ok( $@, '$obj->CreateObject(Crypt::PKCS11::Object->new(1))' );
$@ = undef; eval { $obj->CreateObject(Crypt::PKCS11::Object->new(1), 1); };
ok( $@, '$obj->CreateObject(Crypt::PKCS11::Object->new(1), 1)' );
$@ = undef; eval { $obj->CreateObject(Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->CreateObject(Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->CopyObject; };
ok( $@, '$obj->CopyObject' );
$@ = undef; eval { $obj->CopyObject(1); };
ok( $@, '$obj->CopyObject(1)' );
$@ = undef; eval { $obj->CopyObject(Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->CopyObject(Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->CopyObject(Crypt::PKCS11::Object->new(1)); };
ok( $@, '$obj->CopyObject(Crypt::PKCS11::Object->new(1))' );
$@ = undef; eval { $obj->CopyObject(Crypt::PKCS11::Object->new(1), 1); };
ok( $@, '$obj->CopyObject(Crypt::PKCS11::Object->new(1), 1)' );
$@ = undef; eval { $obj->CopyObject(Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->CopyObject(Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->DestroyObject; };
ok( $@, '$obj->DestroyObject' );
$@ = undef; eval { $obj->DestroyObject(1); };
ok( $@, '$obj->DestroyObject(1)' );
$@ = undef; eval { $obj->DestroyObject(Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->DestroyObject(Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->GetObjectSize; };
ok( $@, '$obj->GetObjectSize' );
$@ = undef; eval { $obj->GetObjectSize(1); };
ok( $@, '$obj->GetObjectSize(1)' );
$@ = undef; eval { $obj->GetObjectSize(Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->GetObjectSize(Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->GetAttributeValue; };
ok( $@, '$obj->GetAttributeValue' );
$@ = undef; eval { $obj->GetAttributeValue(1); };
ok( $@, '$obj->GetAttributeValue(1)' );
$@ = undef; eval { $obj->GetAttributeValue(Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->GetAttributeValue(Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->GetAttributeValue(Crypt::PKCS11::Object->new(1)); };
ok( $@, '$obj->GetAttributeValue(Crypt::PKCS11::Object->new(1))' );
$@ = undef; eval { $obj->GetAttributeValue(Crypt::PKCS11::Object->new(1), 1); };
ok( $@, '$obj->GetAttributeValue(Crypt::PKCS11::Object->new(1), 1)' );
$@ = undef; eval { $obj->GetAttributeValue(Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->GetAttributeValue(Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->SetAttributeValue; };
ok( $@, '$obj->SetAttributeValue' );
$@ = undef; eval { $obj->SetAttributeValue(1); };
ok( $@, '$obj->SetAttributeValue(1)' );
$@ = undef; eval { $obj->SetAttributeValue(Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->SetAttributeValue(Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->SetAttributeValue(Crypt::PKCS11::Object->new(1)); };
ok( $@, '$obj->SetAttributeValue(Crypt::PKCS11::Object->new(1))' );
$@ = undef; eval { $obj->SetAttributeValue(Crypt::PKCS11::Object->new(1), 1); };
ok( $@, '$obj->SetAttributeValue(Crypt::PKCS11::Object->new(1), 1)' );
$@ = undef; eval { $obj->SetAttributeValue(Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->SetAttributeValue(Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->FindObjectsInit; };
ok( $@, '$obj->FindObjectsInit' );
$@ = undef; eval { $obj->FindObjectsInit(1); };
ok( $@, '$obj->FindObjectsInit(1)' );
$@ = undef; eval { $obj->FindObjectsInit(Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->FindObjectsInit(Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->FindObjects; };
ok( $@, '$obj->FindObjects' );
$@ = undef; eval { $obj->EncryptInit; };
ok( $@, '$obj->EncryptInit' );
$@ = undef; eval { $obj->EncryptInit(1); };
ok( $@, '$obj->EncryptInit(1)' );
$@ = undef; eval { $obj->EncryptInit(Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->EncryptInit(Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->EncryptInit(Crypt::PKCS11::CK_MECHANISM->new); };
ok( $@, '$obj->EncryptInit(Crypt::PKCS11::CK_MECHANISM->new)' );
$@ = undef; eval { $obj->EncryptInit(Crypt::PKCS11::CK_MECHANISM->new, 1); };
ok( $@, '$obj->EncryptInit(Crypt::PKCS11::CK_MECHANISM->new, 1)' );
$@ = undef; eval { $obj->EncryptInit(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->EncryptInit(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->Encrypt; };
ok( $@, '$obj->Encrypt' );
$@ = undef; eval { $obj->EncryptUpdate; };
ok( $@, '$obj->EncryptUpdate' );
$@ = undef; eval { $obj->DecryptInit; };
ok( $@, '$obj->DecryptInit' );
$@ = undef; eval { $obj->DecryptInit(1); };
ok( $@, '$obj->DecryptInit(1)' );
$@ = undef; eval { $obj->DecryptInit(Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->DecryptInit(Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->DecryptInit(Crypt::PKCS11::CK_MECHANISM->new); };
ok( $@, '$obj->DecryptInit(Crypt::PKCS11::CK_MECHANISM->new)' );
$@ = undef; eval { $obj->DecryptInit(Crypt::PKCS11::CK_MECHANISM->new, 1); };
ok( $@, '$obj->DecryptInit(Crypt::PKCS11::CK_MECHANISM->new, 1)' );
$@ = undef; eval { $obj->DecryptInit(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->DecryptInit(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->Decrypt; };
ok( $@, '$obj->Decrypt' );
$@ = undef; eval { $obj->DecryptUpdate; };
ok( $@, '$obj->DecryptUpdate' );
$@ = undef; eval { $obj->DigestInit; };
ok( $@, '$obj->DigestInit' );
$@ = undef; eval { $obj->DigestInit(1); };
ok( $@, '$obj->DigestInit(1)' );
$@ = undef; eval { $obj->DigestInit(Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->DigestInit(Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->Digest; };
ok( $@, '$obj->Digest' );
$@ = undef; eval { $obj->DigestUpdate; };
ok( $@, '$obj->DigestUpdate' );
$@ = undef; eval { $obj->DigestKey; };
ok( $@, '$obj->DigestKey' );
$@ = undef; eval { $obj->DigestKey(1); };
ok( $@, '$obj->DigestKey(1)' );
$@ = undef; eval { $obj->DigestKey(Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->DigestKey(Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->SignInit; };
ok( $@, '$obj->SignInit' );
$@ = undef; eval { $obj->SignInit(1); };
ok( $@, '$obj->SignInit(1)' );
$@ = undef; eval { $obj->SignInit(Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->SignInit(Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->SignInit(Crypt::PKCS11::CK_MECHANISM->new); };
ok( $@, '$obj->SignInit(Crypt::PKCS11::CK_MECHANISM->new)' );
$@ = undef; eval { $obj->SignInit(Crypt::PKCS11::CK_MECHANISM->new, 1); };
ok( $@, '$obj->SignInit(Crypt::PKCS11::CK_MECHANISM->new, 1)' );
$@ = undef; eval { $obj->SignInit(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->SignInit(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->Sign; };
ok( $@, '$obj->Sign' );
$@ = undef; eval { $obj->SignUpdate; };
ok( $@, '$obj->SignUpdate' );
$@ = undef; eval { $obj->SignRecoverInit; };
ok( $@, '$obj->SignRecoverInit' );
$@ = undef; eval { $obj->SignRecoverInit(1); };
ok( $@, '$obj->SignRecoverInit(1)' );
$@ = undef; eval { $obj->SignRecoverInit(Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->SignRecoverInit(Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->SignRecoverInit(Crypt::PKCS11::CK_MECHANISM->new); };
ok( $@, '$obj->SignRecoverInit(Crypt::PKCS11::CK_MECHANISM->new)' );
$@ = undef; eval { $obj->SignRecoverInit(Crypt::PKCS11::CK_MECHANISM->new, 1); };
ok( $@, '$obj->SignRecoverInit(Crypt::PKCS11::CK_MECHANISM->new, 1)' );
$@ = undef; eval { $obj->SignRecoverInit(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->SignRecoverInit(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->SignRecover; };
ok( $@, '$obj->SignRecover' );
$@ = undef; eval { $obj->VerifyInit; };
ok( $@, '$obj->VerifyInit' );
$@ = undef; eval { $obj->VerifyInit(1); };
ok( $@, '$obj->VerifyInit(1)' );
$@ = undef; eval { $obj->VerifyInit(Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->VerifyInit(Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->VerifyInit(Crypt::PKCS11::CK_MECHANISM->new); };
ok( $@, '$obj->VerifyInit(Crypt::PKCS11::CK_MECHANISM->new)' );
$@ = undef; eval { $obj->VerifyInit(Crypt::PKCS11::CK_MECHANISM->new, 1); };
ok( $@, '$obj->VerifyInit(Crypt::PKCS11::CK_MECHANISM->new, 1)' );
$@ = undef; eval { $obj->VerifyInit(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->VerifyInit(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->Verify; };
ok( $@, '$obj->Verify' );
$@ = undef; eval { $obj->Verify(1); };
ok( $@, '$obj->Verify(1)' );
$@ = undef; eval { $obj->VerifyUpdate; };
ok( $@, '$obj->VerifyUpdate' );
$@ = undef; eval { $obj->VerifyFinal; };
ok( $@, '$obj->VerifyFinal' );
$@ = undef; eval { $obj->VerifyRecoverInit; };
ok( $@, '$obj->VerifyRecoverInit' );
$@ = undef; eval { $obj->VerifyRecoverInit(1); };
ok( $@, '$obj->VerifyRecoverInit(1)' );
$@ = undef; eval { $obj->VerifyRecoverInit(Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->VerifyRecoverInit(Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->VerifyRecoverInit(Crypt::PKCS11::CK_MECHANISM->new); };
ok( $@, '$obj->VerifyRecoverInit(Crypt::PKCS11::CK_MECHANISM->new)' );
$@ = undef; eval { $obj->VerifyRecoverInit(Crypt::PKCS11::CK_MECHANISM->new, 1); };
ok( $@, '$obj->VerifyRecoverInit(Crypt::PKCS11::CK_MECHANISM->new, 1)' );
$@ = undef; eval { $obj->VerifyRecoverInit(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->VerifyRecoverInit(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->VerifyRecover; };
ok( $@, '$obj->VerifyRecover' );
$@ = undef; eval { $obj->DigestEncryptUpdate; };
ok( $@, '$obj->DigestEncryptUpdate' );
$@ = undef; eval { $obj->DecryptDigestUpdate; };
ok( $@, '$obj->DecryptDigestUpdate' );
$@ = undef; eval { $obj->SignEncryptUpdate; };
ok( $@, '$obj->SignEncryptUpdate' );
$@ = undef; eval { $obj->DecryptVerifyUpdate; };
ok( $@, '$obj->DecryptVerifyUpdate' );
$@ = undef; eval { $obj->GenerateKey; };
ok( $@, '$obj->GenerateKey' );
$@ = undef; eval { $obj->GenerateKey(1); };
ok( $@, '$obj->GenerateKey(1)' );
$@ = undef; eval { $obj->GenerateKey(Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->GenerateKey(Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->GenerateKey(Crypt::PKCS11::CK_MECHANISM->new); };
ok( $@, '$obj->GenerateKey(Crypt::PKCS11::CK_MECHANISM->new)' );
$@ = undef; eval { $obj->GenerateKey(Crypt::PKCS11::CK_MECHANISM->new, 1); };
ok( $@, '$obj->GenerateKey(Crypt::PKCS11::CK_MECHANISM->new, 1)' );
$@ = undef; eval { $obj->GenerateKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->GenerateKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->GenerateKeyPair; };
ok( $@, '$obj->GenerateKeyPair' );
$@ = undef; eval { $obj->GenerateKeyPair(1); };
ok( $@, '$obj->GenerateKeyPair(1)' );
$@ = undef; eval { $obj->GenerateKeyPair(Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->GenerateKeyPair(Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->GenerateKeyPair(Crypt::PKCS11::CK_MECHANISM->new); };
ok( $@, '$obj->GenerateKeyPair(Crypt::PKCS11::CK_MECHANISM->new)' );
$@ = undef; eval { $obj->GenerateKeyPair(Crypt::PKCS11::CK_MECHANISM->new, 1); };
ok( $@, '$obj->GenerateKeyPair(Crypt::PKCS11::CK_MECHANISM->new, 1)' );
$@ = undef; eval { $obj->GenerateKeyPair(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->GenerateKeyPair(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->GenerateKeyPair(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attributes->new); };
ok( $@, '$obj->GenerateKeyPair(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attributes->new)' );
$@ = undef; eval { $obj->GenerateKeyPair(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attributes->new, 1); };
ok( $@, '$obj->GenerateKeyPair(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attributes->new, 1)' );
$@ = undef; eval { $obj->GenerateKeyPair(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attributes->new, Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->GenerateKeyPair(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attributes->new, Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->WrapKey; };
ok( $@, '$obj->WrapKey' );
$@ = undef; eval { $obj->WrapKey(1); };
ok( $@, '$obj->WrapKey(1)' );
$@ = undef; eval { $obj->WrapKey(Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->WrapKey(Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->WrapKey(Crypt::PKCS11::CK_MECHANISM->new); };
ok( $@, '$obj->WrapKey(Crypt::PKCS11::CK_MECHANISM->new)' );
$@ = undef; eval { $obj->WrapKey(Crypt::PKCS11::CK_MECHANISM->new, 1); };
ok( $@, '$obj->WrapKey(Crypt::PKCS11::CK_MECHANISM->new, 1)' );
$@ = undef; eval { $obj->WrapKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->WrapKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->WrapKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Object->new(1)); };
ok( $@, '$obj->WrapKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Object->new(1))' );
$@ = undef; eval { $obj->WrapKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Object->new(1), 1); };
ok( $@, '$obj->WrapKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Object->new(1), 1)' );
$@ = undef; eval { $obj->WrapKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->WrapKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->UnwrapKey; };
ok( $@, '$obj->UnwrapKey' );
$@ = undef; eval { $obj->UnwrapKey(1); };
ok( $@, '$obj->UnwrapKey(1)' );
$@ = undef; eval { $obj->UnwrapKey(Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->UnwrapKey(Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->UnwrapKey(Crypt::PKCS11::CK_MECHANISM->new); };
ok( $@, '$obj->UnwrapKey(Crypt::PKCS11::CK_MECHANISM->new)' );
$@ = undef; eval { $obj->UnwrapKey(Crypt::PKCS11::CK_MECHANISM->new, 1); };
ok( $@, '$obj->UnwrapKey(Crypt::PKCS11::CK_MECHANISM->new, 1)' );
$@ = undef; eval { $obj->UnwrapKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->UnwrapKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->UnwrapKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Object->new(1)); };
ok( $@, '$obj->UnwrapKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Object->new(1))' );
$@ = undef; eval { $obj->UnwrapKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Object->new(1), 1); };
ok( $@, '$obj->UnwrapKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Object->new(1), 1)' );
$@ = undef; eval { $obj->UnwrapKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Object->new(1), 1, 1); };
ok( $@, '$obj->UnwrapKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Object->new(1), 1, 1)' );
$@ = undef; eval { $obj->UnwrapKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Object->new(1), 1, Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->UnwrapKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Object->new(1), 1, Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->DeriveKey; };
ok( $@, '$obj->DeriveKey' );
$@ = undef; eval { $obj->DeriveKey(1); };
ok( $@, '$obj->DeriveKey(1)' );
$@ = undef; eval { $obj->DeriveKey(Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->DeriveKey(Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->DeriveKey(Crypt::PKCS11::CK_MECHANISM->new); };
ok( $@, '$obj->DeriveKey(Crypt::PKCS11::CK_MECHANISM->new)' );
$@ = undef; eval { $obj->DeriveKey(Crypt::PKCS11::CK_MECHANISM->new, 1); };
ok( $@, '$obj->DeriveKey(Crypt::PKCS11::CK_MECHANISM->new, 1)' );
$@ = undef; eval { $obj->DeriveKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->DeriveKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->DeriveKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Object->new(1)); };
ok( $@, '$obj->DeriveKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Object->new(1))' );
$@ = undef; eval { $obj->DeriveKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Object->new(1), 1); };
ok( $@, '$obj->DeriveKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Object->new(1), 1)' );
$@ = undef; eval { $obj->DeriveKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attribute->new); };
ok( $@, '$obj->DeriveKey(Crypt::PKCS11::CK_MECHANISM->new, Crypt::PKCS11::Object->new(1), Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->SeedRandom; };
ok( $@, '$obj->SeedRandom' );
$@ = undef; eval { $obj->GenerateRandom; };
ok( $@, '$obj->GenerateRandom' );

delete $obj->{session};
$@ = undef; eval { $obj->InitPIN; };
ok( $@, '$obj->InitPIN' );
$@ = undef; eval { $obj->SetPIN; };
ok( $@, '$obj->SetPIN' );
$@ = undef; eval { $obj->CloseSession; };
ok( $@, '$obj->CloseSession' );
$@ = undef; eval { $obj->GetSessionInfo; };
ok( $@, '$obj->GetSessionInfo' );
$@ = undef; eval { $obj->GetOperationState; };
ok( $@, '$obj->GetOperationState' );
$@ = undef; eval { $obj->SetOperationState; };
ok( $@, '$obj->SetOperationState' );
$@ = undef; eval { $obj->Login; };
ok( $@, '$obj->Login' );
$@ = undef; eval { $obj->Logout; };
ok( $@, '$obj->Logout' );
$@ = undef; eval { $obj->CreateObject; };
ok( $@, '$obj->CreateObject' );
$@ = undef; eval { $obj->CopyObject; };
ok( $@, '$obj->CopyObject' );
$@ = undef; eval { $obj->DestroyObject; };
ok( $@, '$obj->DestroyObject' );
$@ = undef; eval { $obj->GetObjectSize; };
ok( $@, '$obj->GetObjectSize' );
$@ = undef; eval { $obj->GetAttributeValue; };
ok( $@, '$obj->GetAttributeValue' );
$@ = undef; eval { $obj->SetAttributeValue; };
ok( $@, '$obj->SetAttributeValue' );
$@ = undef; eval { $obj->FindObjectsInit; };
ok( $@, '$obj->FindObjectsInit' );
$@ = undef; eval { $obj->FindObjects; };
ok( $@, '$obj->FindObjects' );
$@ = undef; eval { $obj->FindObjectsFinal; };
ok( $@, '$obj->FindObjectsFinal' );
$@ = undef; eval { $obj->EncryptInit; };
ok( $@, '$obj->EncryptInit' );
$@ = undef; eval { $obj->Encrypt; };
ok( $@, '$obj->Encrypt' );
$@ = undef; eval { $obj->EncryptUpdate; };
ok( $@, '$obj->EncryptUpdate' );
$@ = undef; eval { $obj->EncryptFinal; };
ok( $@, '$obj->EncryptFinal' );
$@ = undef; eval { $obj->DecryptInit; };
ok( $@, '$obj->DecryptInit' );
$@ = undef; eval { $obj->Decrypt; };
ok( $@, '$obj->Decrypt' );
$@ = undef; eval { $obj->DecryptUpdate; };
ok( $@, '$obj->DecryptUpdate' );
$@ = undef; eval { $obj->DecryptFinal; };
ok( $@, '$obj->DecryptFinal' );
$@ = undef; eval { $obj->DigestInit; };
ok( $@, '$obj->DigestInit' );
$@ = undef; eval { $obj->Digest; };
ok( $@, '$obj->Digest' );
$@ = undef; eval { $obj->DigestUpdate; };
ok( $@, '$obj->DigestUpdate' );
$@ = undef; eval { $obj->DigestKey; };
ok( $@, '$obj->DigestKey' );
$@ = undef; eval { $obj->DigestFinal; };
ok( $@, '$obj->DigestFinal' );
$@ = undef; eval { $obj->SignInit; };
ok( $@, '$obj->SignInit' );
$@ = undef; eval { $obj->Sign; };
ok( $@, '$obj->Sign' );
$@ = undef; eval { $obj->SignUpdate; };
ok( $@, '$obj->SignUpdate' );
$@ = undef; eval { $obj->SignFinal; };
ok( $@, '$obj->SignFinal' );
$@ = undef; eval { $obj->SignRecoverInit; };
ok( $@, '$obj->SignRecoverInit' );
$@ = undef; eval { $obj->SignRecover; };
ok( $@, '$obj->SignRecover' );
$@ = undef; eval { $obj->VerifyInit; };
ok( $@, '$obj->VerifyInit' );
$@ = undef; eval { $obj->Verify; };
ok( $@, '$obj->Verify' );
$@ = undef; eval { $obj->VerifyUpdate; };
ok( $@, '$obj->VerifyUpdate' );
$@ = undef; eval { $obj->VerifyFinal; };
ok( $@, '$obj->VerifyFinal' );
$@ = undef; eval { $obj->VerifyRecoverInit; };
ok( $@, '$obj->VerifyRecoverInit' );
$@ = undef; eval { $obj->VerifyRecover; };
ok( $@, '$obj->VerifyRecover' );
$@ = undef; eval { $obj->DigestEncryptUpdate; };
ok( $@, '$obj->DigestEncryptUpdate' );
$@ = undef; eval { $obj->DecryptDigestUpdate; };
ok( $@, '$obj->DecryptDigestUpdate' );
$@ = undef; eval { $obj->SignEncryptUpdate; };
ok( $@, '$obj->SignEncryptUpdate' );
$@ = undef; eval { $obj->DecryptVerifyUpdate; };
ok( $@, '$obj->DecryptVerifyUpdate' );
$@ = undef; eval { $obj->GenerateKey; };
ok( $@, '$obj->GenerateKey' );
$@ = undef; eval { $obj->GenerateKeyPair; };
ok( $@, '$obj->GenerateKeyPair' );
$@ = undef; eval { $obj->WrapKey; };
ok( $@, '$obj->WrapKey' );
$@ = undef; eval { $obj->UnwrapKey; };
ok( $@, '$obj->UnwrapKey' );
$@ = undef; eval { $obj->DeriveKey; };
ok( $@, '$obj->DeriveKey' );
$@ = undef; eval { $obj->SeedRandom; };
ok( $@, '$obj->SeedRandom' );
$@ = undef; eval { $obj->GenerateRandom; };
ok( $@, '$obj->GenerateRandom' );
$@ = undef; eval { $obj->GetFunctionStatus; };
ok( $@, '$obj->GetFunctionStatus' );
$@ = undef; eval { $obj->CancelFunction; };
ok( $@, '$obj->CancelFunction' );

# Crypt/PKCS11/Attribute/AttributeArray.pm

isa_ok( $obj = Crypt::PKCS11::Attribute::AttributeArray->new, 'Crypt::PKCS11::Attribute::AttributeArray', 'Crypt::PKCS11::Attribute::AttributeArray->new' );
$@ = undef; eval { $obj->push(undef); };
ok( $@, '$obj->push(undef)' );
$@ = undef; eval { $obj->push(Crypt::PKCS11::Attributes->new); };
ok( $@, '$obj->push(Crypt::PKCS11::Attributes->new)' );
ok( $obj->push(Crypt::PKCS11::Attribute->new), '$obj->push(Crypt::PKCS11::Attribute->new)' );
ok( $obj->pop, '$obj->pop' );
$@ = undef; eval { $obj->unshift(undef); };
ok( $@, '$obj->unshift(undef)' );
$@ = undef; eval { $obj->unshift(Crypt::PKCS11::Attributes->new); };
ok( $@, '$obj->unshift(Crypt::PKCS11::Attributes->new)' );
ok( $obj->unshift(Crypt::PKCS11::Attribute::Class->new->set(1)), '$obj->unshift(Crypt::PKCS11::Attribute->new)' );
$@ = undef; eval { $obj->foreach; };
ok( $@, '$obj->foreach' );
ok( $obj->foreach(sub{}), '$obj->foreach(sub{})' );
ok( $obj->toArray, '$obj->toArray' );
ok( $obj->shift, '$obj->shift' );
$@ = undef; eval { $obj->set(undef); };
ok( $@, '$obj->set(undef)' );
$@ = undef; eval { $obj->set(Crypt::PKCS11::Attributes->new); };
ok( $@, '$obj->set(Crypt::PKCS11::Attributes->new)' );
ok( $obj->set(Crypt::PKCS11::Attribute::Class->new->set(1)), '$obj->set' );
ok( $obj->pValue, '$obj->pValue' );

# Crypt/PKCS11/Attribute/ByteArray.pm

isa_ok( $obj = Crypt::PKCS11::Attribute::ByteArray->new, 'Crypt::PKCS11::Attribute::ByteArray', 'Crypt::PKCS11::Attribute::ByteArray->new' );
$@ = undef; eval { $obj->set; };
ok( $@, '$obj->set' );
$@ = undef; eval { $obj->set(undef); };
ok( $@, '$obj->set(undef)' );
$@ = undef; eval { $obj->set(''); };
ok( $@, '$obj->set("")' );
$@ = undef; eval { $obj->set(-1); };
ok( $@, '$obj->set(-1)' );
$@ = undef; eval { $obj->set(666); };
ok( $@, '$obj->set(666)' );
is( $obj->get, undef, '$obj->get' );
ok( $obj->set(1), '$obj->set(1)' );
ok( $obj->get, '$obj->get' );

# Crypt/PKCS11/Attribute/CK_BBOOL.pm

isa_ok( $obj = Crypt::PKCS11::Attribute::CK_BBOOL->new, 'Crypt::PKCS11::Attribute::CK_BBOOL', 'Crypt::PKCS11::Attribute::CK_BBOOL->new' );
$@ = undef; eval { $obj->set(undef); };
ok( $@, '$obj->set(undef)' );
is( $obj->get, undef, '$obj->get' );
ok( $obj->set(0), '$obj->set(0)' );
is( $obj->get, 0, '$obj->get' );
ok( $obj->set(1), '$obj->set(1)' );
ok( $obj->get, '$obj->get' );

# Crypt/PKCS11/Attribute/CK_BYTE.pm

isa_ok( $obj = Crypt::PKCS11::Attribute::CK_BYTE->new, 'Crypt::PKCS11::Attribute::CK_BYTE', 'Crypt::PKCS11::Attribute::CK_BYTE->new' );
$@ = undef; eval { $obj->set(undef); };
ok( $@, '$obj->set(undef)' );
$@ = undef; eval { $obj->set(''); };
ok( $@, '$obj->set("")' );
$@ = undef; eval { $obj->set(-1); };
ok( $@, '$obj->set(-1)' );
$@ = undef; eval { $obj->set(666); };
ok( $@, '$obj->set(666)' );
is( $obj->get, undef, '$obj->get' );
ok( $obj->set(1), '$obj->set(1)' );
ok( $obj->get, '$obj->get' );

# Crypt/PKCS11/Attribute/CK_DATE.pm

isa_ok( $obj = Crypt::PKCS11::Attribute::CK_DATE->new, 'Crypt::PKCS11::Attribute::CK_DATE', 'Crypt::PKCS11::Attribute::CK_DATE->new' );
$@ = undef; eval { $obj->set; };
ok( $@, '$obj->set' );
$@ = undef; eval { $obj->set(1); };
ok( $@, '$obj->set(1)' );
$@ = undef; eval { $obj->set(1, 1); };
ok( $@, '$obj->set(1, 1)' );
is( $obj->get, undef, '$obj->get' );
ok( $obj->set(2000, 1, 1), '$obj->set(2000, 1, 1)' );
ok( $obj->set('2000-01-01'), '$obj->set("2000-01-01")' );
ok( $obj->get, '$obj->get' );

# Crypt/PKCS11/Attribute/CK_ULONG.pm

isa_ok( $obj = Crypt::PKCS11::Attribute::CK_ULONG->new, 'Crypt::PKCS11::Attribute::CK_ULONG', 'Crypt::PKCS11::Attribute::CK_ULONG->new' );
$@ = undef; eval { $obj->set(undef); };
ok( $@, '$obj->set(undef)' );
$@ = undef; eval { $obj->set(''); };
ok( $@, '$obj->set("")' );
$@ = undef; eval { $obj->set(-1); };
ok( $@, '$obj->set(-1)' );
is( $obj->get, undef, '$obj->get' );
ok( $obj->set(1), '$obj->set(1)' );
ok( $obj->get, '$obj->get' );

# Crypt/PKCS11/Attribute/RFC2279string.pm

isa_ok( $obj = Crypt::PKCS11::Attribute::RFC2279string->new, 'Crypt::PKCS11::Attribute::RFC2279string', 'Crypt::PKCS11::Attribute::RFC2279string->new' );
$@ = undef; eval { $obj->set; };
ok( $@, '$obj->set' );
is( $obj->get, undef, '$obj->get' );
ok( $obj->set('abc'), '$obj->set("abc")' );
ok( $obj->get, '$obj->get' );

# Crypt/PKCS11/Attribute/UlongArray.pm

isa_ok( $obj = Crypt::PKCS11::Attribute::UlongArray->new, 'Crypt::PKCS11::Attribute::UlongArray', 'Crypt::PKCS11::Attribute::UlongArray->new' );
$@ = undef; eval { $obj->set(undef); };
ok( $@, '$obj->set(undef)' );
$@ = undef; eval { $obj->set(''); };
ok( $@, '$obj->set("")' );
$@ = undef; eval { $obj->set(-1); };
ok( $@, '$obj->set(-1)' );
is( $obj->get, undef, '$obj->get' );
ok( $obj->set(1), '$obj->set(1)' );
ok( $obj->get, '$obj->get' );

# Crypt/PKCS11/Attribute/Value.pm

isa_ok( $obj = Crypt::PKCS11::Attribute::Value->new, 'Crypt::PKCS11::Attribute::Value', 'Crypt::PKCS11::Attribute::Value->new' );
$@ = undef; eval { $obj->set(undef); };
ok( $@, '$obj->set(undef)' );
$@ = undef; eval { $obj->set('', ''); };
ok( $@, '$obj->set("", "")' );
$@ = undef; eval { $obj->set(-1); };
ok( $@, '$obj->set(-1)' );
$@ = undef; eval { $obj->set(666); };
ok( $@, '$obj->set(666)' );
is( $obj->get, undef, '$obj->get' );
ok( $obj->set(1), '$obj->set(1)' );
ok( $obj->get, '$obj->get' );
isa_ok( $obj = Crypt::PKCS11::Attribute::Value->new, 'Crypt::PKCS11::Attribute::Value', 'Crypt::PKCS11::Attribute::Value->new' );
$@ = undef; eval { $obj->set; };
ok( $@, '$obj->set' );
is( $obj->get, undef, '$obj->get' );
ok( $obj->set('abc'), '$obj->set("abc")' );
ok( $obj->get, '$obj->get' );
@a = $obj->get;
ok( scalar @a, '@a = $obj->get' );

# structs

{
    local $SIG{__WARN__} = sub {};
    ok( defined Crypt::PKCS11::CK_VERSION->new->major, 'Crypt::PKCS11::CK_VERSION->new->major' );
    ok( defined Crypt::PKCS11::CK_VERSION->new->minor, 'Crypt::PKCS11::CK_VERSION->new->minor' );
    ok( defined Crypt::PKCS11::CK_MECHANISM->new->mechanism, 'Crypt::PKCS11::CK_MECHANISM->new->mechanism' );
    is( Crypt::PKCS11::CK_MECHANISM->new->pParameter, undef, 'Crypt::PKCS11::CK_MECHANISM->new->pParameter' );
    ok( defined Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMS->new->hashAlg, 'Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMS->new->hashAlg' );
    ok( defined Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMS->new->mgf, 'Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMS->new->mgf' );
    ok( defined Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMS->new->source, 'Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMS->new->source' );
    is( Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMS->new->pSourceData, undef, 'Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMS->new->pSourceData' );
    ok( defined Crypt::PKCS11::CK_RSA_PKCS_PSS_PARAMS->new->hashAlg, 'Crypt::PKCS11::CK_RSA_PKCS_PSS_PARAMS->new->hashAlg' );
    ok( defined Crypt::PKCS11::CK_RSA_PKCS_PSS_PARAMS->new->mgf, 'Crypt::PKCS11::CK_RSA_PKCS_PSS_PARAMS->new->mgf' );
    ok( defined Crypt::PKCS11::CK_RSA_PKCS_PSS_PARAMS->new->sLen, 'Crypt::PKCS11::CK_RSA_PKCS_PSS_PARAMS->new->sLen' );
    ok( defined Crypt::PKCS11::CK_ECDH1_DERIVE_PARAMS->new->kdf, 'Crypt::PKCS11::CK_ECDH1_DERIVE_PARAMS->new->kdf' );
    is( Crypt::PKCS11::CK_ECDH1_DERIVE_PARAMS->new->pSharedData, undef, 'Crypt::PKCS11::CK_ECDH1_DERIVE_PARAMS->new->pSharedData' );
    is( Crypt::PKCS11::CK_ECDH1_DERIVE_PARAMS->new->pPublicData, undef, 'Crypt::PKCS11::CK_ECDH1_DERIVE_PARAMS->new->pPublicData' );
    ok( defined Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new->kdf, 'Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new->kdf' );
    is( Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new->pSharedData, undef, 'Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new->pSharedData' );
    is( Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new->pPublicData, undef, 'Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new->pPublicData' );
    ok( defined Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new->hPrivateData, 'Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new->hPrivateData' );
    is( Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new->pPublicData2, undef, 'Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new->pPublicData2' );
    ok( defined Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->kdf, 'Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->kdf' );
    is( Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->pSharedData, undef, 'Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->pSharedData' );
    is( Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->pPublicData, undef, 'Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->pPublicData' );
    ok( defined Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->hPrivateData, 'Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->hPrivateData' );
    is( Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->pPublicData2, undef, 'Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->pPublicData2' );
    ok( defined Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->publicKey, 'Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->publicKey' );
    ok( defined Crypt::PKCS11::CK_X9_42_DH1_DERIVE_PARAMS->new->kdf, 'Crypt::PKCS11::CK_X9_42_DH1_DERIVE_PARAMS->new->kdf' );
    is( Crypt::PKCS11::CK_X9_42_DH1_DERIVE_PARAMS->new->pOtherInfo, undef, 'Crypt::PKCS11::CK_X9_42_DH1_DERIVE_PARAMS->new->pOtherInfo' );
    is( Crypt::PKCS11::CK_X9_42_DH1_DERIVE_PARAMS->new->pPublicData, undef, 'Crypt::PKCS11::CK_X9_42_DH1_DERIVE_PARAMS->new->pPublicData' );
    ok( defined Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new->kdf, 'Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new->kdf' );
    is( Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new->pOtherInfo, undef, 'Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new->pOtherInfo' );
    is( Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new->pPublicData, undef, 'Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new->pPublicData' );
    ok( defined Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new->hPrivateData, 'Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new->hPrivateData' );
    is( Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new->pPublicData2, undef, 'Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new->pPublicData2' );
    ok( defined Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->kdf, 'Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->kdf' );
    is( Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->pOtherInfo, undef, 'Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->pOtherInfo' );
    is( Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->pPublicData, undef, 'Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->pPublicData' );
    ok( defined Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->hPrivateData, 'Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->hPrivateData' );
    is( Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->pPublicData2, undef, 'Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->pPublicData2' );
    ok( defined Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->publicKey, 'Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->publicKey' );
    ok( defined Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new->isSender, 'Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new->isSender' );
    is( Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new->pRandomA, undef, 'Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new->pRandomA' );
    is( Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new->pRandomB, undef, 'Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new->pRandomB' );
    is( Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new->pPublicData, undef, 'Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new->pPublicData' );
    ok( defined Crypt::PKCS11::CK_RC2_CBC_PARAMS->new->ulEffectiveBits, 'Crypt::PKCS11::CK_RC2_CBC_PARAMS->new->ulEffectiveBits' );
    ok( defined Crypt::PKCS11::CK_RC2_CBC_PARAMS->new->iv, 'Crypt::PKCS11::CK_RC2_CBC_PARAMS->new->iv' );
    ok( defined Crypt::PKCS11::CK_RC2_MAC_GENERAL_PARAMS->new->ulEffectiveBits, 'Crypt::PKCS11::CK_RC2_MAC_GENERAL_PARAMS->new->ulEffectiveBits' );
    ok( defined Crypt::PKCS11::CK_RC5_PARAMS->new->ulWordsize, 'Crypt::PKCS11::CK_RC5_PARAMS->new->ulWordsize' );
    ok( defined Crypt::PKCS11::CK_RC5_PARAMS->new->ulRounds, 'Crypt::PKCS11::CK_RC5_PARAMS->new->ulRounds' );
    ok( defined Crypt::PKCS11::CK_RC5_CBC_PARAMS->new->ulWordsize, 'Crypt::PKCS11::CK_RC5_CBC_PARAMS->new->ulWordsize' );
    ok( defined Crypt::PKCS11::CK_RC5_CBC_PARAMS->new->ulRounds, 'Crypt::PKCS11::CK_RC5_CBC_PARAMS->new->ulRounds' );
    is( Crypt::PKCS11::CK_RC5_CBC_PARAMS->new->pIv, undef, 'Crypt::PKCS11::CK_RC5_CBC_PARAMS->new->pIv' );
    ok( defined Crypt::PKCS11::CK_RC5_MAC_GENERAL_PARAMS->new->ulWordsize, 'Crypt::PKCS11::CK_RC5_MAC_GENERAL_PARAMS->new->ulWordsize' );
    ok( defined Crypt::PKCS11::CK_RC5_MAC_GENERAL_PARAMS->new->ulRounds, 'Crypt::PKCS11::CK_RC5_MAC_GENERAL_PARAMS->new->ulRounds' );
    ok( defined Crypt::PKCS11::CK_DES_CBC_ENCRYPT_DATA_PARAMS->new->iv, 'Crypt::PKCS11::CK_DES_CBC_ENCRYPT_DATA_PARAMS->new->iv' );
    is( Crypt::PKCS11::CK_DES_CBC_ENCRYPT_DATA_PARAMS->new->pData, undef, 'Crypt::PKCS11::CK_DES_CBC_ENCRYPT_DATA_PARAMS->new->pData' );
    ok( defined Crypt::PKCS11::CK_AES_CBC_ENCRYPT_DATA_PARAMS->new->iv, 'Crypt::PKCS11::CK_AES_CBC_ENCRYPT_DATA_PARAMS->new->iv' );
    is( Crypt::PKCS11::CK_AES_CBC_ENCRYPT_DATA_PARAMS->new->pData, undef, 'Crypt::PKCS11::CK_AES_CBC_ENCRYPT_DATA_PARAMS->new->pData' );
    is( Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->pPassword, undef, 'Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->pPassword' );
    is( Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->pPublicData, undef, 'Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->pPublicData' );
    is( Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->pRandomA, undef, 'Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->pRandomA' );
    is( Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->pPrimeP, undef, 'Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->pPrimeP' );
    is( Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->pBaseG, undef, 'Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->pBaseG' );
    is( Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->pSubprimeQ, undef, 'Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->pSubprimeQ' );
    is( Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->pOldWrappedX, undef, 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->pOldWrappedX' );
    is( Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->pOldPassword, undef, 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->pOldPassword' );
    is( Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->pOldPublicData, undef, 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->pOldPublicData' );
    is( Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->pOldRandomA, undef, 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->pOldRandomA' );
    is( Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->pNewPassword, undef, 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->pNewPassword' );
    is( Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->pNewPublicData, undef, 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->pNewPublicData' );
    is( Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->pNewRandomA, undef, 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->pNewRandomA' );
    ok( defined Crypt::PKCS11::CK_PBE_PARAMS->new->pInitVector, 'Crypt::PKCS11::CK_PBE_PARAMS->new->pInitVector' );
    ok( defined Crypt::PKCS11::CK_PBE_PARAMS->new->pPassword, 'Crypt::PKCS11::CK_PBE_PARAMS->new->pPassword' );
    is( Crypt::PKCS11::CK_PBE_PARAMS->new->pSalt, undef, 'Crypt::PKCS11::CK_PBE_PARAMS->new->pSalt' );
    ok( defined Crypt::PKCS11::CK_PBE_PARAMS->new->ulIteration, 'Crypt::PKCS11::CK_PBE_PARAMS->new->ulIteration' );
    ok( defined Crypt::PKCS11::CK_KEY_WRAP_SET_OAEP_PARAMS->new->bBC, 'Crypt::PKCS11::CK_KEY_WRAP_SET_OAEP_PARAMS->new->bBC' );
    is( Crypt::PKCS11::CK_KEY_WRAP_SET_OAEP_PARAMS->new->pX, undef, 'Crypt::PKCS11::CK_KEY_WRAP_SET_OAEP_PARAMS->new->pX' );
    is( Crypt::PKCS11::CK_SSL3_RANDOM_DATA->new->pClientRandom, undef, 'Crypt::PKCS11::CK_SSL3_RANDOM_DATA->new->pClientRandom' );
    is( Crypt::PKCS11::CK_SSL3_RANDOM_DATA->new->pServerRandom, undef, 'Crypt::PKCS11::CK_SSL3_RANDOM_DATA->new->pServerRandom' );
    ok( defined Crypt::PKCS11::CK_SSL3_MASTER_KEY_DERIVE_PARAMS->new->RandomInfo, 'Crypt::PKCS11::CK_SSL3_MASTER_KEY_DERIVE_PARAMS->new->RandomInfo' );
    ok( defined Crypt::PKCS11::CK_SSL3_MASTER_KEY_DERIVE_PARAMS->new->pVersion, 'Crypt::PKCS11::CK_SSL3_MASTER_KEY_DERIVE_PARAMS->new->pVersion' );
    ok( defined Crypt::PKCS11::CK_SSL3_KEY_MAT_OUT->new->hClientMacSecret, 'Crypt::PKCS11::CK_SSL3_KEY_MAT_OUT->new->hClientMacSecret' );
    ok( defined Crypt::PKCS11::CK_SSL3_KEY_MAT_OUT->new->hServerMacSecret, 'Crypt::PKCS11::CK_SSL3_KEY_MAT_OUT->new->hServerMacSecret' );
    ok( defined Crypt::PKCS11::CK_SSL3_KEY_MAT_OUT->new->hClientKey, 'Crypt::PKCS11::CK_SSL3_KEY_MAT_OUT->new->hClientKey' );
    ok( defined Crypt::PKCS11::CK_SSL3_KEY_MAT_OUT->new->hServerKey, 'Crypt::PKCS11::CK_SSL3_KEY_MAT_OUT->new->hServerKey' );
    is( Crypt::PKCS11::CK_SSL3_KEY_MAT_OUT->new->pIVClient, undef, 'Crypt::PKCS11::CK_SSL3_KEY_MAT_OUT->new->pIVClient' );
    is( Crypt::PKCS11::CK_SSL3_KEY_MAT_OUT->new->pIVServer, undef, 'Crypt::PKCS11::CK_SSL3_KEY_MAT_OUT->new->pIVServer' );
    ok( defined Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMS->new->ulMacSizeInBits, 'Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMS->new->ulMacSizeInBits' );
    ok( defined Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMS->new->ulKeySizeInBits, 'Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMS->new->ulKeySizeInBits' );
    ok( defined Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMS->new->ulIVSizeInBits, 'Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMS->new->ulIVSizeInBits' );
    ok( defined Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMS->new->bIsExport, 'Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMS->new->bIsExport' );
    ok( defined Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMS->new->RandomInfo, 'Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMS->new->RandomInfo' );
    ok( defined Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMS->new->pReturnedKeyMaterial, 'Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMS->new->pReturnedKeyMaterial' );
    is( Crypt::PKCS11::CK_TLS_PRF_PARAMS->new->pSeed, undef, 'Crypt::PKCS11::CK_TLS_PRF_PARAMS->new->pSeed' );
    is( Crypt::PKCS11::CK_TLS_PRF_PARAMS->new->pLabel, undef, 'Crypt::PKCS11::CK_TLS_PRF_PARAMS->new->pLabel' );
    is( Crypt::PKCS11::CK_TLS_PRF_PARAMS->new->pOutput, undef, 'Crypt::PKCS11::CK_TLS_PRF_PARAMS->new->pOutput' );
    is( Crypt::PKCS11::CK_WTLS_RANDOM_DATA->new->pClientRandom, undef, 'Crypt::PKCS11::CK_WTLS_RANDOM_DATA->new->pClientRandom' );
    is( Crypt::PKCS11::CK_WTLS_RANDOM_DATA->new->pServerRandom, undef, 'Crypt::PKCS11::CK_WTLS_RANDOM_DATA->new->pServerRandom' );
    ok( defined Crypt::PKCS11::CK_WTLS_MASTER_KEY_DERIVE_PARAMS->new->DigestMechanism, 'Crypt::PKCS11::CK_WTLS_MASTER_KEY_DERIVE_PARAMS->new->DigestMechanism' );
    ok( defined Crypt::PKCS11::CK_WTLS_MASTER_KEY_DERIVE_PARAMS->new->RandomInfo, 'Crypt::PKCS11::CK_WTLS_MASTER_KEY_DERIVE_PARAMS->new->RandomInfo' );
    ok( defined Crypt::PKCS11::CK_WTLS_MASTER_KEY_DERIVE_PARAMS->new->pVersion, 'Crypt::PKCS11::CK_WTLS_MASTER_KEY_DERIVE_PARAMS->new->pVersion' );
    ok( defined Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new->DigestMechanism, 'Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new->DigestMechanism' );
    is( Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new->pSeed, undef, 'Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new->pSeed' );
    is( Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new->pLabel, undef, 'Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new->pLabel' );
    is( Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new->pOutput, undef, 'Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new->pOutput' );
    ok( defined Crypt::PKCS11::CK_WTLS_KEY_MAT_OUT->new->hMacSecret, 'Crypt::PKCS11::CK_WTLS_KEY_MAT_OUT->new->hMacSecret' );
    ok( defined Crypt::PKCS11::CK_WTLS_KEY_MAT_OUT->new->hKey, 'Crypt::PKCS11::CK_WTLS_KEY_MAT_OUT->new->hKey' );
    is( Crypt::PKCS11::CK_WTLS_KEY_MAT_OUT->new->pIV, undef, 'Crypt::PKCS11::CK_WTLS_KEY_MAT_OUT->new->pIV' );
    ok( defined Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->DigestMechanism, 'Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->DigestMechanism' );
    ok( defined Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->ulMacSizeInBits, 'Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->ulMacSizeInBits' );
    ok( defined Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->ulKeySizeInBits, 'Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->ulKeySizeInBits' );
    ok( defined Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->ulIVSizeInBits, 'Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->ulIVSizeInBits' );
    ok( defined Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->ulSequenceNumber, 'Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->ulSequenceNumber' );
    ok( defined Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->bIsExport, 'Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->bIsExport' );
    ok( defined Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->RandomInfo, 'Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->RandomInfo' );
    ok( defined Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->pReturnedKeyMaterial, 'Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->pReturnedKeyMaterial' );
    ok( defined Crypt::PKCS11::CK_CMS_SIG_PARAMS->new->certificateHandle, 'Crypt::PKCS11::CK_CMS_SIG_PARAMS->new->certificateHandle' );
    ok( defined Crypt::PKCS11::CK_CMS_SIG_PARAMS->new->pSigningMechanism, 'Crypt::PKCS11::CK_CMS_SIG_PARAMS->new->pSigningMechanism' );
    ok( defined Crypt::PKCS11::CK_CMS_SIG_PARAMS->new->pDigestMechanism, 'Crypt::PKCS11::CK_CMS_SIG_PARAMS->new->pDigestMechanism' );
    ok( defined Crypt::PKCS11::CK_CMS_SIG_PARAMS->new->pContentType, 'Crypt::PKCS11::CK_CMS_SIG_PARAMS->new->pContentType' );
    is( Crypt::PKCS11::CK_CMS_SIG_PARAMS->new->pRequestedAttributes, undef, 'Crypt::PKCS11::CK_CMS_SIG_PARAMS->new->pRequestedAttributes' );
    is( Crypt::PKCS11::CK_CMS_SIG_PARAMS->new->pRequiredAttributes, undef, 'Crypt::PKCS11::CK_CMS_SIG_PARAMS->new->pRequiredAttributes' );
    is( Crypt::PKCS11::CK_KEY_DERIVATION_STRING_DATA->new->pData, undef, 'Crypt::PKCS11::CK_KEY_DERIVATION_STRING_DATA->new->pData' );
    ok( defined Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->saltSource, 'Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->saltSource' );
    is( Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->pSaltSourceData, undef, 'Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->pSaltSourceData' );
    ok( defined Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->iterations, 'Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->iterations' );
    ok( defined Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->prf, 'Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->prf' );
    is( Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->pPrfData, undef, 'Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->pPrfData' );
    is( Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->pPassword, undef, 'Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->pPassword' );
    ok( defined Crypt::PKCS11::CK_OTP_PARAM->new->type, 'Crypt::PKCS11::CK_OTP_PARAM->new->type' );
    is( Crypt::PKCS11::CK_OTP_PARAM->new->pValue, undef, 'Crypt::PKCS11::CK_OTP_PARAM->new->pValue' );
    ok( defined Crypt::PKCS11::CK_OTP_PARAMS->new->pParams, 'Crypt::PKCS11::CK_OTP_PARAMS->new->pParams' );
    ok( defined Crypt::PKCS11::CK_OTP_PARAMS->new->ulCount, 'Crypt::PKCS11::CK_OTP_PARAMS->new->ulCount' );
    ok( defined Crypt::PKCS11::CK_OTP_SIGNATURE_INFO->new->pParams, 'Crypt::PKCS11::CK_OTP_SIGNATURE_INFO->new->pParams' );
    ok( defined Crypt::PKCS11::CK_OTP_SIGNATURE_INFO->new->ulCount, 'Crypt::PKCS11::CK_OTP_SIGNATURE_INFO->new->ulCount' );
    ok( defined Crypt::PKCS11::CK_KIP_PARAMS->new->pMechanism, 'Crypt::PKCS11::CK_KIP_PARAMS->new->pMechanism' );
    ok( defined Crypt::PKCS11::CK_KIP_PARAMS->new->hKey, 'Crypt::PKCS11::CK_KIP_PARAMS->new->hKey' );
    is( Crypt::PKCS11::CK_KIP_PARAMS->new->pSeed, undef, 'Crypt::PKCS11::CK_KIP_PARAMS->new->pSeed' );
    ok( defined Crypt::PKCS11::CK_AES_CTR_PARAMS->new->ulCounterBits, 'Crypt::PKCS11::CK_AES_CTR_PARAMS->new->ulCounterBits' );
    ok( defined Crypt::PKCS11::CK_AES_CTR_PARAMS->new->cb, 'Crypt::PKCS11::CK_AES_CTR_PARAMS->new->cb' );
    is( Crypt::PKCS11::CK_AES_GCM_PARAMS->new->pIv, undef, 'Crypt::PKCS11::CK_AES_GCM_PARAMS->new->pIv' );
    ok( defined Crypt::PKCS11::CK_AES_GCM_PARAMS->new->ulIvBits, 'Crypt::PKCS11::CK_AES_GCM_PARAMS->new->ulIvBits' );
    is( Crypt::PKCS11::CK_AES_GCM_PARAMS->new->pAAD, undef, 'Crypt::PKCS11::CK_AES_GCM_PARAMS->new->pAAD' );
    ok( defined Crypt::PKCS11::CK_AES_GCM_PARAMS->new->ulTagBits, 'Crypt::PKCS11::CK_AES_GCM_PARAMS->new->ulTagBits' );
    is( Crypt::PKCS11::CK_AES_CCM_PARAMS->new->pNonce, undef, 'Crypt::PKCS11::CK_AES_CCM_PARAMS->new->pNonce' );
    is( Crypt::PKCS11::CK_AES_CCM_PARAMS->new->pAAD, undef, 'Crypt::PKCS11::CK_AES_CCM_PARAMS->new->pAAD' );
    ok( defined Crypt::PKCS11::CK_CAMELLIA_CTR_PARAMS->new->ulCounterBits, 'Crypt::PKCS11::CK_CAMELLIA_CTR_PARAMS->new->ulCounterBits' );
    ok( defined Crypt::PKCS11::CK_CAMELLIA_CTR_PARAMS->new->cb, 'Crypt::PKCS11::CK_CAMELLIA_CTR_PARAMS->new->cb' );
    ok( defined Crypt::PKCS11::CK_CAMELLIA_CBC_ENCRYPT_DATA_PARAMS->new->iv, 'Crypt::PKCS11::CK_CAMELLIA_CBC_ENCRYPT_DATA_PARAMS->new->iv' );
    is( Crypt::PKCS11::CK_CAMELLIA_CBC_ENCRYPT_DATA_PARAMS->new->pData, undef, 'Crypt::PKCS11::CK_CAMELLIA_CBC_ENCRYPT_DATA_PARAMS->new->pData' );
    ok( defined Crypt::PKCS11::CK_ARIA_CBC_ENCRYPT_DATA_PARAMS->new->iv, 'Crypt::PKCS11::CK_ARIA_CBC_ENCRYPT_DATA_PARAMS->new->iv' );
    is( Crypt::PKCS11::CK_ARIA_CBC_ENCRYPT_DATA_PARAMS->new->pData, undef, 'Crypt::PKCS11::CK_ARIA_CBC_ENCRYPT_DATA_PARAMS->new->pData' );

    isa_ok( $obj = Crypt::PKCS11::CK_VERSION->new, 'Crypt::PKCS11::CK_VERSIONPtr', 'Crypt::PKCS11::CK_VERSION->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_MECHANISM->new, 'Crypt::PKCS11::CK_MECHANISMPtr', 'Crypt::PKCS11::CK_MECHANISM->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMS->new, 'Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMSPtr', 'Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_RSA_PKCS_PSS_PARAMS->new, 'Crypt::PKCS11::CK_RSA_PKCS_PSS_PARAMSPtr', 'Crypt::PKCS11::CK_RSA_PKCS_PSS_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_ECDH1_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_ECDH1_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_ECDH1_DERIVE_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_X9_42_DH1_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_X9_42_DH1_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_X9_42_DH1_DERIVE_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_KEA_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_RC2_CBC_PARAMS->new, 'Crypt::PKCS11::CK_RC2_CBC_PARAMSPtr', 'Crypt::PKCS11::CK_RC2_CBC_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_RC2_MAC_GENERAL_PARAMS->new, 'Crypt::PKCS11::CK_RC2_MAC_GENERAL_PARAMSPtr', 'Crypt::PKCS11::CK_RC2_MAC_GENERAL_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_RC5_PARAMS->new, 'Crypt::PKCS11::CK_RC5_PARAMSPtr', 'Crypt::PKCS11::CK_RC5_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_RC5_CBC_PARAMS->new, 'Crypt::PKCS11::CK_RC5_CBC_PARAMSPtr', 'Crypt::PKCS11::CK_RC5_CBC_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_RC5_MAC_GENERAL_PARAMS->new, 'Crypt::PKCS11::CK_RC5_MAC_GENERAL_PARAMSPtr', 'Crypt::PKCS11::CK_RC5_MAC_GENERAL_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_DES_CBC_ENCRYPT_DATA_PARAMS->new, 'Crypt::PKCS11::CK_DES_CBC_ENCRYPT_DATA_PARAMSPtr', 'Crypt::PKCS11::CK_DES_CBC_ENCRYPT_DATA_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_AES_CBC_ENCRYPT_DATA_PARAMS->new, 'Crypt::PKCS11::CK_AES_CBC_ENCRYPT_DATA_PARAMSPtr', 'Crypt::PKCS11::CK_AES_CBC_ENCRYPT_DATA_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new, 'Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMSPtr', 'Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new, 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMSPtr', 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_PBE_PARAMS->new, 'Crypt::PKCS11::CK_PBE_PARAMSPtr', 'Crypt::PKCS11::CK_PBE_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_KEY_WRAP_SET_OAEP_PARAMS->new, 'Crypt::PKCS11::CK_KEY_WRAP_SET_OAEP_PARAMSPtr', 'Crypt::PKCS11::CK_KEY_WRAP_SET_OAEP_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_SSL3_RANDOM_DATA->new, 'Crypt::PKCS11::CK_SSL3_RANDOM_DATAPtr', 'Crypt::PKCS11::CK_SSL3_RANDOM_DATA->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_SSL3_MASTER_KEY_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_SSL3_MASTER_KEY_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_SSL3_MASTER_KEY_DERIVE_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_SSL3_KEY_MAT_OUT->new, 'Crypt::PKCS11::CK_SSL3_KEY_MAT_OUTPtr', 'Crypt::PKCS11::CK_SSL3_KEY_MAT_OUT->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes($bytes), CKR_FUNCTION_NOT_SUPPORTED, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMS->new, 'Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMSPtr', 'Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes($bytes), CKR_FUNCTION_NOT_SUPPORTED, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_TLS_PRF_PARAMS->new, 'Crypt::PKCS11::CK_TLS_PRF_PARAMSPtr', 'Crypt::PKCS11::CK_TLS_PRF_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_WTLS_RANDOM_DATA->new, 'Crypt::PKCS11::CK_WTLS_RANDOM_DATAPtr', 'Crypt::PKCS11::CK_WTLS_RANDOM_DATA->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_WTLS_MASTER_KEY_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_WTLS_MASTER_KEY_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_WTLS_MASTER_KEY_DERIVE_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new, 'Crypt::PKCS11::CK_WTLS_PRF_PARAMSPtr', 'Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_WTLS_KEY_MAT_OUT->new, 'Crypt::PKCS11::CK_WTLS_KEY_MAT_OUTPtr', 'Crypt::PKCS11::CK_WTLS_KEY_MAT_OUT->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes($bytes), CKR_FUNCTION_NOT_SUPPORTED, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new, 'Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMSPtr', 'Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes($bytes), CKR_FUNCTION_NOT_SUPPORTED, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_CMS_SIG_PARAMS->new, 'Crypt::PKCS11::CK_CMS_SIG_PARAMSPtr', 'Crypt::PKCS11::CK_CMS_SIG_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_KEY_DERIVATION_STRING_DATA->new, 'Crypt::PKCS11::CK_KEY_DERIVATION_STRING_DATAPtr', 'Crypt::PKCS11::CK_KEY_DERIVATION_STRING_DATA->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new, 'Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMSPtr', 'Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_OTP_PARAM->new, 'Crypt::PKCS11::CK_OTP_PARAMPtr', 'Crypt::PKCS11::CK_OTP_PARAM->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_OTP_PARAMS->new, 'Crypt::PKCS11::CK_OTP_PARAMSPtr', 'Crypt::PKCS11::CK_OTP_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_OTP_SIGNATURE_INFO->new, 'Crypt::PKCS11::CK_OTP_SIGNATURE_INFOPtr', 'Crypt::PKCS11::CK_OTP_SIGNATURE_INFO->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_KIP_PARAMS->new, 'Crypt::PKCS11::CK_KIP_PARAMSPtr', 'Crypt::PKCS11::CK_KIP_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_AES_CTR_PARAMS->new, 'Crypt::PKCS11::CK_AES_CTR_PARAMSPtr', 'Crypt::PKCS11::CK_AES_CTR_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_AES_GCM_PARAMS->new, 'Crypt::PKCS11::CK_AES_GCM_PARAMSPtr', 'Crypt::PKCS11::CK_AES_GCM_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_AES_CCM_PARAMS->new, 'Crypt::PKCS11::CK_AES_CCM_PARAMSPtr', 'Crypt::PKCS11::CK_AES_CCM_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_CAMELLIA_CTR_PARAMS->new, 'Crypt::PKCS11::CK_CAMELLIA_CTR_PARAMSPtr', 'Crypt::PKCS11::CK_CAMELLIA_CTR_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_CAMELLIA_CBC_ENCRYPT_DATA_PARAMS->new, 'Crypt::PKCS11::CK_CAMELLIA_CBC_ENCRYPT_DATA_PARAMSPtr', 'Crypt::PKCS11::CK_CAMELLIA_CBC_ENCRYPT_DATA_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_ARIA_CBC_ENCRYPT_DATA_PARAMS->new, 'Crypt::PKCS11::CK_ARIA_CBC_ENCRYPT_DATA_PARAMSPtr', 'Crypt::PKCS11::CK_ARIA_CBC_ENCRYPT_DATA_PARAMS->new' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    is( $obj->fromBytes(undef), CKR_ARGUMENTS_BAD, '$obj->fromBytes(undef)' );
    is( $obj->fromBytes(''), CKR_ARGUMENTS_BAD, '$obj->fromBytes("")' );
    is( $obj->fromBytes($bytes), CKR_OK, '$obj->fromBytes($bytes)' );

    isa_ok( $obj = Crypt::PKCS11::CK_VERSION->new, 'Crypt::PKCS11::CK_VERSIONPtr', 'Crypt::PKCS11::CK_VERSION->new' );
    is( $obj->set_major(1), CKR_OK, '$obj->set_major(1)' );
    is( $obj->set_major(1), CKR_OK, '$obj->set_major(1)' );
    is( $obj->set_minor(1), CKR_OK, '$obj->set_minor(1)' );
    is( $obj->set_minor(1), CKR_OK, '$obj->set_minor(1)' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_VERSION->new, 'Crypt::PKCS11::CK_VERSIONPtr', 'Crypt::PKCS11::CK_VERSION->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_MECHANISM->new, 'Crypt::PKCS11::CK_MECHANISMPtr', 'Crypt::PKCS11::CK_MECHANISM->new' );
    is( $obj->set_mechanism(1), CKR_OK, '$obj->set_mechanism(1)' );
    is( $obj->set_mechanism(1), CKR_OK, '$obj->set_mechanism(1)' );
    is( $obj->set_pParameter('1'), CKR_OK, '$obj->set_pParameter("1")' );
    is( $obj->set_pParameter('1'), CKR_OK, '$obj->set_pParameter("1")' );
    is( $obj->set_pParameter(undef), CKR_OK, '$obj->set_pParameter(undef)' );
    is( $obj->set_pParameter('1'), CKR_OK, '$obj->set_pParameter("1")' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_MECHANISM->new, 'Crypt::PKCS11::CK_MECHANISMPtr', 'Crypt::PKCS11::CK_MECHANISM->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMS->new, 'Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMSPtr', 'Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMS->new' );
    is( $obj->set_hashAlg(1), CKR_OK, '$obj->set_hashAlg(1)' );
    is( $obj->set_hashAlg(1), CKR_OK, '$obj->set_hashAlg(1)' );
    is( $obj->set_mgf(1), CKR_OK, '$obj->set_mgf(1)' );
    is( $obj->set_mgf(1), CKR_OK, '$obj->set_mgf(1)' );
    is( $obj->set_source(1), CKR_OK, '$obj->set_source(1)' );
    is( $obj->set_source(1), CKR_OK, '$obj->set_source(1)' );
    is( $obj->set_pSourceData('1'), CKR_OK, '$obj->set_pSourceData("1")' );
    is( $obj->set_pSourceData('1'), CKR_OK, '$obj->set_pSourceData("1")' );
    is( $obj->set_pSourceData(undef), CKR_OK, '$obj->set_pSourceData(undef)' );
    is( $obj->set_pSourceData('1'), CKR_OK, '$obj->set_pSourceData("1")' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMS->new, 'Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMSPtr', 'Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_RSA_PKCS_PSS_PARAMS->new, 'Crypt::PKCS11::CK_RSA_PKCS_PSS_PARAMSPtr', 'Crypt::PKCS11::CK_RSA_PKCS_PSS_PARAMS->new' );
    is( $obj->set_hashAlg(1), CKR_OK, '$obj->set_hashAlg(1)' );
    is( $obj->set_hashAlg(1), CKR_OK, '$obj->set_hashAlg(1)' );
    is( $obj->set_mgf(1), CKR_OK, '$obj->set_mgf(1)' );
    is( $obj->set_mgf(1), CKR_OK, '$obj->set_mgf(1)' );
    is( $obj->set_sLen(1), CKR_OK, '$obj->set_sLen(1)' );
    is( $obj->set_sLen(1), CKR_OK, '$obj->set_sLen(1)' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_RSA_PKCS_PSS_PARAMS->new, 'Crypt::PKCS11::CK_RSA_PKCS_PSS_PARAMSPtr', 'Crypt::PKCS11::CK_RSA_PKCS_PSS_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_ECDH1_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_ECDH1_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_ECDH1_DERIVE_PARAMS->new' );
    is( $obj->set_kdf(1), CKR_OK, '$obj->set_kdf(1)' );
    is( $obj->set_kdf(1), CKR_OK, '$obj->set_kdf(1)' );
    is( $obj->set_pSharedData('1'), CKR_OK, '$obj->set_pSharedData("1")' );
    is( $obj->set_pSharedData('1'), CKR_OK, '$obj->set_pSharedData("1")' );
    is( $obj->set_pSharedData(undef), CKR_OK, '$obj->set_pSharedData(undef)' );
    is( $obj->set_pSharedData('1'), CKR_OK, '$obj->set_pSharedData("1")' );
    is( $obj->set_pPublicData('1'), CKR_OK, '$obj->set_pPublicData("1")' );
    is( $obj->set_pPublicData('1'), CKR_OK, '$obj->set_pPublicData("1")' );
    is( $obj->set_pPublicData(undef), CKR_OK, '$obj->set_pPublicData(undef)' );
    is( $obj->set_pPublicData('1'), CKR_OK, '$obj->set_pPublicData("1")' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_ECDH1_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_ECDH1_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_ECDH1_DERIVE_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new' );
    is( $obj->set_kdf(1), CKR_OK, '$obj->set_kdf(1)' );
    is( $obj->set_kdf(1), CKR_OK, '$obj->set_kdf(1)' );
    is( $obj->set_pSharedData('1'), CKR_OK, '$obj->set_pSharedData("1")' );
    is( $obj->set_pSharedData('1'), CKR_OK, '$obj->set_pSharedData("1")' );
    is( $obj->set_pSharedData(undef), CKR_OK, '$obj->set_pSharedData(undef)' );
    is( $obj->set_pSharedData('1'), CKR_OK, '$obj->set_pSharedData("1")' );
    is( $obj->set_pPublicData('1'), CKR_OK, '$obj->set_pPublicData("1")' );
    is( $obj->set_pPublicData('1'), CKR_OK, '$obj->set_pPublicData("1")' );
    is( $obj->set_pPublicData(undef), CKR_OK, '$obj->set_pPublicData(undef)' );
    is( $obj->set_pPublicData('1'), CKR_OK, '$obj->set_pPublicData("1")' );
    is( $obj->set_hPrivateData(1), CKR_OK, '$obj->set_hPrivateData(1)' );
    is( $obj->set_hPrivateData(1), CKR_OK, '$obj->set_hPrivateData(1)' );
    is( $obj->set_pPublicData2('1'), CKR_OK, '$obj->set_pPublicData2("1")' );
    is( $obj->set_pPublicData2('1'), CKR_OK, '$obj->set_pPublicData2("1")' );
    is( $obj->set_pPublicData2(undef), CKR_OK, '$obj->set_pPublicData2(undef)' );
    is( $obj->set_pPublicData2('1'), CKR_OK, '$obj->set_pPublicData2("1")' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new' );
    is( $obj->set_kdf(1), CKR_OK, '$obj->set_kdf(1)' );
    is( $obj->set_kdf(1), CKR_OK, '$obj->set_kdf(1)' );
    is( $obj->set_pSharedData('1'), CKR_OK, '$obj->set_pSharedData("1")' );
    is( $obj->set_pSharedData('1'), CKR_OK, '$obj->set_pSharedData("1")' );
    is( $obj->set_pSharedData(undef), CKR_OK, '$obj->set_pSharedData(undef)' );
    is( $obj->set_pSharedData('1'), CKR_OK, '$obj->set_pSharedData("1")' );
    is( $obj->set_pPublicData('1'), CKR_OK, '$obj->set_pPublicData("1")' );
    is( $obj->set_pPublicData('1'), CKR_OK, '$obj->set_pPublicData("1")' );
    is( $obj->set_pPublicData(undef), CKR_OK, '$obj->set_pPublicData(undef)' );
    is( $obj->set_pPublicData('1'), CKR_OK, '$obj->set_pPublicData("1")' );
    is( $obj->set_hPrivateData(1), CKR_OK, '$obj->set_hPrivateData(1)' );
    is( $obj->set_hPrivateData(1), CKR_OK, '$obj->set_hPrivateData(1)' );
    is( $obj->set_pPublicData2('1'), CKR_OK, '$obj->set_pPublicData2("1")' );
    is( $obj->set_pPublicData2('1'), CKR_OK, '$obj->set_pPublicData2("1")' );
    is( $obj->set_pPublicData2(undef), CKR_OK, '$obj->set_pPublicData2(undef)' );
    is( $obj->set_pPublicData2('1'), CKR_OK, '$obj->set_pPublicData2("1")' );
    is( $obj->set_publicKey(1), CKR_OK, '$obj->set_publicKey(1)' );
    is( $obj->set_publicKey(1), CKR_OK, '$obj->set_publicKey(1)' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_X9_42_DH1_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_X9_42_DH1_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_X9_42_DH1_DERIVE_PARAMS->new' );
    is( $obj->set_kdf(1), CKR_OK, '$obj->set_kdf(1)' );
    is( $obj->set_kdf(1), CKR_OK, '$obj->set_kdf(1)' );
    is( $obj->set_pOtherInfo('1'), CKR_OK, '$obj->set_pOtherInfo("1")' );
    is( $obj->set_pOtherInfo('1'), CKR_OK, '$obj->set_pOtherInfo("1")' );
    is( $obj->set_pOtherInfo(undef), CKR_OK, '$obj->set_pOtherInfo(undef)' );
    is( $obj->set_pOtherInfo('1'), CKR_OK, '$obj->set_pOtherInfo("1")' );
    is( $obj->set_pPublicData('1'), CKR_OK, '$obj->set_pPublicData("1")' );
    is( $obj->set_pPublicData('1'), CKR_OK, '$obj->set_pPublicData("1")' );
    is( $obj->set_pPublicData(undef), CKR_OK, '$obj->set_pPublicData(undef)' );
    is( $obj->set_pPublicData('1'), CKR_OK, '$obj->set_pPublicData("1")' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_X9_42_DH1_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_X9_42_DH1_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_X9_42_DH1_DERIVE_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new' );
    is( $obj->set_kdf(1), CKR_OK, '$obj->set_kdf(1)' );
    is( $obj->set_kdf(1), CKR_OK, '$obj->set_kdf(1)' );
    is( $obj->set_pOtherInfo('1'), CKR_OK, '$obj->set_pOtherInfo("1")' );
    is( $obj->set_pOtherInfo('1'), CKR_OK, '$obj->set_pOtherInfo("1")' );
    is( $obj->set_pOtherInfo(undef), CKR_OK, '$obj->set_pOtherInfo(undef)' );
    is( $obj->set_pOtherInfo('1'), CKR_OK, '$obj->set_pOtherInfo("1")' );
    is( $obj->set_pPublicData('1'), CKR_OK, '$obj->set_pPublicData("1")' );
    is( $obj->set_pPublicData('1'), CKR_OK, '$obj->set_pPublicData("1")' );
    is( $obj->set_pPublicData(undef), CKR_OK, '$obj->set_pPublicData(undef)' );
    is( $obj->set_pPublicData('1'), CKR_OK, '$obj->set_pPublicData("1")' );
    is( $obj->set_hPrivateData(1), CKR_OK, '$obj->set_hPrivateData(1)' );
    is( $obj->set_hPrivateData(1), CKR_OK, '$obj->set_hPrivateData(1)' );
    is( $obj->set_pPublicData2('1'), CKR_OK, '$obj->set_pPublicData2("1")' );
    is( $obj->set_pPublicData2('1'), CKR_OK, '$obj->set_pPublicData2("1")' );
    is( $obj->set_pPublicData2(undef), CKR_OK, '$obj->set_pPublicData2(undef)' );
    is( $obj->set_pPublicData2('1'), CKR_OK, '$obj->set_pPublicData2("1")' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new' );
    is( $obj->set_kdf(1), CKR_OK, '$obj->set_kdf(1)' );
    is( $obj->set_kdf(1), CKR_OK, '$obj->set_kdf(1)' );
    is( $obj->set_pOtherInfo('1'), CKR_OK, '$obj->set_pOtherInfo("1")' );
    is( $obj->set_pOtherInfo('1'), CKR_OK, '$obj->set_pOtherInfo("1")' );
    is( $obj->set_pOtherInfo(undef), CKR_OK, '$obj->set_pOtherInfo(undef)' );
    is( $obj->set_pOtherInfo('1'), CKR_OK, '$obj->set_pOtherInfo("1")' );
    is( $obj->set_pPublicData('1'), CKR_OK, '$obj->set_pPublicData("1")' );
    is( $obj->set_pPublicData('1'), CKR_OK, '$obj->set_pPublicData("1")' );
    is( $obj->set_pPublicData(undef), CKR_OK, '$obj->set_pPublicData(undef)' );
    is( $obj->set_pPublicData('1'), CKR_OK, '$obj->set_pPublicData("1")' );
    is( $obj->set_hPrivateData(1), CKR_OK, '$obj->set_hPrivateData(1)' );
    is( $obj->set_hPrivateData(1), CKR_OK, '$obj->set_hPrivateData(1)' );
    is( $obj->set_pPublicData2('1'), CKR_OK, '$obj->set_pPublicData2("1")' );
    is( $obj->set_pPublicData2('1'), CKR_OK, '$obj->set_pPublicData2("1")' );
    is( $obj->set_pPublicData2(undef), CKR_OK, '$obj->set_pPublicData2(undef)' );
    is( $obj->set_pPublicData2('1'), CKR_OK, '$obj->set_pPublicData2("1")' );
    is( $obj->set_publicKey(1), CKR_OK, '$obj->set_publicKey(1)' );
    is( $obj->set_publicKey(1), CKR_OK, '$obj->set_publicKey(1)' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_KEA_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new' );
    is( $obj->set_isSender(1), CKR_OK, '$obj->set_isSender(1)' );
    is( $obj->set_isSender(1), CKR_OK, '$obj->set_isSender(1)' );
    is( $obj->set_pRandomA('1'), CKR_OK, '$obj->set_pRandomA("1")' );
    is( $obj->set_pRandomA('1'), CKR_OK, '$obj->set_pRandomA("1")' );
    is( $obj->set_pRandomA(undef), CKR_OK, '$obj->set_pRandomA(undef)' );
    is( $obj->set_pRandomA('1'), CKR_OK, '$obj->set_pRandomA("1")' );
    is( $obj->set_pRandomB('1'), CKR_OK, '$obj->set_pRandomB("1")' );
    is( $obj->set_pRandomB('1'), CKR_OK, '$obj->set_pRandomB("1")' );
    is( $obj->set_pRandomB(undef), CKR_OK, '$obj->set_pRandomB(undef)' );
    is( $obj->set_pRandomB('1'), CKR_OK, '$obj->set_pRandomB("1")' );
    is( $obj->set_pPublicData('1'), CKR_OK, '$obj->set_pPublicData("1")' );
    is( $obj->set_pPublicData('1'), CKR_OK, '$obj->set_pPublicData("1")' );
    is( $obj->set_pPublicData(undef), CKR_OK, '$obj->set_pPublicData(undef)' );
    is( $obj->set_pPublicData('1'), CKR_OK, '$obj->set_pPublicData("1")' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_KEA_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_RC2_CBC_PARAMS->new, 'Crypt::PKCS11::CK_RC2_CBC_PARAMSPtr', 'Crypt::PKCS11::CK_RC2_CBC_PARAMS->new' );
    is( $obj->set_ulEffectiveBits(1), CKR_OK, '$obj->set_ulEffectiveBits(1)' );
    is( $obj->set_ulEffectiveBits(1), CKR_OK, '$obj->set_ulEffectiveBits(1)' );
    is( $obj->set_iv('123456789'), CKR_ARGUMENTS_BAD, '$obj->set_iv("123456789")' );
    is( $obj->set_iv(-1), CKR_ARGUMENTS_BAD, '$obj->set_iv(-1)' );
    is( $obj->set_iv('12345678'), CKR_OK, '$obj->set_iv("12345678")' );
    is( $obj->set_iv('12345678'), CKR_OK, '$obj->set_iv("12345678")' );
    is( $obj->set_iv(undef), CKR_OK, '$obj->set_iv(undef)' );
    is( $obj->set_iv('12345678'), CKR_OK, '$obj->set_iv("12345678")' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_RC2_CBC_PARAMS->new, 'Crypt::PKCS11::CK_RC2_CBC_PARAMSPtr', 'Crypt::PKCS11::CK_RC2_CBC_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_RC2_MAC_GENERAL_PARAMS->new, 'Crypt::PKCS11::CK_RC2_MAC_GENERAL_PARAMSPtr', 'Crypt::PKCS11::CK_RC2_MAC_GENERAL_PARAMS->new' );
    is( $obj->set_ulEffectiveBits(1), CKR_OK, '$obj->set_ulEffectiveBits(1)' );
    is( $obj->set_ulEffectiveBits(1), CKR_OK, '$obj->set_ulEffectiveBits(1)' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_RC2_MAC_GENERAL_PARAMS->new, 'Crypt::PKCS11::CK_RC2_MAC_GENERAL_PARAMSPtr', 'Crypt::PKCS11::CK_RC2_MAC_GENERAL_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_RC5_PARAMS->new, 'Crypt::PKCS11::CK_RC5_PARAMSPtr', 'Crypt::PKCS11::CK_RC5_PARAMS->new' );
    is( $obj->set_ulWordsize(1), CKR_OK, '$obj->set_ulWordsize(1)' );
    is( $obj->set_ulWordsize(1), CKR_OK, '$obj->set_ulWordsize(1)' );
    is( $obj->set_ulRounds(1), CKR_OK, '$obj->set_ulRounds(1)' );
    is( $obj->set_ulRounds(1), CKR_OK, '$obj->set_ulRounds(1)' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_RC5_PARAMS->new, 'Crypt::PKCS11::CK_RC5_PARAMSPtr', 'Crypt::PKCS11::CK_RC5_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_RC5_CBC_PARAMS->new, 'Crypt::PKCS11::CK_RC5_CBC_PARAMSPtr', 'Crypt::PKCS11::CK_RC5_CBC_PARAMS->new' );
    is( $obj->set_ulWordsize(1), CKR_OK, '$obj->set_ulWordsize(1)' );
    is( $obj->set_ulWordsize(1), CKR_OK, '$obj->set_ulWordsize(1)' );
    is( $obj->set_ulRounds(1), CKR_OK, '$obj->set_ulRounds(1)' );
    is( $obj->set_ulRounds(1), CKR_OK, '$obj->set_ulRounds(1)' );
    is( $obj->set_pIv('1'), CKR_OK, '$obj->set_pIv("1")' );
    is( $obj->set_pIv('1'), CKR_OK, '$obj->set_pIv("1")' );
    is( $obj->set_pIv(undef), CKR_OK, '$obj->set_pIv(undef)' );
    is( $obj->set_pIv('1'), CKR_OK, '$obj->set_pIv("1")' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_RC5_CBC_PARAMS->new, 'Crypt::PKCS11::CK_RC5_CBC_PARAMSPtr', 'Crypt::PKCS11::CK_RC5_CBC_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_RC5_MAC_GENERAL_PARAMS->new, 'Crypt::PKCS11::CK_RC5_MAC_GENERAL_PARAMSPtr', 'Crypt::PKCS11::CK_RC5_MAC_GENERAL_PARAMS->new' );
    is( $obj->set_ulWordsize(1), CKR_OK, '$obj->set_ulWordsize(1)' );
    is( $obj->set_ulWordsize(1), CKR_OK, '$obj->set_ulWordsize(1)' );
    is( $obj->set_ulRounds(1), CKR_OK, '$obj->set_ulRounds(1)' );
    is( $obj->set_ulRounds(1), CKR_OK, '$obj->set_ulRounds(1)' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_RC5_MAC_GENERAL_PARAMS->new, 'Crypt::PKCS11::CK_RC5_MAC_GENERAL_PARAMSPtr', 'Crypt::PKCS11::CK_RC5_MAC_GENERAL_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_DES_CBC_ENCRYPT_DATA_PARAMS->new, 'Crypt::PKCS11::CK_DES_CBC_ENCRYPT_DATA_PARAMSPtr', 'Crypt::PKCS11::CK_DES_CBC_ENCRYPT_DATA_PARAMS->new' );
    is( $obj->set_iv('123456789'), CKR_ARGUMENTS_BAD, '$obj->set_iv("123456789")' );
    is( $obj->set_iv(-1), CKR_ARGUMENTS_BAD, '$obj->set_iv(-1)' );
    is( $obj->set_iv('12345678'), CKR_OK, '$obj->set_iv("12345678")' );
    is( $obj->set_iv('12345678'), CKR_OK, '$obj->set_iv("12345678")' );
    is( $obj->set_iv(undef), CKR_OK, '$obj->set_iv(undef)' );
    is( $obj->set_iv('12345678'), CKR_OK, '$obj->set_iv("12345678")' );
    is( $obj->set_pData('1'), CKR_OK, '$obj->set_pData("1")' );
    is( $obj->set_pData('1'), CKR_OK, '$obj->set_pData("1")' );
    is( $obj->set_pData(undef), CKR_OK, '$obj->set_pData(undef)' );
    is( $obj->set_pData('1'), CKR_OK, '$obj->set_pData("1")' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_DES_CBC_ENCRYPT_DATA_PARAMS->new, 'Crypt::PKCS11::CK_DES_CBC_ENCRYPT_DATA_PARAMSPtr', 'Crypt::PKCS11::CK_DES_CBC_ENCRYPT_DATA_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_AES_CBC_ENCRYPT_DATA_PARAMS->new, 'Crypt::PKCS11::CK_AES_CBC_ENCRYPT_DATA_PARAMSPtr', 'Crypt::PKCS11::CK_AES_CBC_ENCRYPT_DATA_PARAMS->new' );
    is( $obj->set_iv('12345678123456789'), CKR_ARGUMENTS_BAD, '$obj->set_iv("12345678123456789")' );
    is( $obj->set_iv(-1), CKR_ARGUMENTS_BAD, '$obj->set_iv(-1)' );
    is( $obj->set_iv('1234567812345678'), CKR_OK, '$obj->set_iv("1234567812345678")' );
    is( $obj->set_iv('1234567812345678'), CKR_OK, '$obj->set_iv("1234567812345678")' );
    is( $obj->set_iv(undef), CKR_OK, '$obj->set_iv(undef)' );
    is( $obj->set_iv('1234567812345678'), CKR_OK, '$obj->set_iv("1234567812345678")' );
    is( $obj->set_pData('1'), CKR_OK, '$obj->set_pData("1")' );
    is( $obj->set_pData('1'), CKR_OK, '$obj->set_pData("1")' );
    is( $obj->set_pData(undef), CKR_OK, '$obj->set_pData(undef)' );
    is( $obj->set_pData('1'), CKR_OK, '$obj->set_pData("1")' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_AES_CBC_ENCRYPT_DATA_PARAMS->new, 'Crypt::PKCS11::CK_AES_CBC_ENCRYPT_DATA_PARAMSPtr', 'Crypt::PKCS11::CK_AES_CBC_ENCRYPT_DATA_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new, 'Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMSPtr', 'Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new' );
    is( $obj->set_pPassword('1'), CKR_OK, '$obj->set_pPassword("1")' );
    is( $obj->set_pPassword('1'), CKR_OK, '$obj->set_pPassword("1")' );
    is( $obj->set_pPassword(undef), CKR_OK, '$obj->set_pPassword(undef)' );
    is( $obj->set_pPassword('1'), CKR_OK, '$obj->set_pPassword("1")' );
    is( $obj->set_pPublicData('1'), CKR_OK, '$obj->set_pPublicData("1")' );
    is( $obj->set_pPublicData('1'), CKR_OK, '$obj->set_pPublicData("1")' );
    is( $obj->set_pPublicData(undef), CKR_OK, '$obj->set_pPublicData(undef)' );
    is( $obj->set_pPublicData('1'), CKR_OK, '$obj->set_pPublicData("1")' );
    is( $obj->set_pRandomA('1'), CKR_OK, '$obj->set_pRandomA("1")' );
    is( $obj->set_pRandomA('1'), CKR_OK, '$obj->set_pRandomA("1")' );
    is( $obj->set_pRandomA(undef), CKR_OK, '$obj->set_pRandomA(undef)' );
    is( $obj->set_pRandomA('1'), CKR_OK, '$obj->set_pRandomA("1")' );
    is( $obj->set_pPrimeP('1'), CKR_OK, '$obj->set_pPrimeP("1")' );
    is( $obj->set_pPrimeP('1'), CKR_OK, '$obj->set_pPrimeP("1")' );
    is( $obj->set_pPrimeP(undef), CKR_OK, '$obj->set_pPrimeP(undef)' );
    is( $obj->set_pPrimeP('1'), CKR_OK, '$obj->set_pPrimeP("1")' );
    is( $obj->set_pBaseG('1'), CKR_OK, '$obj->set_pBaseG("1")' );
    is( $obj->set_pBaseG('1'), CKR_OK, '$obj->set_pBaseG("1")' );
    is( $obj->set_pBaseG(undef), CKR_OK, '$obj->set_pBaseG(undef)' );
    is( $obj->set_pBaseG('1'), CKR_OK, '$obj->set_pBaseG("1")' );
    is( $obj->set_pSubprimeQ('1'), CKR_OK, '$obj->set_pSubprimeQ("1")' );
    is( $obj->set_pSubprimeQ('1'), CKR_OK, '$obj->set_pSubprimeQ("1")' );
    is( $obj->set_pSubprimeQ(undef), CKR_OK, '$obj->set_pSubprimeQ(undef)' );
    is( $obj->set_pSubprimeQ('1'), CKR_OK, '$obj->set_pSubprimeQ("1")' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new, 'Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMSPtr', 'Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new, 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMSPtr', 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new' );
    is( $obj->set_pOldWrappedX('1'), CKR_OK, '$obj->set_pOldWrappedX("1")' );
    is( $obj->set_pOldWrappedX('1'), CKR_OK, '$obj->set_pOldWrappedX("1")' );
    is( $obj->set_pOldWrappedX(undef), CKR_OK, '$obj->set_pOldWrappedX(undef)' );
    is( $obj->set_pOldWrappedX('1'), CKR_OK, '$obj->set_pOldWrappedX("1")' );
    is( $obj->set_pOldPassword('1'), CKR_OK, '$obj->set_pOldPassword("1")' );
    is( $obj->set_pOldPassword('1'), CKR_OK, '$obj->set_pOldPassword("1")' );
    is( $obj->set_pOldPassword(undef), CKR_OK, '$obj->set_pOldPassword(undef)' );
    is( $obj->set_pOldPassword('1'), CKR_OK, '$obj->set_pOldPassword("1")' );
    is( $obj->set_pOldPublicData('1'), CKR_OK, '$obj->set_pOldPublicData("1")' );
    is( $obj->set_pOldPublicData('1'), CKR_OK, '$obj->set_pOldPublicData("1")' );
    is( $obj->set_pOldPublicData(undef), CKR_OK, '$obj->set_pOldPublicData(undef)' );
    is( $obj->set_pOldPublicData('1'), CKR_OK, '$obj->set_pOldPublicData("1")' );
    is( $obj->set_pOldRandomA('1'), CKR_OK, '$obj->set_pOldRandomA("1")' );
    is( $obj->set_pOldRandomA('1'), CKR_OK, '$obj->set_pOldRandomA("1")' );
    is( $obj->set_pOldRandomA(undef), CKR_OK, '$obj->set_pOldRandomA(undef)' );
    is( $obj->set_pOldRandomA('1'), CKR_OK, '$obj->set_pOldRandomA("1")' );
    is( $obj->set_pNewPassword('1'), CKR_OK, '$obj->set_pNewPassword("1")' );
    is( $obj->set_pNewPassword('1'), CKR_OK, '$obj->set_pNewPassword("1")' );
    is( $obj->set_pNewPassword(undef), CKR_OK, '$obj->set_pNewPassword(undef)' );
    is( $obj->set_pNewPassword('1'), CKR_OK, '$obj->set_pNewPassword("1")' );
    is( $obj->set_pNewPublicData('1'), CKR_OK, '$obj->set_pNewPublicData("1")' );
    is( $obj->set_pNewPublicData('1'), CKR_OK, '$obj->set_pNewPublicData("1")' );
    is( $obj->set_pNewPublicData(undef), CKR_OK, '$obj->set_pNewPublicData(undef)' );
    is( $obj->set_pNewPublicData('1'), CKR_OK, '$obj->set_pNewPublicData("1")' );
    is( $obj->set_pNewRandomA('1'), CKR_OK, '$obj->set_pNewRandomA("1")' );
    is( $obj->set_pNewRandomA('1'), CKR_OK, '$obj->set_pNewRandomA("1")' );
    is( $obj->set_pNewRandomA(undef), CKR_OK, '$obj->set_pNewRandomA(undef)' );
    is( $obj->set_pNewRandomA('1'), CKR_OK, '$obj->set_pNewRandomA("1")' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new, 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMSPtr', 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_PBE_PARAMS->new, 'Crypt::PKCS11::CK_PBE_PARAMSPtr', 'Crypt::PKCS11::CK_PBE_PARAMS->new' );
    is( $obj->set_pInitVector('123456789'), CKR_ARGUMENTS_BAD, '$obj->set_pInitVector("123456789")' );
    is( $obj->set_pInitVector(-1), CKR_ARGUMENTS_BAD, '$obj->set_pInitVector(-1)' );
    is( $obj->set_pInitVector('12345678'), CKR_OK, '$obj->set_pInitVector("12345678")' );
    is( $obj->set_pInitVector('12345678'), CKR_OK, '$obj->set_pInitVector("12345678")' );
    is( $obj->set_pInitVector(undef), CKR_OK, '$obj->set_pInitVector(undef)' );
    is( $obj->set_pInitVector('12345678'), CKR_OK, '$obj->set_pInitVector("12345678")' );
    is( $obj->set_pPassword('1'), CKR_OK, '$obj->set_pPassword("1")' );
    is( $obj->set_pPassword('1'), CKR_OK, '$obj->set_pPassword("1")' );
    is( $obj->set_pPassword(undef), CKR_OK, '$obj->set_pPassword(undef)' );
    is( $obj->set_pPassword('1'), CKR_OK, '$obj->set_pPassword("1")' );
    is( $obj->set_pSalt('1'), CKR_OK, '$obj->set_pSalt("1")' );
    is( $obj->set_pSalt('1'), CKR_OK, '$obj->set_pSalt("1")' );
    is( $obj->set_pSalt(undef), CKR_OK, '$obj->set_pSalt(undef)' );
    is( $obj->set_pSalt('1'), CKR_OK, '$obj->set_pSalt("1")' );
    is( $obj->set_ulIteration(1), CKR_OK, '$obj->set_ulIteration(1)' );
    is( $obj->set_ulIteration(1), CKR_OK, '$obj->set_ulIteration(1)' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_PBE_PARAMS->new, 'Crypt::PKCS11::CK_PBE_PARAMSPtr', 'Crypt::PKCS11::CK_PBE_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes("\0" x length($bytes)), CKR_OK, '$obj2->fromBytes("\0" x length($bytes))' );
    isa_ok( $obj = Crypt::PKCS11::CK_KEY_WRAP_SET_OAEP_PARAMS->new, 'Crypt::PKCS11::CK_KEY_WRAP_SET_OAEP_PARAMSPtr', 'Crypt::PKCS11::CK_KEY_WRAP_SET_OAEP_PARAMS->new' );
    is( $obj->set_bBC(1), CKR_OK, '$obj->set_bBC(1)' );
    is( $obj->set_bBC(1), CKR_OK, '$obj->set_bBC(1)' );
    is( $obj->set_pX('1'), CKR_OK, '$obj->set_pX("1")' );
    is( $obj->set_pX('1'), CKR_OK, '$obj->set_pX("1")' );
    is( $obj->set_pX(undef), CKR_OK, '$obj->set_pX(undef)' );
    is( $obj->set_pX('1'), CKR_OK, '$obj->set_pX("1")' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_KEY_WRAP_SET_OAEP_PARAMS->new, 'Crypt::PKCS11::CK_KEY_WRAP_SET_OAEP_PARAMSPtr', 'Crypt::PKCS11::CK_KEY_WRAP_SET_OAEP_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_SSL3_RANDOM_DATA->new, 'Crypt::PKCS11::CK_SSL3_RANDOM_DATAPtr', 'Crypt::PKCS11::CK_SSL3_RANDOM_DATA->new' );
    is( $obj->set_pClientRandom('1'), CKR_OK, '$obj->set_pClientRandom("1")' );
    is( $obj->set_pClientRandom('1'), CKR_OK, '$obj->set_pClientRandom("1")' );
    is( $obj->set_pClientRandom(undef), CKR_OK, '$obj->set_pClientRandom(undef)' );
    is( $obj->set_pClientRandom('1'), CKR_OK, '$obj->set_pClientRandom("1")' );
    is( $obj->set_pServerRandom('1'), CKR_OK, '$obj->set_pServerRandom("1")' );
    is( $obj->set_pServerRandom('1'), CKR_OK, '$obj->set_pServerRandom("1")' );
    is( $obj->set_pServerRandom(undef), CKR_OK, '$obj->set_pServerRandom(undef)' );
    is( $obj->set_pServerRandom('1'), CKR_OK, '$obj->set_pServerRandom("1")' );
    $randomInfo = $obj;
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_SSL3_RANDOM_DATA->new, 'Crypt::PKCS11::CK_SSL3_RANDOM_DATAPtr', 'Crypt::PKCS11::CK_SSL3_RANDOM_DATA->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_SSL3_MASTER_KEY_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_SSL3_MASTER_KEY_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_SSL3_MASTER_KEY_DERIVE_PARAMS->new' );
    is( $obj->set_RandomInfo($randomInfo), CKR_OK, '$obj->set_RandomInfo($randomInfo)' );
    is( $obj->set_RandomInfo($randomInfo), CKR_OK, '$obj->set_RandomInfo($randomInfo)' );
    is( $obj->set_pVersion(Crypt::PKCS11::CK_VERSION->new), CKR_OK, '$obj->set_pVersion(Crypt::PKCS11::CK_VERSION->new)' );
    is( $obj->set_pVersion(Crypt::PKCS11::CK_VERSION->new), CKR_OK, '$obj->set_pVersion(Crypt::PKCS11::CK_VERSION->new)' );
    is( $obj->set_pVersion(Crypt::PKCS11::CK_VERSION->new), CKR_OK, '$obj->set_pVersion(Crypt::PKCS11::CK_VERSION->new)' );
    is( $obj->set_pVersion(Crypt::PKCS11::CK_VERSION->new), CKR_OK, '$obj->set_pVersion(Crypt::PKCS11::CK_VERSION->new)' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_SSL3_MASTER_KEY_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_SSL3_MASTER_KEY_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_SSL3_MASTER_KEY_DERIVE_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_SSL3_KEY_MAT_OUT->new, 'Crypt::PKCS11::CK_SSL3_KEY_MAT_OUTPtr', 'Crypt::PKCS11::CK_SSL3_KEY_MAT_OUT->new' );
    is( $obj->set_hClientMacSecret(1), CKR_OK, '$obj->set_hClientMacSecret(1)' );
    is( $obj->set_hClientMacSecret(1), CKR_OK, '$obj->set_hClientMacSecret(1)' );
    is( $obj->set_hServerMacSecret(1), CKR_OK, '$obj->set_hServerMacSecret(1)' );
    is( $obj->set_hServerMacSecret(1), CKR_OK, '$obj->set_hServerMacSecret(1)' );
    is( $obj->set_hClientKey(1), CKR_OK, '$obj->set_hClientKey(1)' );
    is( $obj->set_hClientKey(1), CKR_OK, '$obj->set_hClientKey(1)' );
    is( $obj->set_hServerKey(1), CKR_OK, '$obj->set_hServerKey(1)' );
    is( $obj->set_hServerKey(1), CKR_OK, '$obj->set_hServerKey(1)' );
    is( $obj->set_pIVClient('1'), CKR_FUNCTION_NOT_SUPPORTED, '$obj->set_pIVClient("1")' );
    is( $obj->set_pIVClient('1'), CKR_FUNCTION_NOT_SUPPORTED, '$obj->set_pIVClient("1")' );
    is( $obj->set_pIVClient(undef), CKR_FUNCTION_NOT_SUPPORTED, '$obj->set_pIVClient(undef)' );
    is( $obj->set_pIVClient('1'), CKR_FUNCTION_NOT_SUPPORTED, '$obj->set_pIVClient("1")' );
    is( $obj->set_pIVServer('1'), CKR_FUNCTION_NOT_SUPPORTED, '$obj->set_pIVServer("1")' );
    is( $obj->set_pIVServer('1'), CKR_FUNCTION_NOT_SUPPORTED, '$obj->set_pIVServer("1")' );
    is( $obj->set_pIVServer(undef), CKR_FUNCTION_NOT_SUPPORTED, '$obj->set_pIVServer(undef)' );
    is( $obj->set_pIVServer('1'), CKR_FUNCTION_NOT_SUPPORTED, '$obj->set_pIVServer("1")' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_SSL3_KEY_MAT_OUT->new, 'Crypt::PKCS11::CK_SSL3_KEY_MAT_OUTPtr', 'Crypt::PKCS11::CK_SSL3_KEY_MAT_OUT->new' );
    is( $obj2->fromBytes($bytes), CKR_FUNCTION_NOT_SUPPORTED, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_FUNCTION_NOT_SUPPORTED, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMS->new, 'Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMSPtr', 'Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMS->new' );
    is( $obj->set_ulMacSizeInBits(1), CKR_OK, '$obj->set_ulMacSizeInBits(1)' );
    is( $obj->set_ulMacSizeInBits(1), CKR_OK, '$obj->set_ulMacSizeInBits(1)' );
    is( $obj->set_ulKeySizeInBits(1), CKR_OK, '$obj->set_ulKeySizeInBits(1)' );
    is( $obj->set_ulKeySizeInBits(1), CKR_OK, '$obj->set_ulKeySizeInBits(1)' );
    is( $obj->set_ulIVSizeInBits(1), CKR_OK, '$obj->set_ulIVSizeInBits(1)' );
    is( $obj->set_ulIVSizeInBits(1), CKR_OK, '$obj->set_ulIVSizeInBits(1)' );
    is( $obj->set_bIsExport(1), CKR_OK, '$obj->set_bIsExport(1)' );
    is( $obj->set_bIsExport(1), CKR_OK, '$obj->set_bIsExport(1)' );
    is( $obj->set_RandomInfo($randomInfo), CKR_OK, '$obj->set_RandomInfo($randomInfo)' );
    is( $obj->set_RandomInfo($randomInfo), CKR_OK, '$obj->set_RandomInfo($randomInfo)' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMS->new, 'Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMSPtr', 'Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_FUNCTION_NOT_SUPPORTED, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_FUNCTION_NOT_SUPPORTED, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_TLS_PRF_PARAMS->new, 'Crypt::PKCS11::CK_TLS_PRF_PARAMSPtr', 'Crypt::PKCS11::CK_TLS_PRF_PARAMS->new' );
    is( $obj->set_pSeed('1'), CKR_OK, '$obj->set_pSeed("1")' );
    is( $obj->set_pSeed('1'), CKR_OK, '$obj->set_pSeed("1")' );
    is( $obj->set_pSeed(undef), CKR_OK, '$obj->set_pSeed(undef)' );
    is( $obj->set_pSeed('1'), CKR_OK, '$obj->set_pSeed("1")' );
    is( $obj->set_pLabel('1'), CKR_OK, '$obj->set_pLabel("1")' );
    is( $obj->set_pLabel('1'), CKR_OK, '$obj->set_pLabel("1")' );
    is( $obj->set_pLabel(undef), CKR_OK, '$obj->set_pLabel(undef)' );
    is( $obj->set_pLabel('1'), CKR_OK, '$obj->set_pLabel("1")' );
    is( $obj->set_pOutput(1), CKR_OK, '$obj->set_pOutput(1)' );
    is( $obj->set_pOutput(1), CKR_OK, '$obj->set_pOutput(1)' );
    is( $obj->set_pOutput(undef), CKR_OK, '$obj->set_pOutput(undef)' );
    is( $obj->set_pOutput(1), CKR_OK, '$obj->set_pOutput(1)' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_TLS_PRF_PARAMS->new, 'Crypt::PKCS11::CK_TLS_PRF_PARAMSPtr', 'Crypt::PKCS11::CK_TLS_PRF_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_WTLS_RANDOM_DATA->new, 'Crypt::PKCS11::CK_WTLS_RANDOM_DATAPtr', 'Crypt::PKCS11::CK_WTLS_RANDOM_DATA->new' );
    is( $obj->set_pClientRandom('1'), CKR_OK, '$obj->set_pClientRandom("1")' );
    is( $obj->set_pClientRandom('1'), CKR_OK, '$obj->set_pClientRandom("1")' );
    is( $obj->set_pClientRandom(undef), CKR_OK, '$obj->set_pClientRandom(undef)' );
    is( $obj->set_pClientRandom('1'), CKR_OK, '$obj->set_pClientRandom("1")' );
    is( $obj->set_pServerRandom('1'), CKR_OK, '$obj->set_pServerRandom("1")' );
    is( $obj->set_pServerRandom('1'), CKR_OK, '$obj->set_pServerRandom("1")' );
    is( $obj->set_pServerRandom(undef), CKR_OK, '$obj->set_pServerRandom(undef)' );
    is( $obj->set_pServerRandom('1'), CKR_OK, '$obj->set_pServerRandom("1")' );
    $randomInfo = $obj;
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_WTLS_RANDOM_DATA->new, 'Crypt::PKCS11::CK_WTLS_RANDOM_DATAPtr', 'Crypt::PKCS11::CK_WTLS_RANDOM_DATA->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_WTLS_MASTER_KEY_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_WTLS_MASTER_KEY_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_WTLS_MASTER_KEY_DERIVE_PARAMS->new' );
    is( $obj->set_DigestMechanism(1), CKR_OK, '$obj->set_DigestMechanism(1)' );
    is( $obj->set_DigestMechanism(1), CKR_OK, '$obj->set_DigestMechanism(1)' );
    is( $obj->set_RandomInfo($randomInfo), CKR_OK, '$obj->set_RandomInfo($randomInfo)' );
    is( $obj->set_RandomInfo($randomInfo), CKR_OK, '$obj->set_RandomInfo($randomInfo)' );
    is( $obj->set_pVersion('1'), CKR_FUNCTION_NOT_SUPPORTED, '$obj->set_pVersion("1")' );
    is( $obj->set_pVersion('1'), CKR_FUNCTION_NOT_SUPPORTED, '$obj->set_pVersion("1")' );
    is( $obj->set_pVersion(undef), CKR_FUNCTION_NOT_SUPPORTED, '$obj->set_pVersion(undef)' );
    is( $obj->set_pVersion('1'), CKR_FUNCTION_NOT_SUPPORTED, '$obj->set_pVersion("1")' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_WTLS_MASTER_KEY_DERIVE_PARAMS->new, 'Crypt::PKCS11::CK_WTLS_MASTER_KEY_DERIVE_PARAMSPtr', 'Crypt::PKCS11::CK_WTLS_MASTER_KEY_DERIVE_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new, 'Crypt::PKCS11::CK_WTLS_PRF_PARAMSPtr', 'Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new' );
    is( $obj->set_DigestMechanism(1), CKR_OK, '$obj->set_DigestMechanism(1)' );
    is( $obj->set_DigestMechanism(1), CKR_OK, '$obj->set_DigestMechanism(1)' );
    is( $obj->set_pSeed('1'), CKR_OK, '$obj->set_pSeed("1")' );
    is( $obj->set_pSeed('1'), CKR_OK, '$obj->set_pSeed("1")' );
    is( $obj->set_pSeed(undef), CKR_OK, '$obj->set_pSeed(undef)' );
    is( $obj->set_pSeed('1'), CKR_OK, '$obj->set_pSeed("1")' );
    is( $obj->set_pLabel('1'), CKR_OK, '$obj->set_pLabel("1")' );
    is( $obj->set_pLabel('1'), CKR_OK, '$obj->set_pLabel("1")' );
    is( $obj->set_pLabel(undef), CKR_OK, '$obj->set_pLabel(undef)' );
    is( $obj->set_pLabel('1'), CKR_OK, '$obj->set_pLabel("1")' );
    is( $obj->set_pOutput(1), CKR_OK, '$obj->set_pOutput(1)' );
    is( $obj->set_pOutput(1), CKR_OK, '$obj->set_pOutput(1)' );
    is( $obj->set_pOutput(undef), CKR_OK, '$obj->set_pOutput(undef)' );
    is( $obj->set_pOutput(1), CKR_OK, '$obj->set_pOutput(1)' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new, 'Crypt::PKCS11::CK_WTLS_PRF_PARAMSPtr', 'Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_WTLS_KEY_MAT_OUT->new, 'Crypt::PKCS11::CK_WTLS_KEY_MAT_OUTPtr', 'Crypt::PKCS11::CK_WTLS_KEY_MAT_OUT->new' );
    is( $obj->set_hMacSecret(1), CKR_OK, '$obj->set_hMacSecret(1)' );
    is( $obj->set_hMacSecret(1), CKR_OK, '$obj->set_hMacSecret(1)' );
    is( $obj->set_hKey(1), CKR_OK, '$obj->set_hKey(1)' );
    is( $obj->set_hKey(1), CKR_OK, '$obj->set_hKey(1)' );
    is( $obj->set_pIV('1'), CKR_FUNCTION_NOT_SUPPORTED, '$obj->set_pIV("1")' );
    is( $obj->set_pIV('1'), CKR_FUNCTION_NOT_SUPPORTED, '$obj->set_pIV("1")' );
    is( $obj->set_pIV(undef), CKR_FUNCTION_NOT_SUPPORTED, '$obj->set_pIV(undef)' );
    is( $obj->set_pIV('1'), CKR_FUNCTION_NOT_SUPPORTED, '$obj->set_pIV("1")' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_WTLS_KEY_MAT_OUT->new, 'Crypt::PKCS11::CK_WTLS_KEY_MAT_OUTPtr', 'Crypt::PKCS11::CK_WTLS_KEY_MAT_OUT->new' );
    is( $obj2->fromBytes($bytes), CKR_FUNCTION_NOT_SUPPORTED, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_FUNCTION_NOT_SUPPORTED, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new, 'Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMSPtr', 'Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new' );
    is( $obj->set_DigestMechanism(1), CKR_OK, '$obj->set_DigestMechanism(1)' );
    is( $obj->set_DigestMechanism(1), CKR_OK, '$obj->set_DigestMechanism(1)' );
    is( $obj->set_ulMacSizeInBits(1), CKR_OK, '$obj->set_ulMacSizeInBits(1)' );
    is( $obj->set_ulMacSizeInBits(1), CKR_OK, '$obj->set_ulMacSizeInBits(1)' );
    is( $obj->set_ulKeySizeInBits(1), CKR_OK, '$obj->set_ulKeySizeInBits(1)' );
    is( $obj->set_ulKeySizeInBits(1), CKR_OK, '$obj->set_ulKeySizeInBits(1)' );
    is( $obj->set_ulIVSizeInBits(1), CKR_OK, '$obj->set_ulIVSizeInBits(1)' );
    is( $obj->set_ulIVSizeInBits(1), CKR_OK, '$obj->set_ulIVSizeInBits(1)' );
    is( $obj->set_ulSequenceNumber(1), CKR_OK, '$obj->set_ulSequenceNumber(1)' );
    is( $obj->set_ulSequenceNumber(1), CKR_OK, '$obj->set_ulSequenceNumber(1)' );
    is( $obj->set_bIsExport(1), CKR_OK, '$obj->set_bIsExport(1)' );
    is( $obj->set_bIsExport(1), CKR_OK, '$obj->set_bIsExport(1)' );
    is( $obj->set_RandomInfo($randomInfo), CKR_OK, '$obj->set_RandomInfo($randomInfo)' );
    is( $obj->set_RandomInfo($randomInfo), CKR_OK, '$obj->set_RandomInfo($randomInfo)' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new, 'Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMSPtr', 'Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_FUNCTION_NOT_SUPPORTED, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_FUNCTION_NOT_SUPPORTED, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_CMS_SIG_PARAMS->new, 'Crypt::PKCS11::CK_CMS_SIG_PARAMSPtr', 'Crypt::PKCS11::CK_CMS_SIG_PARAMS->new' );
    is( $obj->set_certificateHandle(1), CKR_OK, '$obj->set_certificateHandle(1)' );
    is( $obj->set_certificateHandle(1), CKR_OK, '$obj->set_certificateHandle(1)' );
    is( $obj->set_pSigningMechanism(Crypt::PKCS11::CK_MECHANISM->new), CKR_OK, '$obj->set_pSigningMechanism(Crypt::PKCS11::CK_MECHANISM->new)' );
    is( $obj->set_pSigningMechanism(Crypt::PKCS11::CK_MECHANISM->new), CKR_OK, '$obj->set_pSigningMechanism(Crypt::PKCS11::CK_MECHANISM->new)' );
    is( $obj->set_pSigningMechanism(Crypt::PKCS11::CK_MECHANISM->new), CKR_OK, '$obj->set_pSigningMechanism(Crypt::PKCS11::CK_MECHANISM->new)' );
    is( $obj->set_pSigningMechanism(Crypt::PKCS11::CK_MECHANISM->new), CKR_OK, '$obj->set_pSigningMechanism(Crypt::PKCS11::CK_MECHANISM->new)' );
    is( $obj->set_pDigestMechanism(Crypt::PKCS11::CK_MECHANISM->new), CKR_OK, '$obj->set_pDigestMechanism(Crypt::PKCS11::CK_MECHANISM->new)' );
    is( $obj->set_pDigestMechanism(Crypt::PKCS11::CK_MECHANISM->new), CKR_OK, '$obj->set_pDigestMechanism(Crypt::PKCS11::CK_MECHANISM->new)' );
    is( $obj->set_pDigestMechanism(Crypt::PKCS11::CK_MECHANISM->new), CKR_OK, '$obj->set_pDigestMechanism(Crypt::PKCS11::CK_MECHANISM->new)' );
    is( $obj->set_pDigestMechanism(Crypt::PKCS11::CK_MECHANISM->new), CKR_OK, '$obj->set_pDigestMechanism(Crypt::PKCS11::CK_MECHANISM->new)' );
    is( $obj->set_pContentType('1'), CKR_OK, '$obj->set_pContentType("1")' );
    is( $obj->set_pContentType('1'), CKR_OK, '$obj->set_pContentType("1")' );
    is( $obj->set_pContentType(undef), CKR_OK, '$obj->set_pContentType(undef)' );
    is( $obj->set_pContentType('1'), CKR_OK, '$obj->set_pContentType("1")' );
    is( $obj->set_pRequestedAttributes('1'), CKR_OK, '$obj->set_pRequestedAttributes("1")' );
    is( $obj->set_pRequestedAttributes('1'), CKR_OK, '$obj->set_pRequestedAttributes("1")' );
    is( $obj->set_pRequestedAttributes(undef), CKR_OK, '$obj->set_pRequestedAttributes(undef)' );
    is( $obj->set_pRequestedAttributes('1'), CKR_OK, '$obj->set_pRequestedAttributes("1")' );
    is( $obj->set_pRequiredAttributes('1'), CKR_OK, '$obj->set_pRequiredAttributes("1")' );
    is( $obj->set_pRequiredAttributes('1'), CKR_OK, '$obj->set_pRequiredAttributes("1")' );
    is( $obj->set_pRequiredAttributes(undef), CKR_OK, '$obj->set_pRequiredAttributes(undef)' );
    is( $obj->set_pRequiredAttributes('1'), CKR_OK, '$obj->set_pRequiredAttributes("1")' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_CMS_SIG_PARAMS->new, 'Crypt::PKCS11::CK_CMS_SIG_PARAMSPtr', 'Crypt::PKCS11::CK_CMS_SIG_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_KEY_DERIVATION_STRING_DATA->new, 'Crypt::PKCS11::CK_KEY_DERIVATION_STRING_DATAPtr', 'Crypt::PKCS11::CK_KEY_DERIVATION_STRING_DATA->new' );
    is( $obj->set_pData('1'), CKR_OK, '$obj->set_pData("1")' );
    is( $obj->set_pData('1'), CKR_OK, '$obj->set_pData("1")' );
    is( $obj->set_pData(undef), CKR_OK, '$obj->set_pData(undef)' );
    is( $obj->set_pData('1'), CKR_OK, '$obj->set_pData("1")' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_KEY_DERIVATION_STRING_DATA->new, 'Crypt::PKCS11::CK_KEY_DERIVATION_STRING_DATAPtr', 'Crypt::PKCS11::CK_KEY_DERIVATION_STRING_DATA->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new, 'Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMSPtr', 'Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new' );
    is( $obj->set_saltSource(1), CKR_OK, '$obj->set_saltSource(1)' );
    is( $obj->set_saltSource(1), CKR_OK, '$obj->set_saltSource(1)' );
    is( $obj->set_pSaltSourceData('1'), CKR_OK, '$obj->set_pSaltSourceData("1")' );
    is( $obj->set_pSaltSourceData('1'), CKR_OK, '$obj->set_pSaltSourceData("1")' );
    is( $obj->set_pSaltSourceData(undef), CKR_OK, '$obj->set_pSaltSourceData(undef)' );
    is( $obj->set_pSaltSourceData('1'), CKR_OK, '$obj->set_pSaltSourceData("1")' );
    is( $obj->set_iterations(1), CKR_OK, '$obj->set_iterations(1)' );
    is( $obj->set_iterations(1), CKR_OK, '$obj->set_iterations(1)' );
    is( $obj->set_prf(1), CKR_OK, '$obj->set_prf(1)' );
    is( $obj->set_prf(1), CKR_OK, '$obj->set_prf(1)' );
    is( $obj->set_pPrfData('1'), CKR_OK, '$obj->set_pPrfData("1")' );
    is( $obj->set_pPrfData('1'), CKR_OK, '$obj->set_pPrfData("1")' );
    is( $obj->set_pPrfData(undef), CKR_OK, '$obj->set_pPrfData(undef)' );
    is( $obj->set_pPrfData('1'), CKR_OK, '$obj->set_pPrfData("1")' );
    is( $obj->set_pPassword(1), CKR_OK, '$obj->set_pPassword(1)' );
    is( $obj->set_pPassword(1), CKR_OK, '$obj->set_pPassword(1)' );
    is( $obj->set_pPassword(undef), CKR_OK, '$obj->set_pPassword(undef)' );
    is( $obj->set_pPassword(1), CKR_OK, '$obj->set_pPassword(1)' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new, 'Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMSPtr', 'Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_OTP_PARAM->new, 'Crypt::PKCS11::CK_OTP_PARAMPtr', 'Crypt::PKCS11::CK_OTP_PARAM->new' );
    is( $obj->set_type(1), CKR_OK, '$obj->set_type(1)' );
    is( $obj->set_type(1), CKR_OK, '$obj->set_type(1)' );
    is( $obj->set_pValue('1'), CKR_OK, '$obj->set_pValue("1")' );
    is( $obj->set_pValue('1'), CKR_OK, '$obj->set_pValue("1")' );
    is( $obj->set_pValue(undef), CKR_OK, '$obj->set_pValue(undef)' );
    is( $obj->set_pValue('1'), CKR_OK, '$obj->set_pValue("1")' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_OTP_PARAM->new, 'Crypt::PKCS11::CK_OTP_PARAMPtr', 'Crypt::PKCS11::CK_OTP_PARAM->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_OTP_PARAMS->new, 'Crypt::PKCS11::CK_OTP_PARAMSPtr', 'Crypt::PKCS11::CK_OTP_PARAMS->new' );
# TODO:
#    is( $obj->set_pParams([$obj]), CKR_OK, '$obj->set_pParams([$obj])' );
#    is( $obj->set_pParams([$obj]), CKR_OK, '$obj->set_pParams([$obj])' );
#    is( $obj->set_pParams([$obj]), CKR_OK, '$obj->set_pParams([$obj])' );
#    is( $obj->set_pParams([$obj]), CKR_OK, '$obj->set_pParams([$obj])' );
    is( $obj->set_ulCount(1), CKR_FUNCTION_NOT_SUPPORTED, '$obj->set_ulCount(1)' );
    is( $obj->set_ulCount(1), CKR_FUNCTION_NOT_SUPPORTED, '$obj->set_ulCount(1)' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_OTP_PARAMS->new, 'Crypt::PKCS11::CK_OTP_PARAMSPtr', 'Crypt::PKCS11::CK_OTP_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_OTP_SIGNATURE_INFO->new, 'Crypt::PKCS11::CK_OTP_SIGNATURE_INFOPtr', 'Crypt::PKCS11::CK_OTP_SIGNATURE_INFO->new' );
# TODO:
#    is( $obj->set_pParams([$obj]), CKR_OK, '$obj->set_pParams([$obj])' );
#    is( $obj->set_pParams([$obj]), CKR_OK, '$obj->set_pParams([$obj])' );
#    is( $obj->set_pParams([$obj]), CKR_OK, '$obj->set_pParams([$obj])' );
#    is( $obj->set_pParams([$obj]), CKR_OK, '$obj->set_pParams([$obj])' );
    is( $obj->set_ulCount(1), CKR_FUNCTION_NOT_SUPPORTED, '$obj->set_ulCount(1)' );
    is( $obj->set_ulCount(1), CKR_FUNCTION_NOT_SUPPORTED, '$obj->set_ulCount(1)' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_OTP_SIGNATURE_INFO->new, 'Crypt::PKCS11::CK_OTP_SIGNATURE_INFOPtr', 'Crypt::PKCS11::CK_OTP_SIGNATURE_INFO->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_KIP_PARAMS->new, 'Crypt::PKCS11::CK_KIP_PARAMSPtr', 'Crypt::PKCS11::CK_KIP_PARAMS->new' );
    is( $obj->set_pMechanism(Crypt::PKCS11::CK_MECHANISM->new), CKR_OK, '$obj->set_pMechanism(Crypt::PKCS11::CK_MECHANISM->new)' );
    is( $obj->set_pMechanism(Crypt::PKCS11::CK_MECHANISM->new), CKR_OK, '$obj->set_pMechanism(Crypt::PKCS11::CK_MECHANISM->new)' );
    is( $obj->set_pMechanism(Crypt::PKCS11::CK_MECHANISM->new), CKR_OK, '$obj->set_pMechanism(Crypt::PKCS11::CK_MECHANISM->new)' );
    is( $obj->set_pMechanism(Crypt::PKCS11::CK_MECHANISM->new), CKR_OK, '$obj->set_pMechanism(Crypt::PKCS11::CK_MECHANISM->new)' );
    is( $obj->set_hKey(1), CKR_OK, '$obj->set_hKey(1)' );
    is( $obj->set_hKey(1), CKR_OK, '$obj->set_hKey(1)' );
    is( $obj->set_pSeed('1'), CKR_OK, '$obj->set_pSeed("1")' );
    is( $obj->set_pSeed('1'), CKR_OK, '$obj->set_pSeed("1")' );
    is( $obj->set_pSeed(undef), CKR_OK, '$obj->set_pSeed(undef)' );
    is( $obj->set_pSeed('1'), CKR_OK, '$obj->set_pSeed("1")' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_KIP_PARAMS->new, 'Crypt::PKCS11::CK_KIP_PARAMSPtr', 'Crypt::PKCS11::CK_KIP_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_AES_CTR_PARAMS->new, 'Crypt::PKCS11::CK_AES_CTR_PARAMSPtr', 'Crypt::PKCS11::CK_AES_CTR_PARAMS->new' );
    is( $obj->set_ulCounterBits(1), CKR_OK, '$obj->set_ulCounterBits(1)' );
    is( $obj->set_ulCounterBits(1), CKR_OK, '$obj->set_ulCounterBits(1)' );
    is( $obj->set_cb('12345678123456789'), CKR_ARGUMENTS_BAD, '$obj->set_cb("12345678123456789")' );
    is( $obj->set_cb(-1), CKR_ARGUMENTS_BAD, '$obj->set_cb(-1)' );
    is( $obj->set_cb('1234567812345678'), CKR_OK, '$obj->set_cb("1234567812345678")' );
    is( $obj->set_cb('1234567812345678'), CKR_OK, '$obj->set_cb("1234567812345678")' );
    is( $obj->set_cb(undef), CKR_OK, '$obj->set_cb(undef)' );
    is( $obj->set_cb('1234567812345678'), CKR_OK, '$obj->set_cb("1234567812345678")' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_AES_CTR_PARAMS->new, 'Crypt::PKCS11::CK_AES_CTR_PARAMSPtr', 'Crypt::PKCS11::CK_AES_CTR_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_AES_GCM_PARAMS->new, 'Crypt::PKCS11::CK_AES_GCM_PARAMSPtr', 'Crypt::PKCS11::CK_AES_GCM_PARAMS->new' );
    is( $obj->set_pIv('1'), CKR_OK, '$obj->set_pIv("1")' );
    is( $obj->set_pIv('1'), CKR_OK, '$obj->set_pIv("1")' );
    is( $obj->set_pIv(undef), CKR_OK, '$obj->set_pIv(undef)' );
    is( $obj->set_pIv('1'), CKR_OK, '$obj->set_pIv("1")' );
    is( $obj->set_ulIvBits(1), CKR_OK, '$obj->set_ulIvBits(1)' );
    is( $obj->set_ulIvBits(1), CKR_OK, '$obj->set_ulIvBits(1)' );
    is( $obj->set_pAAD('1'), CKR_OK, '$obj->set_pAAD("1")' );
    is( $obj->set_pAAD('1'), CKR_OK, '$obj->set_pAAD("1")' );
    is( $obj->set_pAAD(undef), CKR_OK, '$obj->set_pAAD(undef)' );
    is( $obj->set_pAAD('1'), CKR_OK, '$obj->set_pAAD("1")' );
    is( $obj->set_ulTagBits(1), CKR_OK, '$obj->set_ulTagBits(1)' );
    is( $obj->set_ulTagBits(1), CKR_OK, '$obj->set_ulTagBits(1)' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_AES_GCM_PARAMS->new, 'Crypt::PKCS11::CK_AES_GCM_PARAMSPtr', 'Crypt::PKCS11::CK_AES_GCM_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_AES_CCM_PARAMS->new, 'Crypt::PKCS11::CK_AES_CCM_PARAMSPtr', 'Crypt::PKCS11::CK_AES_CCM_PARAMS->new' );
    is( $obj->set_pNonce('1'), CKR_OK, '$obj->set_pNonce("1")' );
    is( $obj->set_pNonce('1'), CKR_OK, '$obj->set_pNonce("1")' );
    is( $obj->set_pNonce(undef), CKR_OK, '$obj->set_pNonce(undef)' );
    is( $obj->set_pNonce('1'), CKR_OK, '$obj->set_pNonce("1")' );
    is( $obj->set_pAAD('1'), CKR_OK, '$obj->set_pAAD("1")' );
    is( $obj->set_pAAD('1'), CKR_OK, '$obj->set_pAAD("1")' );
    is( $obj->set_pAAD(undef), CKR_OK, '$obj->set_pAAD(undef)' );
    is( $obj->set_pAAD('1'), CKR_OK, '$obj->set_pAAD("1")' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_AES_CCM_PARAMS->new, 'Crypt::PKCS11::CK_AES_CCM_PARAMSPtr', 'Crypt::PKCS11::CK_AES_CCM_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_CAMELLIA_CTR_PARAMS->new, 'Crypt::PKCS11::CK_CAMELLIA_CTR_PARAMSPtr', 'Crypt::PKCS11::CK_CAMELLIA_CTR_PARAMS->new' );
    is( $obj->set_ulCounterBits(1), CKR_OK, '$obj->set_ulCounterBits(1)' );
    is( $obj->set_ulCounterBits(1), CKR_OK, '$obj->set_ulCounterBits(1)' );
    is( $obj->set_cb('12345678123456789'), CKR_ARGUMENTS_BAD, '$obj->set_cb("12345678123456789")' );
    is( $obj->set_cb(-1), CKR_ARGUMENTS_BAD, '$obj->set_cb(-1)' );
    is( $obj->set_cb('1234567812345678'), CKR_OK, '$obj->set_cb("1234567812345678")' );
    is( $obj->set_cb('1234567812345678'), CKR_OK, '$obj->set_cb("1234567812345678")' );
    is( $obj->set_cb(undef), CKR_OK, '$obj->set_cb(undef)' );
    is( $obj->set_cb('1234567812345678'), CKR_OK, '$obj->set_cb("1234567812345678")' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_CAMELLIA_CTR_PARAMS->new, 'Crypt::PKCS11::CK_CAMELLIA_CTR_PARAMSPtr', 'Crypt::PKCS11::CK_CAMELLIA_CTR_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_CAMELLIA_CBC_ENCRYPT_DATA_PARAMS->new, 'Crypt::PKCS11::CK_CAMELLIA_CBC_ENCRYPT_DATA_PARAMSPtr', 'Crypt::PKCS11::CK_CAMELLIA_CBC_ENCRYPT_DATA_PARAMS->new' );
    is( $obj->set_iv('12345678123456789'), CKR_ARGUMENTS_BAD, '$obj->set_iv("12345678123456789")' );
    is( $obj->set_iv(-1), CKR_ARGUMENTS_BAD, '$obj->set_iv(-1)' );
    is( $obj->set_iv('1234567812345678'), CKR_OK, '$obj->set_iv("1234567812345678")' );
    is( $obj->set_iv('1234567812345678'), CKR_OK, '$obj->set_iv("1234567812345678")' );
    is( $obj->set_iv(undef), CKR_OK, '$obj->set_iv(undef)' );
    is( $obj->set_iv('1234567812345678'), CKR_OK, '$obj->set_iv("1234567812345678")' );
    is( $obj->set_pData('1'), CKR_OK, '$obj->set_pData("1")' );
    is( $obj->set_pData('1'), CKR_OK, '$obj->set_pData("1")' );
    is( $obj->set_pData(undef), CKR_OK, '$obj->set_pData(undef)' );
    is( $obj->set_pData('1'), CKR_OK, '$obj->set_pData("1")' );
    ok( $bytes = $obj->toBytes, '$obj->toBytes' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_CAMELLIA_CBC_ENCRYPT_DATA_PARAMS->new, 'Crypt::PKCS11::CK_CAMELLIA_CBC_ENCRYPT_DATA_PARAMSPtr', 'Crypt::PKCS11::CK_CAMELLIA_CBC_ENCRYPT_DATA_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    isa_ok( $obj = Crypt::PKCS11::CK_ARIA_CBC_ENCRYPT_DATA_PARAMS->new, 'Crypt::PKCS11::CK_ARIA_CBC_ENCRYPT_DATA_PARAMSPtr', 'Crypt::PKCS11::CK_ARIA_CBC_ENCRYPT_DATA_PARAMS->new' );
    is( $obj->set_iv('12345678123456789'), CKR_ARGUMENTS_BAD, '$obj->set_iv("12345678123456789")' );
    is( $obj->set_iv(-1), CKR_ARGUMENTS_BAD, '$obj->set_iv(-1)' );
    is( $obj->set_iv('1234567812345678'), CKR_OK, '$obj->set_iv("1234567812345678")' );
    is( $obj->set_iv('1234567812345678'), CKR_OK, '$obj->set_iv("1234567812345678")' );
    is( $obj->set_iv(undef), CKR_OK, '$obj->set_iv(undef)' );
    is( $obj->set_iv('1234567812345678'), CKR_OK, '$obj->set_iv("1234567812345678")' );
    is( $obj->set_pData('1'), CKR_OK, '$obj->set_pData("1")' );
    is( $obj->set_pData('1'), CKR_OK, '$obj->set_pData("1")' );
    is( $obj->set_pData(undef), CKR_OK, '$obj->set_pData(undef)' );
    is( $obj->set_pData('1'), CKR_OK, '$obj->set_pData("1")' );
    isa_ok( $obj2 = Crypt::PKCS11::CK_ARIA_CBC_ENCRYPT_DATA_PARAMS->new, 'Crypt::PKCS11::CK_ARIA_CBC_ENCRYPT_DATA_PARAMSPtr', 'Crypt::PKCS11::CK_ARIA_CBC_ENCRYPT_DATA_PARAMS->new' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );
    is( $obj2->fromBytes($bytes), CKR_OK, '$obj2->fromBytes($bytes)' );

    is( Crypt::PKCS11::CK_VERSION->new->set_major(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_VERSION->new->set_major(-1)' );
    is( Crypt::PKCS11::CK_VERSION->new->set_minor(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_VERSION->new->set_minor(-1)' );
    is( Crypt::PKCS11::CK_MECHANISM->new->set_mechanism(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_MECHANISM->new->set_mechanism(-1)' );
    is( Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMS->new->set_hashAlg(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMS->new->set_hashAlg(-1)' );
    is( Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMS->new->set_mgf(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMS->new->set_mgf(-1)' );
    is( Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMS->new->set_source(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMS->new->set_source(-1)' );
    is( Crypt::PKCS11::CK_RSA_PKCS_PSS_PARAMS->new->set_hashAlg(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_RSA_PKCS_PSS_PARAMS->new->set_hashAlg(-1)' );
    is( Crypt::PKCS11::CK_RSA_PKCS_PSS_PARAMS->new->set_mgf(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_RSA_PKCS_PSS_PARAMS->new->set_mgf(-1)' );
    is( Crypt::PKCS11::CK_RSA_PKCS_PSS_PARAMS->new->set_sLen(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_RSA_PKCS_PSS_PARAMS->new->set_sLen(-1)' );
    is( Crypt::PKCS11::CK_ECDH1_DERIVE_PARAMS->new->set_kdf(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_ECDH1_DERIVE_PARAMS->new->set_kdf(-1)' );
    is( Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new->set_kdf(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new->set_kdf(-1)' );
    is( Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new->set_hPrivateData(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new->set_hPrivateData(-1)' );
    is( Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->set_kdf(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->set_kdf(-1)' );
    is( Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->set_hPrivateData(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->set_hPrivateData(-1)' );
    is( Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->set_publicKey(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->set_publicKey(-1)' );
    is( Crypt::PKCS11::CK_X9_42_DH1_DERIVE_PARAMS->new->set_kdf(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_X9_42_DH1_DERIVE_PARAMS->new->set_kdf(-1)' );
    is( Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new->set_kdf(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new->set_kdf(-1)' );
    is( Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new->set_hPrivateData(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new->set_hPrivateData(-1)' );
    is( Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->set_kdf(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->set_kdf(-1)' );
    is( Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->set_hPrivateData(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->set_hPrivateData(-1)' );
    is( Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->set_publicKey(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->set_publicKey(-1)' );
    is( Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new->set_isSender(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new->set_isSender(-1)' );
    is( Crypt::PKCS11::CK_RC2_CBC_PARAMS->new->set_ulEffectiveBits(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_RC2_CBC_PARAMS->new->set_ulEffectiveBits(-1)' );
    is( Crypt::PKCS11::CK_RC2_MAC_GENERAL_PARAMS->new->set_ulEffectiveBits(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_RC2_MAC_GENERAL_PARAMS->new->set_ulEffectiveBits(-1)' );
    is( Crypt::PKCS11::CK_RC5_PARAMS->new->set_ulWordsize(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_RC5_PARAMS->new->set_ulWordsize(-1)' );
    is( Crypt::PKCS11::CK_RC5_PARAMS->new->set_ulRounds(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_RC5_PARAMS->new->set_ulRounds(-1)' );
    is( Crypt::PKCS11::CK_RC5_CBC_PARAMS->new->set_ulWordsize(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_RC5_CBC_PARAMS->new->set_ulWordsize(-1)' );
    is( Crypt::PKCS11::CK_RC5_CBC_PARAMS->new->set_ulRounds(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_RC5_CBC_PARAMS->new->set_ulRounds(-1)' );
    is( Crypt::PKCS11::CK_RC5_MAC_GENERAL_PARAMS->new->set_ulWordsize(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_RC5_MAC_GENERAL_PARAMS->new->set_ulWordsize(-1)' );
    is( Crypt::PKCS11::CK_RC5_MAC_GENERAL_PARAMS->new->set_ulRounds(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_RC5_MAC_GENERAL_PARAMS->new->set_ulRounds(-1)' );
    is( Crypt::PKCS11::CK_PBE_PARAMS->new->set_ulIteration(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_PBE_PARAMS->new->set_ulIteration(-1)' );
    is( Crypt::PKCS11::CK_KEY_WRAP_SET_OAEP_PARAMS->new->set_bBC(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_KEY_WRAP_SET_OAEP_PARAMS->new->set_bBC(-1)' );
    is( Crypt::PKCS11::CK_SSL3_KEY_MAT_OUT->new->set_hClientMacSecret(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_SSL3_KEY_MAT_OUT->new->set_hClientMacSecret(-1)' );
    is( Crypt::PKCS11::CK_SSL3_KEY_MAT_OUT->new->set_hServerMacSecret(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_SSL3_KEY_MAT_OUT->new->set_hServerMacSecret(-1)' );
    is( Crypt::PKCS11::CK_SSL3_KEY_MAT_OUT->new->set_hClientKey(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_SSL3_KEY_MAT_OUT->new->set_hClientKey(-1)' );
    is( Crypt::PKCS11::CK_SSL3_KEY_MAT_OUT->new->set_hServerKey(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_SSL3_KEY_MAT_OUT->new->set_hServerKey(-1)' );
    is( Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMS->new->set_ulMacSizeInBits(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMS->new->set_ulMacSizeInBits(-1)' );
    is( Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMS->new->set_ulKeySizeInBits(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMS->new->set_ulKeySizeInBits(-1)' );
    is( Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMS->new->set_ulIVSizeInBits(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMS->new->set_ulIVSizeInBits(-1)' );
    is( Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMS->new->set_bIsExport(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_SSL3_KEY_MAT_PARAMS->new->set_bIsExport(-1)' );
    is( Crypt::PKCS11::CK_TLS_PRF_PARAMS->new->set_pOutput(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_TLS_PRF_PARAMS->new->set_pOutput(-1)' );
    is( Crypt::PKCS11::CK_WTLS_MASTER_KEY_DERIVE_PARAMS->new->set_DigestMechanism(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_WTLS_MASTER_KEY_DERIVE_PARAMS->new->set_DigestMechanism(-1)' );
    is( Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new->set_DigestMechanism(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new->set_DigestMechanism(-1)' );
    is( Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new->set_pOutput(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new->set_pOutput(-1)' );
    is( Crypt::PKCS11::CK_WTLS_KEY_MAT_OUT->new->set_hMacSecret(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_WTLS_KEY_MAT_OUT->new->set_hMacSecret(-1)' );
    is( Crypt::PKCS11::CK_WTLS_KEY_MAT_OUT->new->set_hKey(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_WTLS_KEY_MAT_OUT->new->set_hKey(-1)' );
    is( Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->set_DigestMechanism(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->set_DigestMechanism(-1)' );
    is( Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->set_ulMacSizeInBits(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->set_ulMacSizeInBits(-1)' );
    is( Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->set_ulKeySizeInBits(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->set_ulKeySizeInBits(-1)' );
    is( Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->set_ulIVSizeInBits(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->set_ulIVSizeInBits(-1)' );
    is( Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->set_ulSequenceNumber(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->set_ulSequenceNumber(-1)' );
    is( Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->set_bIsExport(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_WTLS_KEY_MAT_PARAMS->new->set_bIsExport(-1)' );
    is( Crypt::PKCS11::CK_CMS_SIG_PARAMS->new->set_certificateHandle(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_CMS_SIG_PARAMS->new->set_certificateHandle(-1)' );
    is( Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->set_saltSource(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->set_saltSource(-1)' );
    is( Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->set_iterations(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->set_iterations(-1)' );
    is( Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->set_prf(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->set_prf(-1)' );
    is( Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->set_pPassword(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->set_pPassword(-1)' );
    is( Crypt::PKCS11::CK_OTP_PARAM->new->set_type(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_OTP_PARAM->new->set_type(-1)' );
    is( Crypt::PKCS11::CK_OTP_PARAMS->new->set_ulCount(-1), CKR_FUNCTION_NOT_SUPPORTED, 'Crypt::PKCS11::CK_OTP_PARAMS->new->set_ulCount(-1)' );
    is( Crypt::PKCS11::CK_OTP_SIGNATURE_INFO->new->set_ulCount(-1), CKR_FUNCTION_NOT_SUPPORTED, 'Crypt::PKCS11::CK_OTP_SIGNATURE_INFO->new->set_ulCount(-1)' );
    is( Crypt::PKCS11::CK_KIP_PARAMS->new->set_hKey(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_KIP_PARAMS->new->set_hKey(-1)' );
    is( Crypt::PKCS11::CK_AES_CTR_PARAMS->new->set_ulCounterBits(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_AES_CTR_PARAMS->new->set_ulCounterBits(-1)' );
    is( Crypt::PKCS11::CK_AES_GCM_PARAMS->new->set_ulIvBits(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_AES_GCM_PARAMS->new->set_ulIvBits(-1)' );
    is( Crypt::PKCS11::CK_AES_GCM_PARAMS->new->set_ulTagBits(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_AES_GCM_PARAMS->new->set_ulTagBits(-1)' );
    is( Crypt::PKCS11::CK_CAMELLIA_CTR_PARAMS->new->set_ulCounterBits(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_CAMELLIA_CTR_PARAMS->new->set_ulCounterBits(-1)' );

    is( Crypt::PKCS11::CK_MECHANISM->new->set_pParameter(undef), CKR_OK, 'Crypt::PKCS11::CK_MECHANISM->new->set_pParameter(undef)' );
    is( Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMS->new->set_pSourceData(undef), CKR_OK, 'Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMS->new->set_pSourceData(undef)' );
    is( Crypt::PKCS11::CK_ECDH1_DERIVE_PARAMS->new->set_pSharedData(undef), CKR_OK, 'Crypt::PKCS11::CK_ECDH1_DERIVE_PARAMS->new->set_pSharedData(undef)' );
    is( Crypt::PKCS11::CK_ECDH1_DERIVE_PARAMS->new->set_pPublicData(undef), CKR_OK, 'Crypt::PKCS11::CK_ECDH1_DERIVE_PARAMS->new->set_pPublicData(undef)' );
    is( Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new->set_pSharedData(undef), CKR_OK, 'Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new->set_pSharedData(undef)' );
    is( Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new->set_pPublicData(undef), CKR_OK, 'Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new->set_pPublicData(undef)' );
    is( Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new->set_pPublicData2(undef), CKR_OK, 'Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new->set_pPublicData2(undef)' );
    is( Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->set_pSharedData(undef), CKR_OK, 'Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->set_pSharedData(undef)' );
    is( Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->set_pPublicData(undef), CKR_OK, 'Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->set_pPublicData(undef)' );
    is( Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->set_pPublicData2(undef), CKR_OK, 'Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->set_pPublicData2(undef)' );
    is( Crypt::PKCS11::CK_X9_42_DH1_DERIVE_PARAMS->new->set_pOtherInfo(undef), CKR_OK, 'Crypt::PKCS11::CK_X9_42_DH1_DERIVE_PARAMS->new->set_pOtherInfo(undef)' );
    is( Crypt::PKCS11::CK_X9_42_DH1_DERIVE_PARAMS->new->set_pPublicData(undef), CKR_OK, 'Crypt::PKCS11::CK_X9_42_DH1_DERIVE_PARAMS->new->set_pPublicData(undef)' );
    is( Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new->set_pOtherInfo(undef), CKR_OK, 'Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new->set_pOtherInfo(undef)' );
    is( Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new->set_pPublicData(undef), CKR_OK, 'Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new->set_pPublicData(undef)' );
    is( Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new->set_pPublicData2(undef), CKR_OK, 'Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new->set_pPublicData2(undef)' );
    is( Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->set_pOtherInfo(undef), CKR_OK, 'Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->set_pOtherInfo(undef)' );
    is( Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->set_pPublicData(undef), CKR_OK, 'Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->set_pPublicData(undef)' );
    is( Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->set_pPublicData2(undef), CKR_OK, 'Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->set_pPublicData2(undef)' );
    is( Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new->set_pRandomA(undef), CKR_OK, 'Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new->set_pRandomA(undef)' );
    is( Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new->set_pRandomB(undef), CKR_OK, 'Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new->set_pRandomB(undef)' );
    is( Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new->set_pPublicData(undef), CKR_OK, 'Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new->set_pPublicData(undef)' );
    is( Crypt::PKCS11::CK_RC5_CBC_PARAMS->new->set_pIv(undef), CKR_OK, 'Crypt::PKCS11::CK_RC5_CBC_PARAMS->new->set_pIv(undef)' );
    is( Crypt::PKCS11::CK_DES_CBC_ENCRYPT_DATA_PARAMS->new->set_pData(undef), CKR_OK, 'Crypt::PKCS11::CK_DES_CBC_ENCRYPT_DATA_PARAMS->new->set_pData(undef)' );
    is( Crypt::PKCS11::CK_AES_CBC_ENCRYPT_DATA_PARAMS->new->set_pData(undef), CKR_OK, 'Crypt::PKCS11::CK_AES_CBC_ENCRYPT_DATA_PARAMS->new->set_pData(undef)' );
    is( Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->set_pPassword(undef), CKR_OK, 'Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->set_pPassword(undef)' );
    is( Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->set_pPublicData(undef), CKR_OK, 'Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->set_pPublicData(undef)' );
    is( Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->set_pRandomA(undef), CKR_OK, 'Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->set_pRandomA(undef)' );
    is( Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->set_pPrimeP(undef), CKR_OK, 'Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->set_pPrimeP(undef)' );
    is( Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->set_pBaseG(undef), CKR_OK, 'Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->set_pBaseG(undef)' );
    is( Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->set_pSubprimeQ(undef), CKR_OK, 'Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->set_pSubprimeQ(undef)' );
    is( Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pOldWrappedX(undef), CKR_OK, 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pOldWrappedX(undef)' );
    is( Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pOldPassword(undef), CKR_OK, 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pOldPassword(undef)' );
    is( Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pOldPublicData(undef), CKR_OK, 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pOldPublicData(undef)' );
    is( Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pOldRandomA(undef), CKR_OK, 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pOldRandomA(undef)' );
    is( Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pNewPassword(undef), CKR_OK, 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pNewPassword(undef)' );
    is( Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pNewPublicData(undef), CKR_OK, 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pNewPublicData(undef)' );
    is( Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pNewRandomA(undef), CKR_OK, 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pNewRandomA(undef)' );
    is( Crypt::PKCS11::CK_PBE_PARAMS->new->set_pInitVector(undef), CKR_OK, 'Crypt::PKCS11::CK_PBE_PARAMS->new->set_pInitVector(undef)' );
    is( Crypt::PKCS11::CK_PBE_PARAMS->new->set_pPassword(undef), CKR_OK, 'Crypt::PKCS11::CK_PBE_PARAMS->new->set_pPassword(undef)' );
    is( Crypt::PKCS11::CK_PBE_PARAMS->new->set_pSalt(undef), CKR_OK, 'Crypt::PKCS11::CK_PBE_PARAMS->new->set_pSalt(undef)' );
    is( Crypt::PKCS11::CK_KEY_WRAP_SET_OAEP_PARAMS->new->set_pX(undef), CKR_OK, 'Crypt::PKCS11::CK_KEY_WRAP_SET_OAEP_PARAMS->new->set_pX(undef)' );
    is( Crypt::PKCS11::CK_SSL3_RANDOM_DATA->new->set_pClientRandom(undef), CKR_OK, 'Crypt::PKCS11::CK_SSL3_RANDOM_DATA->new->set_pClientRandom(undef)' );
    is( Crypt::PKCS11::CK_SSL3_RANDOM_DATA->new->set_pServerRandom(undef), CKR_OK, 'Crypt::PKCS11::CK_SSL3_RANDOM_DATA->new->set_pServerRandom(undef)' );
    is( Crypt::PKCS11::CK_TLS_PRF_PARAMS->new->set_pSeed(undef), CKR_OK, 'Crypt::PKCS11::CK_TLS_PRF_PARAMS->new->set_pSeed(undef)' );
    is( Crypt::PKCS11::CK_TLS_PRF_PARAMS->new->set_pLabel(undef), CKR_OK, 'Crypt::PKCS11::CK_TLS_PRF_PARAMS->new->set_pLabel(undef)' );
    is( Crypt::PKCS11::CK_TLS_PRF_PARAMS->new->set_pOutput(undef), CKR_OK, 'Crypt::PKCS11::CK_TLS_PRF_PARAMS->new->set_pOutput(undef)' );
    is( Crypt::PKCS11::CK_WTLS_RANDOM_DATA->new->set_pClientRandom(undef), CKR_OK, 'Crypt::PKCS11::CK_WTLS_RANDOM_DATA->new->set_pClientRandom(undef)' );
    is( Crypt::PKCS11::CK_WTLS_RANDOM_DATA->new->set_pServerRandom(undef), CKR_OK, 'Crypt::PKCS11::CK_WTLS_RANDOM_DATA->new->set_pServerRandom(undef)' );
    is( Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new->set_pSeed(undef), CKR_OK, 'Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new->set_pSeed(undef)' );
    is( Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new->set_pLabel(undef), CKR_OK, 'Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new->set_pLabel(undef)' );
    is( Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new->set_pOutput(undef), CKR_OK, 'Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new->set_pOutput(undef)' );
    is( Crypt::PKCS11::CK_CMS_SIG_PARAMS->new->set_pContentType(undef), CKR_OK, 'Crypt::PKCS11::CK_CMS_SIG_PARAMS->new->set_pContentType(undef)' );
    is( Crypt::PKCS11::CK_CMS_SIG_PARAMS->new->set_pRequestedAttributes(undef), CKR_OK, 'Crypt::PKCS11::CK_CMS_SIG_PARAMS->new->set_pRequestedAttributes(undef)' );
    is( Crypt::PKCS11::CK_CMS_SIG_PARAMS->new->set_pRequiredAttributes(undef), CKR_OK, 'Crypt::PKCS11::CK_CMS_SIG_PARAMS->new->set_pRequiredAttributes(undef)' );
    is( Crypt::PKCS11::CK_KEY_DERIVATION_STRING_DATA->new->set_pData(undef), CKR_OK, 'Crypt::PKCS11::CK_KEY_DERIVATION_STRING_DATA->new->set_pData(undef)' );
    is( Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->set_pSaltSourceData(undef), CKR_OK, 'Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->set_pSaltSourceData(undef)' );
    is( Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->set_pPrfData(undef), CKR_OK, 'Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->set_pPrfData(undef)' );
    is( Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->set_pPassword(undef), CKR_OK, 'Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->set_pPassword(undef)' );
    is( Crypt::PKCS11::CK_OTP_PARAM->new->set_pValue(undef), CKR_OK, 'Crypt::PKCS11::CK_OTP_PARAM->new->set_pValue(undef)' );
    is( Crypt::PKCS11::CK_KIP_PARAMS->new->set_pSeed(undef), CKR_OK, 'Crypt::PKCS11::CK_KIP_PARAMS->new->set_pSeed(undef)' );
    is( Crypt::PKCS11::CK_AES_GCM_PARAMS->new->set_pIv(undef), CKR_OK, 'Crypt::PKCS11::CK_AES_GCM_PARAMS->new->set_pIv(undef)' );
    is( Crypt::PKCS11::CK_AES_GCM_PARAMS->new->set_pAAD(undef), CKR_OK, 'Crypt::PKCS11::CK_AES_GCM_PARAMS->new->set_pAAD(undef)' );
    is( Crypt::PKCS11::CK_AES_CCM_PARAMS->new->set_pNonce(undef), CKR_OK, 'Crypt::PKCS11::CK_AES_CCM_PARAMS->new->set_pNonce(undef)' );
    is( Crypt::PKCS11::CK_AES_CCM_PARAMS->new->set_pAAD(undef), CKR_OK, 'Crypt::PKCS11::CK_AES_CCM_PARAMS->new->set_pAAD(undef)' );
    is( Crypt::PKCS11::CK_CAMELLIA_CBC_ENCRYPT_DATA_PARAMS->new->set_pData(undef), CKR_OK, 'Crypt::PKCS11::CK_CAMELLIA_CBC_ENCRYPT_DATA_PARAMS->new->set_pData(undef)' );
    is( Crypt::PKCS11::CK_ARIA_CBC_ENCRYPT_DATA_PARAMS->new->set_pData(undef), CKR_OK, 'Crypt::PKCS11::CK_ARIA_CBC_ENCRYPT_DATA_PARAMS->new->set_pData(undef)' );

    is( Crypt::PKCS11::CK_MECHANISM->new->set_pParameter(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_MECHANISM->new->set_pParameter(-1)' );
    is( Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMS->new->set_pSourceData(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_RSA_PKCS_OAEP_PARAMS->new->set_pSourceData(-1)' );
    is( Crypt::PKCS11::CK_ECDH1_DERIVE_PARAMS->new->set_pSharedData(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_ECDH1_DERIVE_PARAMS->new->set_pSharedData(-1)' );
    is( Crypt::PKCS11::CK_ECDH1_DERIVE_PARAMS->new->set_pPublicData(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_ECDH1_DERIVE_PARAMS->new->set_pPublicData(-1)' );
    is( Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new->set_pSharedData(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new->set_pSharedData(-1)' );
    is( Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new->set_pPublicData(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new->set_pPublicData(-1)' );
    is( Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new->set_pPublicData2(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_ECDH2_DERIVE_PARAMS->new->set_pPublicData2(-1)' );
    is( Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->set_pSharedData(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->set_pSharedData(-1)' );
    is( Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->set_pPublicData(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->set_pPublicData(-1)' );
    is( Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->set_pPublicData2(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_ECMQV_DERIVE_PARAMS->new->set_pPublicData2(-1)' );
    is( Crypt::PKCS11::CK_X9_42_DH1_DERIVE_PARAMS->new->set_pOtherInfo(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_X9_42_DH1_DERIVE_PARAMS->new->set_pOtherInfo(-1)' );
    is( Crypt::PKCS11::CK_X9_42_DH1_DERIVE_PARAMS->new->set_pPublicData(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_X9_42_DH1_DERIVE_PARAMS->new->set_pPublicData(-1)' );
    is( Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new->set_pOtherInfo(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new->set_pOtherInfo(-1)' );
    is( Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new->set_pPublicData(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new->set_pPublicData(-1)' );
    is( Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new->set_pPublicData2(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_X9_42_DH2_DERIVE_PARAMS->new->set_pPublicData2(-1)' );
    is( Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->set_pOtherInfo(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->set_pOtherInfo(-1)' );
    is( Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->set_pPublicData(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->set_pPublicData(-1)' );
    is( Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->set_pPublicData2(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_X9_42_MQV_DERIVE_PARAMS->new->set_pPublicData2(-1)' );
    is( Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new->set_pRandomA(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new->set_pRandomA(-1)' );
    is( Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new->set_pRandomB(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new->set_pRandomB(-1)' );
    is( Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new->set_pPublicData(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_KEA_DERIVE_PARAMS->new->set_pPublicData(-1)' );
    is( Crypt::PKCS11::CK_RC5_CBC_PARAMS->new->set_pIv(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_RC5_CBC_PARAMS->new->set_pIv(-1)' );
    is( Crypt::PKCS11::CK_DES_CBC_ENCRYPT_DATA_PARAMS->new->set_pData(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_DES_CBC_ENCRYPT_DATA_PARAMS->new->set_pData(-1)' );
    is( Crypt::PKCS11::CK_AES_CBC_ENCRYPT_DATA_PARAMS->new->set_pData(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_AES_CBC_ENCRYPT_DATA_PARAMS->new->set_pData(-1)' );
    is( Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->set_pPassword(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->set_pPassword(-1)' );
    is( Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->set_pPublicData(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->set_pPublicData(-1)' );
    is( Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->set_pRandomA(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->set_pRandomA(-1)' );
    is( Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->set_pPrimeP(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->set_pPrimeP(-1)' );
    is( Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->set_pBaseG(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->set_pBaseG(-1)' );
    is( Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->set_pSubprimeQ(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_SKIPJACK_PRIVATE_WRAP_PARAMS->new->set_pSubprimeQ(-1)' );
    is( Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pOldWrappedX(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pOldWrappedX(-1)' );
    is( Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pOldPassword(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pOldPassword(-1)' );
    is( Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pOldPublicData(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pOldPublicData(-1)' );
    is( Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pOldRandomA(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pOldRandomA(-1)' );
    is( Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pNewPassword(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pNewPassword(-1)' );
    is( Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pNewPublicData(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pNewPublicData(-1)' );
    is( Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pNewRandomA(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_SKIPJACK_RELAYX_PARAMS->new->set_pNewRandomA(-1)' );
    is( Crypt::PKCS11::CK_PBE_PARAMS->new->set_pInitVector(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_PBE_PARAMS->new->set_pInitVector(-1)' );
    is( Crypt::PKCS11::CK_PBE_PARAMS->new->set_pPassword(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_PBE_PARAMS->new->set_pPassword(-1)' );
    is( Crypt::PKCS11::CK_PBE_PARAMS->new->set_pSalt(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_PBE_PARAMS->new->set_pSalt(-1)' );
    is( Crypt::PKCS11::CK_KEY_WRAP_SET_OAEP_PARAMS->new->set_pX(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_KEY_WRAP_SET_OAEP_PARAMS->new->set_pX(-1)' );
    is( Crypt::PKCS11::CK_SSL3_RANDOM_DATA->new->set_pClientRandom(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_SSL3_RANDOM_DATA->new->set_pClientRandom(-1)' );
    is( Crypt::PKCS11::CK_SSL3_RANDOM_DATA->new->set_pServerRandom(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_SSL3_RANDOM_DATA->new->set_pServerRandom(-1)' );
    is( Crypt::PKCS11::CK_TLS_PRF_PARAMS->new->set_pSeed(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_TLS_PRF_PARAMS->new->set_pSeed(-1)' );
    is( Crypt::PKCS11::CK_TLS_PRF_PARAMS->new->set_pLabel(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_TLS_PRF_PARAMS->new->set_pLabel(-1)' );
    is( Crypt::PKCS11::CK_TLS_PRF_PARAMS->new->set_pOutput(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_TLS_PRF_PARAMS->new->set_pOutput(-1)' );
    is( Crypt::PKCS11::CK_WTLS_RANDOM_DATA->new->set_pClientRandom(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_WTLS_RANDOM_DATA->new->set_pClientRandom(-1)' );
    is( Crypt::PKCS11::CK_WTLS_RANDOM_DATA->new->set_pServerRandom(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_WTLS_RANDOM_DATA->new->set_pServerRandom(-1)' );
    is( Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new->set_pSeed(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new->set_pSeed(-1)' );
    is( Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new->set_pLabel(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new->set_pLabel(-1)' );
    is( Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new->set_pOutput(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_WTLS_PRF_PARAMS->new->set_pOutput(-1)' );
    is( Crypt::PKCS11::CK_CMS_SIG_PARAMS->new->set_pContentType(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_CMS_SIG_PARAMS->new->set_pContentType(-1)' );
    is( Crypt::PKCS11::CK_CMS_SIG_PARAMS->new->set_pRequestedAttributes(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_CMS_SIG_PARAMS->new->set_pRequestedAttributes(-1)' );
    is( Crypt::PKCS11::CK_CMS_SIG_PARAMS->new->set_pRequiredAttributes(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_CMS_SIG_PARAMS->new->set_pRequiredAttributes(-1)' );
    is( Crypt::PKCS11::CK_KEY_DERIVATION_STRING_DATA->new->set_pData(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_KEY_DERIVATION_STRING_DATA->new->set_pData(-1)' );
    is( Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->set_pSaltSourceData(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->set_pSaltSourceData(-1)' );
    is( Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->set_pPrfData(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->set_pPrfData(-1)' );
    is( Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->set_pPassword(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_PKCS5_PBKD2_PARAMS->new->set_pPassword(-1)' );
    is( Crypt::PKCS11::CK_OTP_PARAM->new->set_pValue(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_OTP_PARAM->new->set_pValue(-1)' );
    is( Crypt::PKCS11::CK_KIP_PARAMS->new->set_pSeed(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_KIP_PARAMS->new->set_pSeed(-1)' );
    is( Crypt::PKCS11::CK_AES_GCM_PARAMS->new->set_pIv(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_AES_GCM_PARAMS->new->set_pIv(-1)' );
    is( Crypt::PKCS11::CK_AES_GCM_PARAMS->new->set_pAAD(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_AES_GCM_PARAMS->new->set_pAAD(-1)' );
    is( Crypt::PKCS11::CK_AES_CCM_PARAMS->new->set_pNonce(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_AES_CCM_PARAMS->new->set_pNonce(-1)' );
    is( Crypt::PKCS11::CK_AES_CCM_PARAMS->new->set_pAAD(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_AES_CCM_PARAMS->new->set_pAAD(-1)' );
    is( Crypt::PKCS11::CK_CAMELLIA_CBC_ENCRYPT_DATA_PARAMS->new->set_pData(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_CAMELLIA_CBC_ENCRYPT_DATA_PARAMS->new->set_pData(-1)' );
    is( Crypt::PKCS11::CK_ARIA_CBC_ENCRYPT_DATA_PARAMS->new->set_pData(-1), CKR_ARGUMENTS_BAD, 'Crypt::PKCS11::CK_ARIA_CBC_ENCRYPT_DATA_PARAMS->new->set_pData(-1)' );
}

# NOTE: This must run last!
{
    local $SIG{__WARN__} = sub {};
    *Crypt::PKCS11::XS::new = sub ($) {};
    $@ = undef; eval { Crypt::PKCS11->new; };
    ok( $@, '*Crypt::PKCS11::XS::new undef' );
}

done_testing;
